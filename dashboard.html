<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transmission Utility AI Agent Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .status-bar {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            background: #90EE90;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .main-content {
            padding: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 4px solid;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card.healthy { border-color: #28a745; }
        .stat-card.warning { border-color: #ffc107; }
        .stat-card.critical { border-color: #dc3545; }
        .stat-card.info { border-color: #17a2b8; }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 1rem;
        }

        .sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #dee2e6;
        }

        .section-header h3 {
            color: #333;
            margin-bottom: 5px;
        }

        .section-content {
            padding: 20px;
        }

        .asset-item, .alert-item, .work-order-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .asset-item:last-child,
        .alert-item:last-child,
        .work-order-item:last-child {
            border-bottom: none;
        }

        .asset-health {
            width: 60px;
            height: 20px;
            background: #eee;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .health-bar {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .health-bar.excellent { background: #28a745; }
        .health-bar.good { background: #28a745; }
        .health-bar.fair { background: #ffc107; }
        .health-bar.poor { background: #dc3545; }

        .alert-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .alert-badge.critical {
            background: #dc3545;
            color: white;
        }

        .alert-badge.warning {
            background: #ffc107;
            color: #333;
        }

        .alert-badge.info {
            background: #17a2b8;
            color: white;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 15px;
            width: 95%;
            max-width: 1200px;
            height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 30px;
        }

        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: #ccc;
        }

        .chart-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            min-height: 300px;
            position: relative;
        }

        .chart-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 250px;
            background: white;
            color: #333;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }

        /* Real Chart Styles */
        .real-chart {
            width: 100%;
            height: 100%;
            position: relative;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        .chart-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* Chart.js Canvas Styling */
        canvas {
            max-width: 100%;
            height: auto !important;
            background: white;
            border-radius: 8px;
        }

        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .chart-container canvas {
            width: 100% !important;
            height: 200px !important;
        }

        .chart-legend {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .chart-tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9rem;
            pointer-events: none;
            z-index: 100;
            display: none;
        }

        .bar-chart-container {
            display: flex;
            align-items: end;
            justify-content: space-around;
            height: 200px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
            position: relative;
        }

        .chart-bar {
            width: 40px;
            background: linear-gradient(to top, #007bff, #0056b3);
            border-radius: 4px 4px 0 0;
            margin: 0 5px;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            min-height: 10px;
        }

        .chart-bar:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,123,255,0.3);
        }

        .chart-bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            white-space: nowrap;
            color: #333;
        }

        .chart-bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: bold;
            color: #333;
            background: rgba(255,255,255,0.9);
            padding: 2px 4px;
            border-radius: 2px;
        }

        .line-chart-container {
            height: 200px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }

        .line-chart-svg {
            width: 100%;
            height: 100%;
        }

        .chart-line {
            stroke: #28a745;
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
        }

        .chart-area {
            fill: rgba(40, 167, 69, 0.1);
        }

        .chart-point {
            fill: #28a745;
            stroke: white;
            stroke-width: 2;
            cursor: pointer;
            transition: r 0.2s;
        }

        .chart-point:hover {
            r: 6;
        }

        .doughnut-chart-container {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .doughnut-chart-svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .doughnut-segment {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .doughnut-segment:hover {
            stroke-width: 3;
            filter: brightness(1.1);
        }

        .gauge-chart-container {
            width: 150px;
            height: 150px;
            position: relative;
            margin: 20px auto;
        }

        .gauge-chart-svg {
            width: 100%;
            height: 100%;
        }

        .gauge-background {
            fill: none;
            stroke: #e9ecef;
            stroke-width: 15;
        }

        .gauge-progress {
            fill: none;
            stroke-width: 15;
            stroke-linecap: round;
            transition: all 1s ease;
        }

        .gauge-text {
            text-anchor: middle;
            dominant-baseline: middle;
            font-weight: bold;
        }

        .gauge-label {
            text-anchor: middle;
            dominant-baseline: middle;
            font-size: 12px;
            fill: #666;
        }

        .action-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-card:hover {
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,123,255,0.1);
        }

        .action-card.active {
            border-color: #28a745;
            background: #f8fff9;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #007bff;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #666;
            font-size: 0.9rem;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .team-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #007bff;
        }

        .recommendation-item {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }

        .recommendation-item.high-priority {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .recommendation-item.completed {
            background: #d4edda;
            border-left-color: #28a745;
        }

        /* Chart and Graph Styles */
        .chart-svg {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 8px;
        }

        .bar-chart {
            display: flex;
            align-items: end;
            justify-content: space-around;
            height: 200px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
        }

        .bar {
            width: 40px;
            background: linear-gradient(to top, #007bff, #0056b3);
            border-radius: 4px 4px 0 0;
            margin: 0 5px;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .bar:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,123,255,0.3);
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: bold;
            color: #333;
        }

        .line-chart {
            height: 200px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }

        .line-path {
            stroke: #28a745;
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: drawLine 2s ease-in-out forwards;
        }

        @keyframes drawLine {
            to {
                stroke-dashoffset: 0;
            }
        }

        .pie-chart {
            width: 200px;
            height: 200px;
            margin: 20px auto;
        }

        .gauge-chart {
            width: 150px;
            height: 150px;
            position: relative;
            margin: 20px auto;
        }

        .gauge-background {
            fill: none;
            stroke: #e9ecef;
            stroke-width: 10;
        }

        .gauge-progress {
            fill: none;
            stroke-width: 10;
            stroke-linecap: round;
            transition: stroke-dasharray 1s ease;
        }

        .alert-panel {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            animation: alertPulse 2s infinite;
        }

        @keyframes alertPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .real-time-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #28a745;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
            margin-right: 5px;
        }

        .export-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .export-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .export-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .priority-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .priority-badge.emergency {
            background: #dc3545;
            color: white;
        }

        .priority-badge.critical {
            background: #fd7e14;
            color: white;
        }

        .priority-badge.high {
            background: #ffc107;
            color: #333;
        }

        .priority-badge.medium {
            background: #6c757d;
            color: white;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .feature-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .feature-card h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .feature-card p {
            color: #666;
            line-height: 1.6;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 1px solid #dee2e6;
        }

        .refresh-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }

        .refresh-btn:hover {
            background: #0056b3;
        }

        /* Clock Styling */
        #current-time {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 5px;
            transition: opacity 0.2s ease;
            border: 1px solid rgba(255,255,255,0.2);
            min-width: 200px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .sections {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>⚡ Transmission Utility AI Agent</h1>
            <p>Intelligent Asset Monitoring & Predictive Maintenance System</p>
        </div>

        <div class="status-bar">
            <div class="status-indicator">
                <div class="status-dot" id="live-indicator"></div>
                <span id="live-status">System Online - AI Agent Active</span>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <div class="live-controls">
                    <button id="start-live-btn" onclick="liveDataSystem.start()" style="background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                        ▶️ Start Live Data
                    </button>
                    <button id="stop-live-btn" onclick="liveDataSystem.stop()" style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                        ⏹️ Stop Live Data
                    </button>
                    <span id="update-counter" style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 3px; font-size: 0.9rem;">Updates: 0</span>
                </div>
                <span id="current-time"></span>
                <button class="refresh-btn" onclick="refreshData()">🔄 Refresh Data</button>
            </div>
        </div>

        <div class="main-content">
            <!-- Key Metrics -->
            <div class="stats-grid">
                <div class="stat-card healthy" onclick="openModal('asset-database')" style="cursor: pointer; transition: transform 0.3s ease;">
                    <div class="stat-number">45</div>
                    <div class="stat-label">Total Assets</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">📊 Click to view database</div>
                </div>
                <div class="stat-card warning" onclick="openModal('critical-assets')" style="cursor: pointer; transition: transform 0.3s ease;">
                    <div class="stat-number">3</div>
                    <div class="stat-label">Critical Assets</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">⚠️ Click to view details</div>
                </div>
                <div class="stat-card critical" onclick="openModal('active-alerts')" style="cursor: pointer; transition: transform 0.3s ease;">
                    <div class="stat-number">7</div>
                    <div class="stat-label">Active Alerts</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">🚨 Click to manage</div>
                </div>
                <div class="stat-card info" onclick="openModal('pending-work-orders')" style="cursor: pointer; transition: transform 0.3s ease;">
                    <div class="stat-number">12</div>
                    <div class="stat-label">Pending Work Orders</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">🔧 Click to manage</div>
                </div>
            </div>

            <!-- Main Sections -->
            <div class="sections">
                <!-- Critical Assets -->
                <div class="section">
                    <div class="section-header">
                        <h3>🚨 Critical Assets</h3>
                        <p>Assets requiring immediate attention</p>
                    </div>
                    <div class="section-content">
                        <div class="asset-item">
                            <div>
                                <strong>Main Power Transformer #1</strong>
                                <br><small>Central Substation</small>
                            </div>
                            <div class="asset-health">
                                <div class="health-bar poor" style="width: 35%"></div>
                            </div>
                        </div>
                        <div class="asset-item">
                            <div>
                                <strong>Distribution Transformer #2</strong>
                                <br><small>North Substation</small>
                            </div>
                            <div class="asset-health">
                                <div class="health-bar fair" style="width: 45%"></div>
                            </div>
                        </div>
                        <div class="asset-item">
                            <div>
                                <strong>Circuit Breaker Bay 1</strong>
                                <br><small>Central Substation</small>
                            </div>
                            <div class="asset-health">
                                <div class="health-bar poor" style="width: 30%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Alerts -->
                <div class="section">
                    <div class="section-header">
                        <h3>🔔 Recent Alerts</h3>
                        <p>Latest system notifications</p>
                    </div>
                    <div class="section-content">
                        <div class="alert-item">
                            <div>
                                <strong>High Temperature Alert</strong>
                                <br><small>TXF-001 - 95°C detected</small>
                            </div>
                            <span class="alert-badge critical">Critical</span>
                        </div>
                        <div class="alert-item">
                            <div>
                                <strong>Failure Prediction</strong>
                                <br><small>TXF-002 - 85% failure probability</small>
                            </div>
                            <span class="alert-badge critical">Critical</span>
                        </div>
                        <div class="alert-item">
                            <div>
                                <strong>Vibration Anomaly</strong>
                                <br><small>CBR-001 - Excessive vibration</small>
                            </div>
                            <span class="alert-badge warning">Warning</span>
                        </div>
                        <div class="alert-item">
                            <div>
                                <strong>Maintenance Due</strong>
                                <br><small>PWL-001 - Scheduled maintenance</small>
                            </div>
                            <span class="alert-badge info">Info</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Work Orders Section -->
            <div class="section" style="margin-bottom: 30px;">
                <div class="section-header">
                    <h3>📋 Active Work Orders</h3>
                    <p>Current maintenance and repair tasks</p>
                </div>
                <div class="section-content">
                    <div class="work-order-item">
                        <div>
                            <strong>WO-20250806-001</strong>
                            <br><small>Emergency Maintenance - Main Power Transformer #1</small>
                            <br><small>Team: Alpha Team | ETA: 2 hours</small>
                        </div>
                        <span class="priority-badge emergency">Emergency</span>
                    </div>
                    <div class="work-order-item">
                        <div>
                            <strong>WO-20250806-002</strong>
                            <br><small>Preventive Maintenance - Circuit Breaker Bay 1</small>
                            <br><small>Team: Charlie Team | Scheduled: Tomorrow</small>
                        </div>
                        <span class="priority-badge critical">Critical</span>
                    </div>
                    <div class="work-order-item">
                        <div>
                            <strong>WO-20250806-003</strong>
                            <br><small>Inspection - Transmission Line A-B</small>
                            <br><small>Team: Bravo Team | Scheduled: Next Week</small>
                        </div>
                        <span class="priority-badge medium">Medium</span>
                    </div>
                </div>
            </div>

            <!-- Asset Analytics Section -->
            <div class="section" style="margin-bottom: 30px;">
                <div class="section-header">
                    <h3>📊 Asset Analytics</h3>
                    <p>Comprehensive asset performance and health analysis</p>
                </div>
                <div class="section-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <!-- Asset Type Distribution -->
                        <div>
                            <h4 style="margin-bottom: 15px;">Asset Distribution by Type</h4>
                            <div class="asset-type-item">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>🔌 Transformers</span>
                                    <span style="font-weight: bold;">8 units</span>
                                </div>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                    <div style="background: #28a745; height: 100%; width: 40%; border-radius: 4px;"></div>
                                </div>
                                <small style="color: #666;">Avg Health: 78.5%</small>
                            </div>
                            <div class="asset-type-item" style="margin-top: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>⚡ Power Lines</span>
                                    <span style="font-weight: bold;">6 units</span>
                                </div>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                    <div style="background: #ffc107; height: 100%; width: 65%; border-radius: 4px;"></div>
                                </div>
                                <small style="color: #666;">Avg Health: 65.2%</small>
                            </div>
                            <div class="asset-type-item" style="margin-top: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>🔧 Circuit Breakers</span>
                                    <span style="font-weight: bold;">5 units</span>
                                </div>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                    <div style="background: #28a745; height: 100%; width: 85%; border-radius: 4px;"></div>
                                </div>
                                <small style="color: #666;">Avg Health: 85.7%</small>
                            </div>
                            <div class="asset-type-item" style="margin-top: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>🏢 Substations</span>
                                    <span style="font-weight: bold;">3 units</span>
                                </div>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                    <div style="background: #28a745; height: 100%; width: 90%; border-radius: 4px;"></div>
                                </div>
                                <small style="color: #666;">Avg Health: 90.1%</small>
                            </div>
                            <div class="asset-type-item" style="margin-top: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>🔀 Switches</span>
                                    <span style="font-weight: bold;">2 units</span>
                                </div>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                    <div style="background: #ffc107; height: 100%; width: 70%; border-radius: 4px;"></div>
                                </div>
                                <small style="color: #666;">Avg Health: 70.3%</small>
                            </div>
                        </div>

                        <!-- Age Distribution -->
                        <div>
                            <h4 style="margin-bottom: 15px;">Asset Age Distribution</h4>
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>0-5 Years</span>
                                    <span style="font-weight: bold; color: #28a745;">6 assets</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>5-10 Years</span>
                                    <span style="font-weight: bold; color: #28a745;">8 assets</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>10-15 Years</span>
                                    <span style="font-weight: bold; color: #ffc107;">7 assets</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>15+ Years</span>
                                    <span style="font-weight: bold; color: #dc3545;">3 assets</span>
                                </div>
                            </div>

                            <h4 style="margin-bottom: 15px;">Performance Metrics</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>System Availability</span>
                                    <span style="font-weight: bold; color: #28a745;">99.7%</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>MTBF (Mean Time Between Failures)</span>
                                    <span style="font-weight: bold;">2,847 hours</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>MTTR (Mean Time To Repair)</span>
                                    <span style="font-weight: bold;">4.2 hours</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Planned vs Unplanned Maintenance</span>
                                    <span style="font-weight: bold;">78% / 22%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workforce Analytics Section -->
            <div class="section" style="margin-bottom: 30px;">
                <div class="section-header">
                    <h3>👥 Workforce Analytics</h3>
                    <p>Team performance, utilization, and capacity management</p>
                </div>
                <div class="section-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                        <!-- Team Performance -->
                        <div>
                            <h4 style="margin-bottom: 15px;">Team Performance</h4>
                            <div class="team-item" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: bold;">Alpha Team</span>
                                    <span class="alert-badge info">Active</span>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small>Lead: John Smith | Members: 4</small>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small>Specialization: Transformers, Breakers</small>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <small>Completion Rate: <strong style="color: #28a745;">95%</strong></small>
                                    <small>Avg Response: <strong>2.5h</strong></small>
                                </div>
                            </div>

                            <div class="team-item" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: bold;">Bravo Team</span>
                                    <span class="alert-badge warning">Busy</span>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small>Lead: Sarah Johnson | Members: 3</small>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small>Specialization: Power Lines</small>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <small>Completion Rate: <strong style="color: #28a745;">88%</strong></small>
                                    <small>Avg Response: <strong>3.2h</strong></small>
                                </div>
                            </div>

                            <div class="team-item" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: bold;">Charlie Team</span>
                                    <span class="alert-badge" style="background: #28a745; color: white;">Available</span>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small>Lead: Mike Davis | Members: 5</small>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small>Specialization: Substations, SCADA</small>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <small>Completion Rate: <strong style="color: #28a745;">92%</strong></small>
                                    <small>Avg Response: <strong>1.8h</strong></small>
                                </div>
                            </div>
                        </div>

                        <!-- Utilization Metrics -->
                        <div>
                            <h4 style="margin-bottom: 15px;">Team Utilization</h4>
                            <div style="margin-bottom: 20px;">
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Alpha Team</span>
                                        <span style="font-weight: bold;">80%</span>
                                    </div>
                                    <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                        <div style="background: #ffc107; height: 100%; width: 80%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Bravo Team</span>
                                        <span style="font-weight: bold;">95%</span>
                                    </div>
                                    <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                        <div style="background: #dc3545; height: 100%; width: 95%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Charlie Team</span>
                                        <span style="font-weight: bold;">45%</span>
                                    </div>
                                    <div style="background: #e9ecef; height: 8px; border-radius: 4px;">
                                        <div style="background: #28a745; height: 100%; width: 45%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <h5 style="margin-bottom: 10px;">Capacity Overview</h5>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Total Workforce</span>
                                    <span style="font-weight: bold;">12 technicians</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Currently Active</span>
                                    <span style="font-weight: bold; color: #28a745;">9 technicians</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Available Capacity</span>
                                    <span style="font-weight: bold; color: #ffc107;">3 technicians</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Average Utilization</span>
                                    <span style="font-weight: bold;">73%</span>
                                </div>
                            </div>
                        </div>

                        <!-- Skills Matrix -->
                        <div>
                            <h4 style="margin-bottom: 15px;">Skills & Certifications</h4>
                            <div style="margin-bottom: 20px;">
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>🔌 Transformer Maintenance</span>
                                        <span style="font-weight: bold;">8 certified</span>
                                    </div>
                                    <small style="color: #666;">High Voltage, Oil Analysis, Testing</small>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>⚡ Power Line Work</span>
                                        <span style="font-weight: bold;">5 certified</span>
                                    </div>
                                    <small style="color: #666;">Hot Line, Climbing, Safety</small>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>🔧 Protection Systems</span>
                                        <span style="font-weight: bold;">6 certified</span>
                                    </div>
                                    <small style="color: #666;">Relay Testing, SCADA, Controls</small>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>🏢 Substation Maintenance</span>
                                        <span style="font-weight: bold;">7 certified</span>
                                    </div>
                                    <small style="color: #666;">Switchgear, Grounding, Testing</small>
                                </div>
                            </div>

                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <h5 style="margin-bottom: 10px;">Training Status</h5>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Safety Certified</span>
                                    <span style="font-weight: bold; color: #28a745;">100%</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Technical Updates</span>
                                    <span style="font-weight: bold; color: #28a745;">92%</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Emergency Response</span>
                                    <span style="font-weight: bold; color: #ffc107;">85%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Predictive Insights Section -->
            <div class="section" style="margin-bottom: 30px;">
                <div class="section-header">
                    <h3>🔮 Predictive Insights & Recommendations</h3>
                    <p>AI-powered predictions and intelligent recommendations</p>
                </div>
                <div class="section-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <!-- Failure Predictions -->
                        <div>
                            <h4 style="margin-bottom: 15px;">🚨 Failure Risk Predictions (Next 30 Days)</h4>
                            <div class="prediction-item" style="background: #fff5f5; border-left: 4px solid #dc3545; padding: 15px; margin-bottom: 10px; border-radius: 0 8px 8px 0;">
                                <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: bold; color: #dc3545;">TXF-001 - Main Transformer</span>
                                    <span style="background: #dc3545; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">85%</span>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small><strong>Contributing Factors:</strong> High temperature, aging insulation</small>
                                </div>
                                <div>
                                    <small><strong>Recommendation:</strong> Schedule immediate inspection and oil analysis</small>
                                </div>
                            </div>

                            <div class="prediction-item" style="background: #fff8e1; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 10px; border-radius: 0 8px 8px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: bold; color: #ffc107;">PWL-001 - Power Line A-B</span>
                                    <span style="background: #ffc107; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">65%</span>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small><strong>Contributing Factors:</strong> Weather exposure, conductor aging</small>
                                </div>
                                <div>
                                    <small><strong>Recommendation:</strong> Schedule line inspection during next maintenance window</small>
                                </div>
                            </div>

                            <div class="prediction-item" style="background: #f3e5f5; border-left: 4px solid #6f42c1; padding: 15px; border-radius: 0 8px 8px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: bold; color: #6f42c1;">CBR-001 - Circuit Breaker</span>
                                    <span style="background: #6f42c1; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">42%</span>
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <small><strong>Contributing Factors:</strong> Increased vibration, contact wear</small>
                                </div>
                                <div>
                                    <small><strong>Recommendation:</strong> Plan preventive maintenance within 2 weeks</small>
                                </div>
                            </div>
                        </div>

                        <!-- Maintenance Optimization -->
                        <div>
                            <h4 style="margin-bottom: 15px;">📅 Maintenance Optimization</h4>
                            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                                <h5 style="color: #28a745; margin-bottom: 10px;">🎯 Recommended Actions</h5>
                                <ul style="margin-left: 20px; color: #333;">
                                    <li style="margin-bottom: 5px;"><strong>This Week:</strong> Emergency transformer inspection (TXF-001)</li>
                                    <li style="margin-bottom: 5px;"><strong>Next Week:</strong> Circuit breaker maintenance (CBR-001)</li>
                                    <li style="margin-bottom: 5px;"><strong>Month End:</strong> Power line inspection (PWL-001)</li>
                                </ul>
                            </div>

                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                                <h5 style="margin-bottom: 10px;">📊 Maintenance Efficiency</h5>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Preventive vs Reactive</span>
                                    <span style="font-weight: bold; color: #28a745;">78% / 22%</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Cost Savings (AI Predictions)</span>
                                    <span style="font-weight: bold; color: #28a745;">$147,000</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Downtime Reduction</span>
                                    <span style="font-weight: bold; color: #28a745;">35%</span>
                                </div>
                            </div>

                            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                                <h5 style="color: #1976d2; margin-bottom: 10px;">🤖 AI Insights</h5>
                                <div style="font-size: 0.9rem; color: #333;">
                                    <p style="margin-bottom: 8px;"><strong>Pattern Detected:</strong> Transformer failures increase by 40% during summer months</p>
                                    <p style="margin-bottom: 8px;"><strong>Optimization:</strong> Alpha Team shows 15% faster response for transformer issues</p>
                                    <p><strong>Prediction Accuracy:</strong> Current model achieves 87.3% accuracy in failure predictions</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Features Overview -->
            <div class="features-grid">
                <div class="feature-card" onclick="openModal('decision-support')">
                    <div class="feature-icon">🤖</div>
                    <h4>Decision Support & Automation</h4>
                    <p>Automated corrective action recommendations, team matching, and work order generation.</p>
                </div>
                <div class="feature-card" onclick="openModal('predictive-analytics')">
                    <div class="feature-icon">🔮</div>
                    <h4>Predictive Analytics</h4>
                    <p>Machine learning models for failure prediction and maintenance optimization using historical data.</p>
                </div>
                <div class="feature-card" onclick="openModal('team-management')">
                    <div class="feature-icon">👥</div>
                    <h4>Team Management</h4>
                    <p>Intelligent team assignment based on skills, location, availability, and response time optimization.</p>
                </div>
                <div class="feature-card" onclick="openModal('performance-analytics')">
                    <div class="feature-icon">📈</div>
                    <h4>Performance Analytics</h4>
                    <p>Comprehensive performance metrics, trend analysis, and operational efficiency tracking.</p>
                </div>
                <div class="feature-card" onclick="openModal('data-monitoring')">
                    <div class="feature-icon">🔍</div>
                    <h4>Data Analysis & Monitoring</h4>
                    <p>Historical failure pattern recognition and real-time asset monitoring with dynamic health scoring.</p>
                </div>
                <div class="feature-card" onclick="openModal('visualization-alerts')">
                    <div class="feature-icon">📊</div>
                    <h4>Visualization & Alerts</h4>
                    <p>Real-time dashboard displaying asset status, health scores, and critical state notifications.</p>
                </div>
            </div>
        </div>

        <!-- Modal Windows for Each Feature -->

        <!-- Decision Support & Automation Modal -->
        <div id="decision-support-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>🤖 Decision Support & Automation System</h2>
                    <span class="close" onclick="closeModal('decision-support')">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <!-- Real-time Recommendations -->
                        <div>
                            <h3 style="margin-bottom: 20px;">🎯 Active Recommendations</h3>
                            
                            <div class="recommendation-item high-priority">
                                <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 10px;">
                                    <strong>🚨 CRITICAL: Transformer TXF-001</strong>
                                    <span style="background: #dc3545; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Priority 1</span>
                                </div>
                                <p style="margin-bottom: 10px;">AI detected 85% failure probability within 48 hours</p>
                                <div style="background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                                    <strong>Recommended Actions:</strong>
                                    <ul style="margin-left: 20px; margin-top: 5px;">
                                        <li>Immediate power isolation</li>
                                        <li>Emergency inspection by Alpha Team</li>
                                        <li>Oil sample analysis</li>
                                        <li>Backup transformer activation</li>
                                    </ul>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;" onclick="executeAction('emergency-inspection')">Execute Now</button>
                                    <button style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">Defer 2h</button>
                                </div>
                            </div>

                            <div class="recommendation-item">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <strong>⚠️ Power Line PWL-001</strong>
                                    <span style="background: #ffc107; color: #333; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Priority 2</span>
                                </div>
                                <p style="margin-bottom: 10px;">Conductor aging detected, 65% failure risk in 2 weeks</p>
                                <div style="background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                                    <strong>Recommended Actions:</strong>
                                    <ul style="margin-left: 20px; margin-top: 5px;">
                                        <li>Schedule inspection within 7 days</li>
                                        <li>Assign Bravo Team (line specialists)</li>
                                        <li>Plan conductor replacement</li>
                                    </ul>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button style="background: #ffc107; color: #333; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;" onclick="executeAction('schedule-inspection')">Schedule</button>
                                    <button style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">Details</button>
                                </div>
                            </div>

                            <div class="recommendation-item completed">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <strong>✅ Circuit Breaker CBR-001</strong>
                                    <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Completed</span>
                                </div>
                                <p style="margin-bottom: 10px;">Preventive maintenance completed by Charlie Team</p>
                                <small style="color: #666;">Completed 2 hours ago | Health improved to 92%</small>
                            </div>
                        </div>

                        <!-- Automation Settings -->
                        <div>
                            <h3 style="margin-bottom: 20px;">⚙️ Automation Configuration</h3>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <h4 style="margin-bottom: 15px;">🤖 Auto-Actions Enabled</h4>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" checked style="margin-right: 10px;"> 
                                        Auto-generate work orders for Priority 1 issues
                                    </label>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" checked style="margin-right: 10px;"> 
                                        Auto-assign teams based on skills and availability
                                    </label>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;"> 
                                        Auto-execute emergency shutdowns (requires approval)
                                    </label>
                                </div>
                                <div>
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" checked style="margin-right: 10px;"> 
                                        Send real-time alerts to team leads
                                    </label>
                                </div>
                            </div>

                            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                                <h4 style="margin-bottom: 15px; color: #1976d2;">📊 Decision Engine Performance</h4>
                                <div class="metric-grid" style="grid-template-columns: 1fr 1fr;">
                                    <div class="metric-item">
                                        <div class="metric-value" style="color: #28a745;">94.2%</div>
                                        <div class="metric-label">Decision Accuracy</div>
                                    </div>
                                    <div class="metric-item">
                                        <div class="metric-value" style="color: #007bff;">2.4s</div>
                                        <div class="metric-label">Avg Response Time</div>
                                    </div>
                                    <div class="metric-item">
                                        <div class="metric-value" style="color: #ffc107;">147</div>
                                        <div class="metric-label">Actions Today</div>
                                    </div>
                                    <div class="metric-item">
                                        <div class="metric-value" style="color: #dc3545;">3</div>
                                        <div class="metric-label">Manual Overrides</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Real-time Action Feed -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">📡 Real-time Action Feed</h3>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; max-height: 300px; overflow-y: auto;">
                            <div style="border-bottom: 1px solid #dee2e6; padding: 10px 0;">
                                <span style="color: #666; font-size: 0.9rem;">14:32:15</span> - 
                                <span style="color: #28a745; font-weight: bold;">AUTO</span> - 
                                Work order WO-20250806-004 created for CBR-002 maintenance
                            </div>
                            <div style="border-bottom: 1px solid #dee2e6; padding: 10px 0;">
                                <span style="color: #666; font-size: 0.9rem;">14:28:42</span> - 
                                <span style="color: #007bff; font-weight: bold;">ASSIGN</span> - 
                                Alpha Team assigned to emergency inspection TXF-001
                            </div>
                            <div style="border-bottom: 1px solid #dee2e6; padding: 10px 0;">
                                <span style="color: #666; font-size: 0.9rem;">14:15:33</span> - 
                                <span style="color: #ffc107; font-weight: bold;">ALERT</span> - 
                                High temperature warning triggered for TXF-001
                            </div>
                            <div style="border-bottom: 1px solid #dee2e6; padding: 10px 0;">
                                <span style="color: #666; font-size: 0.9rem;">13:45:17</span> - 
                                <span style="color: #28a745; font-weight: bold;">COMPLETE</span> - 
                                Charlie Team completed maintenance on CBR-001
                            </div>
                            <div style="padding: 10px 0;">
                                <span style="color: #666; font-size: 0.9rem;">13:22:08</span> - 
                                <span style="color: #dc3545; font-weight: bold;">MANUAL</span> - 
                                User override: Delayed TXF-003 maintenance by 24h
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Predictive Analytics Modal -->
        <div id="predictive-analytics-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>🔮 Predictive Analytics Dashboard</h2>
                    <span class="close" onclick="closeModal('predictive-analytics')">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                        <!-- ML Models & Predictions -->
                        <div>
                            <h3 style="margin-bottom: 20px;">🧠 Machine Learning Models</h3>
                            
                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">📈 Failure Probability Forecast (Next 30 Days)</h4>
                                <canvas id="failure-probability-chart" width="400" height="200"></canvas>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                                <div style="background: #fff5f5; padding: 20px; border-radius: 10px; border-left: 4px solid #dc3545;">
                                    <h4 style="color: #dc3545; margin-bottom: 10px;">🚨 High Risk Assets</h4>
                                    <div style="margin-bottom: 10px;">
                                        <strong>TXF-001</strong> - 85% failure risk
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 85%; background: #dc3545;"></div>
                                        </div>
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>PWL-001</strong> - 65% failure risk
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 65%; background: #ffc107;"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <strong>CBR-003</strong> - 42% failure risk
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 42%; background: #ffc107;"></div>
                                        </div>
                                    </div>
                                </div>

                                <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; border-left: 4px solid #007bff;">
                                    <h4 style="color: #007bff; margin-bottom: 10px;">🔍 Model Insights</h4>
                                    <div style="margin-bottom: 8px;">
                                        <strong>Primary Risk Factors:</strong>
                                        <ul style="margin-left: 20px; margin-top: 5px; font-size: 0.9rem;">
                                            <li>Temperature anomalies (35%)</li>
                                            <li>Vibration patterns (28%)</li>
                                            <li>Age-based degradation (22%)</li>
                                            <li>Load variations (15%)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">🎯 Model Accuracy Trends</h4>
                                <canvas id="model-accuracy-chart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <!-- Model Configuration -->
                        <div>
                            <h3 style="margin-bottom: 20px;">⚙️ Model Configuration</h3>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <h4 style="margin-bottom: 15px;">🔧 Active Models</h4>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                        <span><strong>Transformer Health</strong></span>
                                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Active</span>
                                    </div>
                                    <small style="color: #666;">Random Forest | Accuracy: 89.2%</small>
                                </div>
                                
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                        <span><strong>Power Line Integrity</strong></span>
                                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Active</span>
                                    </div>
                                    <small style="color: #666;">Neural Network | Accuracy: 85.7%</small>
                                </div>

                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                        <span><strong>Circuit Breaker</strong></span>
                                        <span style="background: #ffc107; color: #333; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Training</span>
                                    </div>
                                    <small style="color: #666;">XGBoost | ETA: 2 hours</small>
                                </div>
                            </div>

                            <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <h4 style="margin-bottom: 15px; color: #28a745;">📊 Prediction Stats</h4>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Total Predictions Today:</span>
                                        <strong>247</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>High Risk Alerts:</span>
                                        <strong style="color: #dc3545;">5</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Prevented Failures:</span>
                                        <strong style="color: #28a745;">12 (This Month)</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Cost Savings:</span>
                                        <strong style="color: #007bff;">$147,000</strong>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #fff3cd; padding: 20px; border-radius: 10px;">
                                <h4 style="margin-bottom: 15px; color: #856404;">🎯 Optimization Opportunities</h4>
                                <ul style="margin-left: 20px; font-size: 0.9rem;">
                                    <li style="margin-bottom: 8px;">Add weather data for 12% accuracy boost</li>
                                    <li style="margin-bottom: 8px;">Increase sensor frequency for power lines</li>
                                    <li style="margin-bottom: 8px;">Implement ensemble model for transformers</li>
                                    <li>Collect more failure history data</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Feature Importance -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">🎯 Feature Importance Analysis</h3>
                        <div class="chart-container">
                            <canvas id="feature-importance-chart" width="400" height="200"></canvas>
                        </div>
                    </div>

                    <!-- AI-Generated Predictive Insights -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">🤖 AI-Generated Predictive Insights</h3>
                        <div id="predictive-insights-container" style="display: grid; gap: 15px;">
                            <!-- Insights will be populated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Team Management Modal -->
        <div id="team-management-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>👥 Team Management & Optimization</h2>
                    <span class="close" onclick="closeModal('team-management')">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <!-- Team Overview -->
                        <div>
                            <h3 style="margin-bottom: 20px;">👥 Team Status & Performance</h3>
                            
                            <div class="team-card">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <h4>Alpha Team</h4>
                                    <span style="background: #28a745; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8rem;">🟢 Available</span>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span><strong>Lead:</strong> John Smith</span>
                                        <span><strong>Members:</strong> 4</span>
                                    </div>
                                    <div style="margin-bottom: 5px;">
                                        <strong>Specializations:</strong> Transformers, Circuit Breakers, Emergency Response
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>Current Location:</strong> Substation A (5 min to TXF-001)
                                    </div>
                                </div>
                                <div class="metric-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">95%</div>
                                        <small>Completion Rate</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #007bff;">2.5h</div>
                                        <small>Avg Response</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #ffc107;">8/10</div>
                                        <small>Skill Rating</small>
                                    </div>
                                </div>
                            </div>

                            <div class="team-card">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <h4>Bravo Team</h4>
                                    <span style="background: #ffc107; color: #333; padding: 5px 12px; border-radius: 15px; font-size: 0.8rem;">🟡 Busy</span>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span><strong>Lead:</strong> Sarah Johnson</span>
                                        <span><strong>Members:</strong> 3</span>
                                    </div>
                                    <div style="margin-bottom: 5px;">
                                        <strong>Specializations:</strong> Power Lines, Outdoor Equipment
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>Current Task:</strong> PWL-002 Inspection (ETA: 2h)
                                    </div>
                                </div>
                                <div class="metric-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">88%</div>
                                        <small>Completion Rate</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #ffc107;">3.2h</div>
                                        <small>Avg Response</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">9/10</div>
                                        <small>Skill Rating</small>
                                    </div>
                                </div>
                            </div>

                            <div class="team-card">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <h4>Charlie Team</h4>
                                    <span style="background: #28a745; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8rem;">🟢 Available</span>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span><strong>Lead:</strong> Mike Chen</span>
                                        <span><strong>Members:</strong> 5</span>
                                    </div>
                                    <div style="margin-bottom: 5px;">
                                        <strong>Specializations:</strong> Switchgear, Control Systems, Testing
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>Current Location:</strong> Main Office (Ready for dispatch)
                                    </div>
                                </div>
                                <div class="metric-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">92%</div>
                                        <small>Completion Rate</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">2.8h</div>
                                        <small>Avg Response</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #007bff;">7/10</div>
                                        <small>Skill Rating</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Team Optimization -->
                        <div>
                            <h3 style="margin-bottom: 20px;">⚙️ Smart Assignment Engine</h3>
                            
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <h4 style="margin-bottom: 15px;">🎯 Optimal Team Matching</h4>
                                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #dc3545;">
                                    <div style="margin-bottom: 10px;">
                                        <strong>Emergency Task:</strong> TXF-001 Inspection
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>Required Skills:</strong> Transformer expertise, Emergency response
                                    </div>
                                    <div style="margin-bottom: 15px;">
                                        <strong>AI Recommendation:</strong> 
                                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; margin-left: 5px;">Alpha Team (97% match)</span>
                                    </div>
                                    <div style="font-size: 0.9rem; color: #666;">
                                        <strong>Reasons:</strong> Highest transformer expertise, fastest response time, currently available
                                    </div>
                                </div>

                                <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                                    <div style="margin-bottom: 10px;">
                                        <strong>Scheduled Task:</strong> PWL-003 Maintenance
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <strong>Required Skills:</strong> Power line inspection, Outdoor work
                                    </div>
                                    <div style="margin-bottom: 15px;">
                                        <strong>AI Recommendation:</strong> 
                                        <span style="background: #007bff; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; margin-left: 5px;">Bravo Team (94% match)</span>
                                    </div>
                                    <div style="font-size: 0.9rem; color: #666;">
                                        <strong>Reasons:</strong> Power line specialists, available after current task
                                    </div>
                                </div>
                            </div>

                            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <h4 style="margin-bottom: 15px; color: #1976d2;">📊 Workload Distribution</h4>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Alpha Team</span>
                                        <span>75%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 75%; background: #ffc107;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Bravo Team</span>
                                        <span>85%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 85%; background: #dc3545;"></div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Charlie Team</span>
                                        <span>60%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 60%; background: #28a745;"></div>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #fff3cd; padding: 20px; border-radius: 10px;">
                                <h4 style="margin-bottom: 15px; color: #856404;">💡 Optimization Suggestions</h4>
                                <ul style="margin-left: 20px; font-size: 0.9rem;">
                                    <li style="margin-bottom: 8px;">Cross-train Charlie Team on transformer maintenance</li>
                                    <li style="margin-bottom: 8px;">Add 1 member to Bravo Team for better coverage</li>
                                    <li style="margin-bottom: 8px;">Implement rotating on-call schedule</li>
                                    <li>Consider adding specialist team for emergency response</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Skills Matrix & Training -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">🎯 Skills Matrix & Training Analytics</h3>
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                            <div class="chart-container">
                                <canvas id="skills-matrix-chart" width="400" height="300"></canvas>
                            </div>
                            <div class="chart-container">
                                <canvas id="training-progress-chart" width="300" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Analysis & Monitoring Modal -->
        <div id="data-monitoring-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>🔍 Data Analysis & Monitoring System</h2>
                    <span class="close" onclick="closeModal('data-monitoring')">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <!-- Real-time Monitoring -->
                        <div>
                            <h3 style="margin-bottom: 20px;">📡 Real-time Asset Monitoring</h3>
                            
                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">⚡ Live Health Scores</h4>
                                <div class="bar-chart" id="health-bar-chart">
                                    <div class="bar" style="height: 78%;">
                                        <div class="bar-value">78%</div>
                                        <div class="bar-label">TXF-001</div>
                                    </div>
                                    <div class="bar" style="height: 65%;">
                                        <div class="bar-value">65%</div>
                                        <div class="bar-label">PWL-001</div>
                                    </div>
                                    <div class="bar" style="height: 85%;">
                                        <div class="bar-value">85%</div>
                                        <div class="bar-label">CBR-001</div>
                                    </div>
                                    <div class="bar" style="height: 90%;">
                                        <div class="bar-value">90%</div>
                                        <div class="bar-label">SUB-001</div>
                                    </div>
                                    <div class="bar" style="height: 70%;">
                                        <div class="bar-value">70%</div>
                                        <div class="bar-label">SWI-001</div>
                                    </div>
                                </div>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">📈 Historical Failure Patterns</h4>
                                <div class="line-chart">
                                    <svg class="chart-svg" viewBox="0 0 400 160">
                                        <defs>
                                            <linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                <stop offset="0%" style="stop-color:#28a745;stop-opacity:1" />
                                                <stop offset="50%" style="stop-color:#ffc107;stop-opacity:1" />
                                                <stop offset="100%" style="stop-color:#dc3545;stop-opacity:1" />
                                            </linearGradient>
                                        </defs>
                                        <path class="line-path" stroke="url(#lineGradient)" d="M20,120 Q100,80 180,100 T360,60" />
                                        <circle cx="20" cy="120" r="4" fill="#28a745"/>
                                        <circle cx="100" cy="80" r="4" fill="#ffc107"/>
                                        <circle cx="180" cy="100" r="4" fill="#ffc107"/>
                                        <circle cx="260" cy="90" r="4" fill="#ffc107"/>
                                        <circle cx="360" cy="60" r="4" fill="#dc3545"/>
                                        <text x="20" y="140" font-size="10" text-anchor="middle">Jan</text>
                                        <text x="100" y="140" font-size="10" text-anchor="middle">Mar</text>
                                        <text x="180" y="140" font-size="10" text-anchor="middle">May</text>
                                        <text x="260" y="140" font-size="10" text-anchor="middle">Jul</text>
                                        <text x="360" y="140" font-size="10" text-anchor="middle">Aug</text>
                                    </svg>
                                </div>
                            </div>

                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4 style="margin-bottom: 15px;">🎯 Pattern Recognition Insights</h4>
                                <div style="margin-bottom: 10px;">
                                    <span class="real-time-indicator"></span>
                                    <strong>Seasonal Pattern Detected:</strong> Transformer failures increase 40% in summer months
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <span class="real-time-indicator"></span>
                                    <strong>Load Correlation:</strong> High correlation between peak load hours and equipment stress
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <span class="real-time-indicator"></span>
                                    <strong>Weather Impact:</strong> Storm events precede 65% of power line failures
                                </div>
                                <div>
                                    <span class="real-time-indicator"></span>
                                    <strong>Maintenance Effect:</strong> Preventive maintenance reduces failure rate by 45%
                                </div>
                            </div>
                        </div>

                        <!-- Data Sources & Analytics -->
                        <div>
                            <h3 style="margin-bottom: 20px;">📊 Data Sources & Analytics</h3>
                            
                            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <h4 style="color: #1976d2; margin-bottom: 15px;">🔌 Active Data Streams</h4>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>SCADA Systems</span>
                                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">🟢 Live</span>
                                    </div>
                                    <small style="color: #666;">1,247 sensors | Update: 5s intervals</small>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>Weather Stations</span>
                                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">🟢 Live</span>
                                    </div>
                                    <small style="color: #666;">15 stations | Update: 1min intervals</small>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>Load Forecasts</span>
                                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">🟢 Live</span>
                                    </div>
                                    <small style="color: #666;">Hourly updates | 7-day rolling</small>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>Maintenance Records</span>
                                        <span style="background: #ffc107; color: #333; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">🟡 Sync</span>
                                    </div>
                                    <small style="color: #666;">Historical data | Real-time updates</small>
                                </div>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">🔄 Data Processing Pipeline</h4>
                                <div style="background: white; padding: 20px; border-radius: 8px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                        <div style="width: 60px; height: 40px; background: #007bff; border-radius: 5px; color: white; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">Raw Data</div>
                                        <div style="width: 30px; height: 2px; background: #007bff; margin: 0 10px;"></div>
                                        <div style="width: 60px; height: 40px; background: #28a745; border-radius: 5px; color: white; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">Clean</div>
                                        <div style="width: 30px; height: 2px; background: #28a745; margin: 0 10px;"></div>
                                        <div style="width: 60px; height: 40px; background: #ffc107; border-radius: 5px; color: white; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">Analyze</div>
                                        <div style="width: 30px; height: 2px; background: #ffc107; margin: 0 10px;"></div>
                                        <div style="width: 60px; height: 40px; background: #dc3545; border-radius: 5px; color: white; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">Alert</div>
                                    </div>
                                    <div class="metric-grid" style="grid-template-columns: 1fr 1fr;">
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.5rem; font-weight: bold; color: #007bff;">15.2GB</div>
                                            <small>Data Processed Today</small>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">99.7%</div>
                                            <small>Processing Accuracy</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #fff3cd; padding: 20px; border-radius: 10px;">
                                <h4 style="color: #856404; margin-bottom: 15px;">📈 Analytics Performance</h4>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Anomaly Detection Rate:</span>
                                        <strong>94.2%</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>False Positive Rate:</span>
                                        <strong>3.8%</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Data Latency:</span>
                                        <strong>1.2 seconds</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Storage Efficiency:</span>
                                        <strong>87.3%</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export Section -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">💾 Data Export & Reports</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="export-button" onclick="exportData('sensor-data', 'CSV')">📊 Export Sensor Data (CSV)</button>
                            <button class="export-button" onclick="exportData('health-scores', 'Excel')">📈 Export Health Scores (Excel)</button>
                            <button class="export-button" onclick="exportData('failure-patterns', 'PDF')">📋 Failure Patterns Report (PDF)</button>
                            <button class="export-button" onclick="exportData('analytics-summary', 'JSON')">🔍 Analytics Summary (JSON)</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization & Alerts Modal -->
        <div id="visualization-alerts-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>📊 Visualization & Alert Management</h2>
                    <span class="close" onclick="closeModal('visualization-alerts')">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                        <!-- Visualizations -->
                        <div>
                            <h3 style="margin-bottom: 20px;">📈 Real-time Visualizations</h3>
                            
                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">🎯 Asset Health Distribution</h4>
                                <div style="display: flex; justify-content: center; align-items: center;">
                                    <svg class="pie-chart" viewBox="0 0 200 200">
                                        <circle cx="100" cy="100" r="80" fill="none" stroke="#e9ecef" stroke-width="20"/>
                                        <circle cx="100" cy="100" r="80" fill="none" stroke="#28a745" stroke-width="20" 
                                                stroke-dasharray="150 502" stroke-dashoffset="0" transform="rotate(-90 100 100)"/>
                                        <circle cx="100" cy="100" r="80" fill="none" stroke="#ffc107" stroke-width="20" 
                                                stroke-dasharray="100 502" stroke-dashoffset="-150" transform="rotate(-90 100 100)"/>
                                        <circle cx="100" cy="100" r="80" fill="none" stroke="#dc3545" stroke-width="20" 
                                                stroke-dasharray="75 502" stroke-dashoffset="-250" transform="rotate(-90 100 100)"/>
                                        <text x="100" y="105" text-anchor="middle" font-size="16" font-weight="bold">Health</text>
                                        <text x="100" y="120" text-anchor="middle" font-size="16" font-weight="bold">Status</text>
                                    </svg>
                                </div>
                                <div style="display: flex; justify-content: space-around; margin-top: 15px;">
                                    <div style="text-align: center;">
                                        <div style="width: 20px; height: 20px; background: #28a745; border-radius: 50%; margin: 0 auto 5px;"></div>
                                        <small>Excellent (60%)</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="width: 20px; height: 20px; background: #ffc107; border-radius: 50%; margin: 0 auto 5px;"></div>
                                        <small>Good (25%)</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="width: 20px; height: 20px; background: #dc3545; border-radius: 50%; margin: 0 auto 5px;"></div>
                                        <small>Poor (15%)</small>
                                    </div>
                                </div>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">⚡ System Performance Gauges</h4>
                                <div style="display: flex; justify-content: space-around;">
                                    <div class="gauge-chart">
                                        <svg viewBox="0 0 150 150">
                                            <circle cx="75" cy="75" r="60" class="gauge-background"/>
                                            <circle cx="75" cy="75" r="60" class="gauge-progress" 
                                                    stroke="#28a745" stroke-dasharray="377" stroke-dashoffset="75"/>
                                            <text x="75" y="80" text-anchor="middle" font-size="16" font-weight="bold">99.7%</text>
                                            <text x="75" y="95" text-anchor="middle" font-size="10">Availability</text>
                                        </svg>
                                    </div>
                                    <div class="gauge-chart">
                                        <svg viewBox="0 0 150 150">
                                            <circle cx="75" cy="75" r="60" class="gauge-background"/>
                                            <circle cx="75" cy="75" r="60" class="gauge-progress" 
                                                    stroke="#007bff" stroke-dasharray="377" stroke-dashoffset="113"/>
                                            <text x="75" y="80" text-anchor="middle" font-size="16" font-weight="bold">70%</text>
                                            <text x="75" y="95" text-anchor="middle" font-size="10">Efficiency</text>
                                        </svg>
                                    </div>
                                    <div class="gauge-chart">
                                        <svg viewBox="0 0 150 150">
                                            <circle cx="75" cy="75" r="60" class="gauge-background"/>
                                            <circle cx="75" cy="75" r="60" class="gauge-progress" 
                                                    stroke="#ffc107" stroke-dasharray="377" stroke-dashoffset="94"/>
                                            <text x="75" y="80" text-anchor="middle" font-size="16" font-weight="bold">75%</text>
                                            <text x="75" y="95" text-anchor="middle" font-size="10">Capacity</text>
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">📊 Live Asset Status Board</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                    <div style="background: #d4edda; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #28a745;">
                                        <div style="font-size: 1.5rem; margin-bottom: 5px;">🔌</div>
                                        <div style="font-weight: bold;">TXF-001</div>
                                        <div style="color: #28a745; font-size: 1.2rem;">78%</div>
                                        <small>Transformer</small>
                                    </div>
                                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #ffc107;">
                                        <div style="font-size: 1.5rem; margin-bottom: 5px;">⚡</div>
                                        <div style="font-weight: bold;">PWL-001</div>
                                        <div style="color: #ffc107; font-size: 1.2rem;">65%</div>
                                        <small>Power Line</small>
                                    </div>
                                    <div style="background: #d4edda; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #28a745;">
                                        <div style="font-size: 1.5rem; margin-bottom: 5px;">🔧</div>
                                        <div style="font-weight: bold;">CBR-001</div>
                                        <div style="color: #28a745; font-size: 1.2rem;">85%</div>
                                        <small>Circuit Breaker</small>
                                    </div>
                                    <div style="background: #d4edda; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #28a745;">
                                        <div style="font-size: 1.5rem; margin-bottom: 5px;">🏢</div>
                                        <div style="font-weight: bold;">SUB-001</div>
                                        <div style="color: #28a745; font-size: 1.2rem;">90%</div>
                                        <small>Substation</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Alert Management -->
                        <div>
                            <h3 style="margin-bottom: 20px;">🚨 Alert Management</h3>
                            
                            <div class="alert-panel">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <strong>🚨 CRITICAL ALERT</strong>
                                    <span style="font-size: 0.8rem;">2 min ago</span>
                                </div>
                                <div style="margin-bottom: 5px;">TXF-001: Temperature Exceeded</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">85°C detected | Threshold: 75°C</div>
                                <div style="margin-top: 10px;">
                                    <button style="background: rgba(255,255,255,0.2); border: 1px solid white; color: white; padding: 5px 10px; border-radius: 3px; cursor: pointer; margin-right: 10px;">Acknowledge</button>
                                    <button style="background: rgba(255,255,255,0.2); border: 1px solid white; color: white; padding: 5px 10px; border-radius: 3px; cursor: pointer;">View Details</button>
                                </div>
                            </div>

                            <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin: 10px 0; border-left: 4px solid #ffc107;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <strong style="color: #856404;">⚠️ WARNING</strong>
                                    <span style="font-size: 0.8rem; color: #856404;">15 min ago</span>
                                </div>
                                <div style="color: #856404; margin-bottom: 5px;">PWL-001: Load Approaching Limit</div>
                                <div style="font-size: 0.9rem; color: #856404;">Current: 94% | Threshold: 95%</div>
                            </div>

                            <div style="background: #d1ecf1; padding: 15px; border-radius: 10px; margin: 10px 0; border-left: 4px solid #17a2b8;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <strong style="color: #0c5460;">ℹ️ INFO</strong>
                                    <span style="font-size: 0.8rem; color: #0c5460;">1 hour ago</span>
                                </div>
                                <div style="color: #0c5460; margin-bottom: 5px;">CBR-001: Maintenance Completed</div>
                                <div style="font-size: 0.9rem; color: #0c5460;">Health improved to 85%</div>
                            </div>

                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                                <h4 style="margin-bottom: 15px;">📊 Alert Statistics</h4>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Today's Alerts:</span>
                                        <strong>23</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Critical:</span>
                                        <strong style="color: #dc3545;">3</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Warnings:</span>
                                        <strong style="color: #ffc107;">12</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Avg Response Time:</span>
                                        <strong>4.2 min</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Resolution Rate:</span>
                                        <strong style="color: #28a745;">92%</strong>
                                    </div>
                                </div>
                            </div>

                            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin-top: 20px;">
                                <h4 style="color: #1976d2; margin-bottom: 15px;">⚙️ Alert Configuration</h4>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" checked style="margin-right: 10px;"> 
                                        Email notifications
                                    </label>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" checked style="margin-right: 10px;"> 
                                        SMS for critical alerts
                                    </label>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;"> 
                                        Auto-escalation after 30min
                                    </label>
                                </div>
                                <div>
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="checkbox" checked style="margin-right: 10px;"> 
                                        Dashboard sound alerts
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export Section -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">💾 Visualization & Alert Exports</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="export-button" onclick="exportData('dashboard-snapshot', 'PDF')">📸 Dashboard Snapshot (PDF)</button>
                            <button class="export-button" onclick="exportData('alert-log', 'CSV')">🚨 Alert Log (CSV)</button>
                            <button class="export-button" onclick="exportData('visualization-config', 'JSON')">⚙️ Chart Config (JSON)</button>
                            <button class="export-button" onclick="exportData('performance-report', 'Excel')">📊 Performance Report (Excel)</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Analytics Modal -->
        <div id="performance-analytics-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>📈 Performance Analytics & KPIs</h2>
                    <span class="close" onclick="closeModal('performance-analytics')">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                        <!-- Key Performance Indicators -->
                        <div>
                            <h3 style="margin-bottom: 20px;">🎯 Key Performance Indicators</h3>
                            
                            <div class="metric-grid">
                                <div class="metric-item" style="border-left-color: #28a745;">
                                    <div class="metric-value" style="color: #28a745;">99.7%</div>
                                    <div class="metric-label">System Availability</div>
                                    <small style="color: #28a745;">↑ +0.3% vs last month</small>
                                </div>
                                <div class="metric-item" style="border-left-color: #007bff;">
                                    <div class="metric-value" style="color: #007bff;">2,847h</div>
                                    <div class="metric-label">Mean Time Between Failures</div>
                                    <small style="color: #28a745;">↑ +15.2% vs last month</small>
                                </div>
                                <div class="metric-item" style="border-left-color: #ffc107;">
                                    <div class="metric-value" style="color: #ffc107;">4.2h</div>
                                    <div class="metric-label">Mean Time To Repair</div>
                                    <small style="color: #28a745;">↓ -27.6% vs last month</small>
                                </div>
                                <div class="metric-item" style="border-left-color: #dc3545;">
                                    <div class="metric-value" style="color: #dc3545;">3</div>
                                    <div class="metric-label">Unplanned Outages</div>
                                    <small style="color: #28a745;">↓ -57% vs last month</small>
                                </div>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">📊 System Performance Trends (6 Months)</h4>
                                <canvas id="performance-trends-chart" width="400" height="200"></canvas>
                            </div>

                            <div class="chart-container">
                                <h4 style="margin-bottom: 15px;">⚡ Asset Performance Breakdown</h4>
                                <canvas id="asset-performance-chart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <!-- Performance Insights -->
                        <div>
                            <h3 style="margin-bottom: 20px;">💡 Performance Insights</h3>
                            
                            <div style="background: #d4edda; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #28a745;">
                                <h4 style="color: #155724; margin-bottom: 10px;">🏆 Top Performers</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>SUB-001</strong> - 99.9% uptime
                                    <div style="font-size: 0.9rem; color: #666;">Best performing substation</div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>CBR-002</strong> - Zero failures
                                    <div style="font-size: 0.9rem; color: #666;">Excellent maintenance record</div>
                                </div>
                                <div>
                                    <strong>Alpha Team</strong> - 95% efficiency
                                    <div style="font-size: 0.9rem; color: #666;">Fastest response times</div>
                                </div>
                            </div>

                            <div style="background: #f8d7da; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #dc3545;">
                                <h4 style="color: #721c24; margin-bottom: 10px;">⚠️ Attention Required</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>TXF-001</strong> - 42% health score
                                    <div style="font-size: 0.9rem; color: #666;">Requires immediate attention</div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>PWL-001</strong> - Aging conductor
                                    <div style="font-size: 0.9rem; color: #666;">Schedule replacement soon</div>
                                </div>
                                <div>
                                    <strong>Bravo Team</strong> - High workload
                                    <div style="font-size: 0.9rem; color: #666;">Consider redistributing tasks</div>
                                </div>
                            </div>

                            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                                <h4 style="color: #856404; margin-bottom: 10px;">📈 Trends Analysis</h4>
                                <ul style="margin-left: 20px; font-size: 0.9rem;">
                                    <li style="margin-bottom: 5px;">Summer months show 40% more transformer issues</li>
                                    <li style="margin-bottom: 5px;">Preventive maintenance reducing failures by 35%</li>
                                    <li style="margin-bottom: 5px;">AI predictions preventing 2-3 failures/month</li>
                                    <li>Response times improved 27% with smart dispatching</li>
                                </ul>
                            </div>

                            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                                <h4 style="color: #1976d2; margin-bottom: 15px;">💰 Financial Impact</h4>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Cost Savings (YTD):</span>
                                        <strong style="color: #28a745;">$1.2M</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Avoided Outage Costs:</span>
                                        <strong style="color: #28a745;">$890K</strong>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Maintenance Efficiency:</span>
                                        <strong style="color: #007bff;">+35%</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>ROI on AI System:</span>
                                        <strong style="color: #28a745;">340%</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Metrics -->
                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 20px;">📊 Detailed Performance Metrics</h3>
                        <div class="chart-container">
                            <canvas id="detailed-metrics-chart" width="400" height="200"></canvas>
                        </div>
                    </div>

                    <!-- Performance Improvement Recommendations -->
                    <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px; border: 1px solid #dee2e6;">
                        <h3 style="margin-bottom: 20px; color: #495057;">🎯 Performance Improvement Recommendations</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <!-- High Priority Actions -->
                            <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #dc3545; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <h4 style="color: #dc3545; margin-bottom: 15px; display: flex; align-items: center;">
                                    🚨 High Priority Actions
                                    <span style="background: #dc3545; color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; margin-left: 10px;">URGENT</span>
                                </h4>
                                <div class="recommendation-item" style="margin-bottom: 12px; padding: 10px; background: #fff5f5; border-radius: 6px;">
                                    <strong style="color: #dc3545;">MTTR Optimization</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        Current: 4.2h | Target: &lt;4h<br>
                                        <em>→ Implement mobile diagnostic tools for 25% faster response</em>
                                    </div>
                                </div>
                                <div class="recommendation-item" style="margin-bottom: 12px; padding: 10px; background: #fff5f5; border-radius: 6px;">
                                    <strong style="color: #dc3545;">Asset Health Monitoring</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        3 assets below 80% health<br>
                                        <em>→ Schedule immediate inspections for T-001, PL-045</em>
                                    </div>
                                </div>
                                <div class="recommendation-item" style="padding: 10px; background: #fff5f5; border-radius: 6px;">
                                    <strong style="color: #dc3545;">Cost Control</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        Maintenance costs 15% above target<br>
                                        <em>→ Review vendor contracts and spare parts inventory</em>
                                    </div>
                                </div>
                            </div>

                            <!-- Medium Priority Improvements -->
                            <div style="background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <h4 style="color: #ffc107; margin-bottom: 15px; display: flex; align-items: center;">
                                    ⚡ Medium Priority Improvements
                                    <span style="background: #ffc107; color: black; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; margin-left: 10px;">PLANNED</span>
                                </h4>
                                <div class="recommendation-item" style="margin-bottom: 12px; padding: 10px; background: #fffbf0; border-radius: 6px;">
                                    <strong style="color: #856404;">Energy Efficiency</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        Current: 92.5% | Target: 95%<br>
                                        <em>→ Upgrade transformer cooling systems in Q2</em>
                                    </div>
                                </div>
                                <div class="recommendation-item" style="margin-bottom: 12px; padding: 10px; background: #fffbf0; border-radius: 6px;">
                                    <strong style="color: #856404;">Predictive Analytics</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        ML model accuracy: 89%<br>
                                        <em>→ Integrate weather data for 3-5% improvement</em>
                                    </div>
                                </div>
                                <div class="recommendation-item" style="padding: 10px; background: #fffbf0; border-radius: 6px;">
                                    <strong style="color: #856404;">Team Training</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        78% completion rate<br>
                                        <em>→ Focus on advanced diagnostics certification</em>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Long-term Strategic Initiatives -->
                        <div style="margin-top: 20px; background: white; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <h4 style="color: #28a745; margin-bottom: 15px; display: flex; align-items: center;">
                                🌟 Long-term Strategic Initiatives
                                <span style="background: #28a745; color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; margin-left: 10px;">ROADMAP</span>
                            </h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                                <div style="padding: 12px; background: #f8fff8; border-radius: 6px; border: 1px solid #d4edda;">
                                    <strong style="color: #155724;">🔮 Digital Twin Implementation</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        Create virtual replicas of critical assets for advanced simulation and optimization
                                        <div style="margin-top: 6px;">
                                            <span style="font-size: 0.8rem; color: #28a745;">ROI: +240% | Timeline: 18 months</span>
                                        </div>
                                    </div>
                                </div>
                                <div style="padding: 12px; background: #f8fff8; border-radius: 6px; border: 1px solid #d4edda;">
                                    <strong style="color: #155724;">🤖 Autonomous Maintenance</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        Deploy drone-based inspections and self-healing grid technologies
                                        <div style="margin-top: 6px;">
                                            <span style="font-size: 0.8rem; color: #28a745;">Cost Reduction: -35% | Timeline: 24 months</span>
                                        </div>
                                    </div>
                                </div>
                                <div style="padding: 12px; background: #f8fff8; border-radius: 6px; border: 1px solid #d4edda;">
                                    <strong style="color: #155724;">📡 IoT Sensor Network</strong>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 4px;">
                                        Expand real-time monitoring coverage to 95% of transmission assets
                                        <div style="margin-top: 6px;">
                                            <span style="font-size: 0.8rem; color: #28a745;">Uptime Improvement: +2.5% | Timeline: 12 months</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Performance Benchmarking -->
                        <div style="margin-top: 20px; background: linear-gradient(45deg, #e3f2fd 0%, #f3e5f5 100%); padding: 20px; border-radius: 10px; border: 1px solid #bbdefb;">
                            <h4 style="color: #1565c0; margin-bottom: 15px;">📊 Industry Benchmarking & Best Practices</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                                <div style="text-align: center; padding: 15px;">
                                    <div style="font-size: 1.8rem; color: #1976d2; font-weight: bold;">Top 10%</div>
                                    <div style="font-size: 0.9rem; color: #666;">Industry Ranking</div>
                                    <div style="font-size: 0.8rem; color: #28a745; margin-top: 4px;">↑ Up from Top 15%</div>
                                </div>
                                <div style="text-align: center; padding: 15px;">
                                    <div style="font-size: 1.8rem; color: #1976d2; font-weight: bold;">99.7%</div>
                                    <div style="font-size: 0.9rem; color: #666;">vs 99.2% Average</div>
                                    <div style="font-size: 0.8rem; color: #28a745; margin-top: 4px;">System Availability</div>
                                </div>
                                <div style="text-align: center; padding: 15px;">
                                    <div style="font-size: 1.8rem; color: #1976d2; font-weight: bold;">$1.2M</div>
                                    <div style="font-size: 0.9rem; color: #666;">Annual Savings</div>
                                    <div style="font-size: 0.8rem; color: #28a745; margin-top: 4px;">AI-Driven Optimization</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <!-- Asset Database Modal -->
        <div id="asset-database-modal" class="modal">
            <div class="modal-content" style="max-width: 95%; height: 90vh;">
                <div class="modal-header">
                    <h2>🏭 Comprehensive Asset Database</h2>
                    <span class="close" onclick="closeModal('asset-database')">&times;</span>
                </div>
                <div class="modal-body" style="height: calc(90vh - 80px); overflow-y: auto;">
                    <!-- Search and Filter Controls -->
                    <div style="display: flex; gap: 20px; margin-bottom: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px; align-items: center;">
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">🔍 Search Assets:</label>
                            <input type="text" id="asset-search" placeholder="Search by ID, name, location, or type..." 
                                   style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;"
                                   oninput="filterAssets()">
                        </div>
                        <div style="flex: 0 0 200px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">🏷️ Filter by Type:</label>
                            <select id="asset-type-filter" onchange="filterAssets()" 
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="">All Types</option>
                                <option value="Transformer">Transformers</option>
                                <option value="Transmission Line">Transmission Lines</option>
                                <option value="Distribution Line">Distribution Lines</option>
                                <option value="Circuit Breaker">Circuit Breakers</option>
                                <option value="Switch">Switches</option>
                                <option value="Substation">Substations</option>
                                <option value="Capacitor Bank">Capacitor Banks</option>
                                <option value="Reactor">Reactors</option>
                                <option value="Protection Relay">Protection Relays</option>
                                <option value="Current Transformer">Current Transformers</option>
                                <option value="Voltage Transformer">Voltage Transformers</option>
                                <option value="RTU">RTUs</option>
                                <option value="Power Quality Monitor">Power Quality</option>
                            </select>
                        </div>
                        <div style="flex: 0 0 150px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">📍 Location:</label>
                            <select id="asset-location-filter" onchange="filterAssets()" 
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="">All Locations</option>
                                <option value="Central">Central Substation</option>
                                <option value="North">North Substation</option>
                                <option value="East">East Substation</option>
                                <option value="West">West Substation</option>
                                <option value="South">South Substation</option>
                                <option value="Control Center">Control Centers</option>
                                <option value="District">Districts</option>
                                <option value="Corridor">Corridors</option>
                                <option value="Mobile">Mobile Units</option>
                                <option value="Network">Distribution Network</option>
                            </select>
                        </div>
                        <div style="flex: 0 0 120px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">⚡ Health:</label>
                            <select id="asset-health-filter" onchange="filterAssets()" 
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="">All Health</option>
                                <option value="excellent">Excellent (90+)</option>
                                <option value="good">Good (75-89)</option>
                                <option value="fair">Fair (60-74)</option>
                                <option value="poor">Poor (<60)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Asset Count Summary -->
                    <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0; color: white;">📊 Asset Overview</h3>
                                <div id="asset-summary" style="margin-top: 10px; font-size: 0.9rem;">
                                    Total: 45 assets | Displaying: <span id="filtered-count">45</span> assets
                                </div>
                            </div>
                            <div style="display: flex; gap: 15px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold;" id="excellent-count">12</div>
                                    <div style="font-size: 0.8rem;">Excellent</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold;" id="good-count">25</div>
                                    <div style="font-size: 0.8rem;">Good</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold;" id="fair-count">6</div>
                                    <div style="font-size: 0.8rem;">Fair</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold;" id="poor-count">2</div>
                                    <div style="font-size: 0.8rem;">Poor</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Asset Grid -->
                    <div id="asset-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 20px;">
                        <!-- Assets will be populated here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Critical Assets Modal -->
        <div id="critical-assets-modal" class="modal">
            <div class="modal-content" style="max-width: 95%; height: 90vh;">
                <div class="modal-header">
                    <h2>🚨 Critical Assets Management</h2>
                    <span class="close" onclick="closeModal('critical-assets')">&times;</span>
                </div>
                <div class="modal-body" style="overflow-y: auto; height: calc(100% - 140px);">
                    <!-- Critical Assets Dashboard -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div style="background: linear-gradient(135deg, #dc3545, #c82333); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <h3 style="margin: 0 0 10px 0;">High Risk</h3>
                            <div style="font-size: 2.5rem; font-weight: bold;" id="critical-high-risk">0</div>
                            <p style="margin: 5px 0 0 0;">Immediate attention needed</p>
                        </div>
                        <div style="background: linear-gradient(135deg, #fd7e14, #e55300); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <h3 style="margin: 0 0 10px 0;">Medium-High Risk</h3>
                            <div style="font-size: 2.5rem; font-weight: bold;" id="critical-medium-high-risk">0</div>
                            <p style="margin: 5px 0 0 0;">Elevated risk levels</p>
                        </div>
                        <div style="background: linear-gradient(135deg, #ffc107, #d39e00); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <h3 style="margin: 0 0 10px 0;">Medium Risk</h3>
                            <div style="font-size: 2.5rem; font-weight: bold;" id="critical-medium-risk">0</div>
                            <p style="margin: 5px 0 0 0;">Under monitoring</p>
                        </div>
                        <div style="background: linear-gradient(135deg, #6c757d, #545b62); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <h3 style="margin: 0 0 10px 0;">Total Critical</h3>
                            <div style="font-size: 2.5rem; font-weight: bold;" id="total-critical-assets">0</div>
                            <p style="margin: 5px 0 0 0;">Assets below 70% health</p>
                        </div>
                    </div>

                    <!-- Additional Metrics -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center;">
                            <h4 style="margin: 0 0 10px 0; color: #666;">Average Health Score</h4>
                            <div style="font-size: 2rem; font-weight: bold; color: #fd7e14;" id="avg-critical-health">65.0%</div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center;">
                            <h4 style="margin: 0 0 10px 0; color: #666;">Pending Inspections</h4>
                            <div style="font-size: 2rem; font-weight: bold; color: #dc3545;" id="pending-inspections">0</div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center;">
                            <h4 style="margin: 0 0 10px 0; color: #666;">Failure Risk (Next 30 Days)</h4>
                            <div style="font-size: 2rem; font-weight: bold; color: #dc3545;">12%</div>
                        </div>
                    </div>

                    <!-- Analytics Charts -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h4 style="margin-bottom: 15px;">🔥 Risk Distribution</h4>
                            <div style="position: relative; height: 250px; width: 100%;">
                                <canvas id="critical-risk-chart"></canvas>
                            </div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h4 style="margin-bottom: 15px;">📈 Health Trend (Last 30 Days)</h4>
                            <div style="position: relative; height: 250px; width: 100%;">
                                <canvas id="critical-health-trend-chart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Filters and Controls -->
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px;">
                        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Filter by Risk Level:</label>
                                <select id="critical-risk-filter" onchange="window.criticalAssetsManager?.filterAssets()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Risk Levels</option>
                                    <option value="High">High Risk</option>
                                    <option value="Medium-High">Medium-High Risk</option>
                                    <option value="Medium">Medium Risk</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Asset Type:</label>
                                <select id="critical-type-filter" onchange="window.criticalAssetsManager?.filterAssets()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Types</option>
                                    <option value="Transformer">Transformers</option>
                                    <option value="Power Line">Power Lines</option>
                                    <option value="Circuit Breaker">Circuit Breakers</option>
                                    <option value="Switch">Switches</option>
                                    <option value="Substation">Substations</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Priority:</label>
                                <select id="critical-priority-filter" onchange="window.criticalAssetsManager?.filterAssets()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Priorities</option>
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                </select>
                            </div>
                            <div style="margin-left: auto;">
                                <button onclick="window.criticalAssetsManager?.exportData()" style="background: #28a745; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                                    📊 Export CSV
                                </button>
                                <button onclick="window.criticalAssetsManager?.generateReport()" style="background: #dc3545; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">
                                    📄 Generate Report
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Critical Assets List -->
                    <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="padding: 20px; border-bottom: 1px solid #eee;">
                            <h4 style="margin: 0;">🔍 Critical Assets Details</h4>
                        </div>
                        <div id="critical-assets-list" style="padding: 20px;">
                            <!-- Critical assets will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Active Alerts Modal -->
        <div id="active-alerts-modal" class="modal">
            <div class="modal-content" style="max-width: 1200px; width: 95%;">
                <div class="modal-header">
                    <h2>🚨 Active Alerts Management</h2>
                    <span class="close" onclick="closeModal('active-alerts')">&times;</span>
                </div>
                <div class="modal-body">
                    <!-- Alerts Dashboard Summary -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: linear-gradient(135deg, #dc3545, #c82333); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="critical-alerts-count">3</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Critical Alerts</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #fd7e14, #e76500); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="high-alerts-count">4</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">High Priority</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #17a2b8, #138496); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="avg-response-time">12</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Avg Response (min)</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #28a745, #218838); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="resolved-today">18</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Resolved Today</div>
                        </div>
                    </div>

                    <!-- Alert Analytics Charts -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                        <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px;">
                            <h4 style="margin: 0 0 15px 0;">📊 Alert Distribution</h4>
                            <div style="position: relative; height: 200px; width: 100%;">
                                <canvas id="alert-distribution-chart"></canvas>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px;">
                            <h4 style="margin: 0 0 15px 0;">⏱️ Response Time Trends</h4>
                            <div style="position: relative; height: 200px; width: 100%;">
                                <canvas id="response-time-chart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Filters and Actions -->
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Severity:</label>
                                <select id="alert-severity-filter" onchange="window.activeAlertsManager?.filterAlerts()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Severities</option>
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Status:</label>
                                <select id="alert-status-filter" onchange="window.activeAlertsManager?.filterAlerts()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Statuses</option>
                                    <option value="Active">Active</option>
                                    <option value="Acknowledged">Acknowledged</option>
                                    <option value="In Progress">In Progress</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Asset Type:</label>
                                <select id="alert-asset-filter" onchange="window.activeAlertsManager?.filterAlerts()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Assets</option>
                                    <option value="Transformer">Transformer</option>
                                    <option value="Power Line">Power Line</option>
                                    <option value="Substation">Substation</option>
                                    <option value="Breaker">Breaker</option>
                                </select>
                            </div>
                            <div style="margin-left: auto;">
                                <button onclick="window.activeAlertsManager?.acknowledgeAll()" style="background: #17a2b8; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                                    ✅ Acknowledge All
                                </button>
                                <button onclick="window.activeAlertsManager?.exportData()" style="background: #28a745; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">
                                    📊 Export Report
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Active Alerts List -->
                    <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="padding: 20px; border-bottom: 1px solid #eee;">
                            <h4 style="margin: 0;">🔔 Active Alerts</h4>
                        </div>
                        <div id="active-alerts-list" style="padding: 20px;">
                            <!-- Active alerts will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pending Work Orders Modal -->
        <div id="pending-work-orders-modal" class="modal">
            <div class="modal-content" style="max-width: 1200px; width: 95%;">
                <div class="modal-header">
                    <h2>🔧 Pending Work Orders Management</h2>
                    <span class="close" onclick="closeModal('pending-work-orders')">&times;</span>
                </div>
                <div class="modal-body">
                    <!-- Work Orders Dashboard Summary -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: linear-gradient(135deg, #dc3545, #c82333); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="urgent-orders-count">3</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Urgent Orders</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #fd7e14, #e76500); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="overdue-orders-count">2</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Overdue Orders</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #17a2b8, #138496); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="avg-completion-time">4.2</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Avg Days to Complete</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #28a745, #218838); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold;" id="completed-this-week">25</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">Completed This Week</div>
                        </div>
                    </div>

                    <!-- Work Order Analytics Charts -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                        <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px;">
                            <h4 style="margin: 0 0 15px 0;">📋 Work Order Status</h4>
                            <div style="position: relative; height: 200px; width: 100%;">
                                <canvas id="work-order-status-chart"></canvas>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px;">
                            <h4 style="margin: 0 0 15px 0;">📈 Completion Trends</h4>
                            <div style="position: relative; height: 200px; width: 100%;">
                                <canvas id="completion-trends-chart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Filters and Actions -->
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Priority:</label>
                                <select id="order-priority-filter" onchange="window.workOrdersManager?.filterOrders()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Priorities</option>
                                    <option value="Urgent">Urgent</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Type:</label>
                                <select id="order-type-filter" onchange="window.workOrdersManager?.filterOrders()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Types</option>
                                    <option value="Preventive">Preventive</option>
                                    <option value="Corrective">Corrective</option>
                                    <option value="Emergency">Emergency</option>
                                    <option value="Inspection">Inspection</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Assigned Team:</label>
                                <select id="order-team-filter" onchange="window.workOrdersManager?.filterOrders()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option value="">All Teams</option>
                                    <option value="Team Alpha">Team Alpha</option>
                                    <option value="Team Beta">Team Beta</option>
                                    <option value="Team Gamma">Team Gamma</option>
                                    <option value="Emergency Response">Emergency Response</option>
                                </select>
                            </div>
                            <div style="margin-left: auto;">
                                <button onclick="window.workOrdersManager?.createOrder()" style="background: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                                    ➕ Create Order
                                </button>
                                <button onclick="window.workOrdersManager?.exportData()" style="background: #28a745; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">
                                    📊 Export Report
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Pending Work Orders List -->
                    <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="padding: 20px; border-bottom: 1px solid #eee;">
                            <h4 style="margin: 0;">📋 Pending Work Orders</h4>
                        </div>
                        <div id="pending-work-orders-list" style="padding: 20px;">
                            <!-- Pending work orders will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2025 Transmission Utility AI Agent | Intelligent Asset Management System</p>
            <p>For API access and advanced features, start the backend server: <code>python backend/main.py</code></p>
        </div>
    </div>

    <script>
        // Update current time - Enhanced version with visual feedback
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.textContent = `🕐 ${timeString}`;
                // Add subtle pulse effect on update
                timeElement.style.opacity = '0.7';
                setTimeout(() => {
                    timeElement.style.opacity = '1';
                }, 100);
            }
        }

        // Refresh data simulation
        function refreshData() {
            const btn = document.querySelector('.refresh-btn');
            btn.textContent = '🔄 Refreshing...';
            btn.disabled = true;
            
            // Simulate data refresh
            setTimeout(() => {
                btn.textContent = '✅ Updated';
                setTimeout(() => {
                    btn.textContent = '🔄 Refresh Data';
                    btn.disabled = false;
                }, 1000);
            }, 2000);
            
            // Add some visual feedback
            document.querySelector('.status-dot').style.animation = 'pulse 0.5s infinite';
            setTimeout(() => {
                document.querySelector('.status-dot').style.animation = 'pulse 2s infinite';
            }, 3000);
        }

        // Simulate real-time updates
        function simulateRealTimeUpdates() {
            // Randomly update some metrics
            const metrics = document.querySelectorAll('.stat-number');
            metrics.forEach(metric => {
                const currentValue = parseInt(metric.textContent);
                const change = Math.floor(Math.random() * 3) - 1; // -1, 0, or 1
                const newValue = Math.max(0, currentValue + change);
                metric.textContent = newValue;
            });
            
            // Update health bars occasionally
            if (Math.random() < 0.3) {
                const healthBars = document.querySelectorAll('.health-bar');
                healthBars.forEach(bar => {
                    const currentWidth = parseInt(bar.style.width);
                    const change = Math.floor(Math.random() * 10) - 5; // -5 to 5
                    const newWidth = Math.max(10, Math.min(100, currentWidth + change));
                    bar.style.width = newWidth + '%';
                    
                    // Update color based on width
                    if (newWidth >= 80) {
                        bar.className = 'health-bar excellent';
                    } else if (newWidth >= 60) {
                        bar.className = 'health-bar good';
                    } else if (newWidth >= 40) {
                        bar.className = 'health-bar fair';
                    } else {
                        bar.className = 'health-bar poor';
                    }
                });
            }
        }

        // Live Data Generation System
        class LiveDataGenerator {
            constructor() {
                this.sensors = this.initializeSensors();
                this.assets = this.initializeAssets();
                this.alerts = [];
                this.workOrders = [];
                this.teams = this.initializeTeams();
                this.isRunning = false;
                this.dataGenerationInterval = null;
                this.dashboardUpdateInterval = null;
            }

            initializeSensors() {
                return [
                    // Transformer Sensors
                    { id: 'TXF-001-TEMP', assetId: 'TXF-001', type: 'Temperature', unit: '°C', baseValue: 75, variance: 15, threshold: 85, status: 'Normal' },
                    { id: 'TXF-001-VIBR', assetId: 'TXF-001', type: 'Vibration', unit: 'mm/s', baseValue: 2.0, variance: 1.5, threshold: 4.0, status: 'Normal' },
                    { id: 'TXF-001-VOLT', assetId: 'TXF-001', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    { id: 'TXF-001-LOAD', assetId: 'TXF-001', type: 'Load', unit: 'MVA', baseValue: 240, variance: 60, threshold: 300, status: 'Normal' },
                    
                    { id: 'TXF-002-TEMP', assetId: 'TXF-002', type: 'Temperature', unit: '°C', baseValue: 68, variance: 12, threshold: 80, status: 'Normal' },
                    { id: 'TXF-002-VIBR', assetId: 'TXF-002', type: 'Vibration', unit: 'mm/s', baseValue: 1.8, variance: 1.2, threshold: 3.5, status: 'Normal' },
                    { id: 'TXF-002-LOAD', assetId: 'TXF-002', type: 'Load', unit: 'MVA', baseValue: 120, variance: 30, threshold: 150, status: 'Normal' },
                    
                    { id: 'TXF-003-TEMP', assetId: 'TXF-003', type: 'Temperature', unit: '°C', baseValue: 62, variance: 10, threshold: 78, status: 'Normal' },
                    { id: 'TXF-003-VIBR', assetId: 'TXF-003', type: 'Vibration', unit: 'mm/s', baseValue: 1.5, variance: 1.0, threshold: 3.0, status: 'Normal' },
                    { id: 'TXF-003-LOAD', assetId: 'TXF-003', type: 'Load', unit: 'MVA', baseValue: 160, variance: 40, threshold: 200, status: 'Normal' },
                    
                    { id: 'TXF-004-TEMP', assetId: 'TXF-004', type: 'Temperature', unit: '°C', baseValue: 58, variance: 8, threshold: 75, status: 'Normal' },
                    { id: 'TXF-004-VIBR', assetId: 'TXF-004', type: 'Vibration', unit: 'mm/s', baseValue: 1.2, variance: 0.8, threshold: 2.5, status: 'Normal' },
                    { id: 'TXF-004-LOAD', assetId: 'TXF-004', type: 'Load', unit: 'MVA', baseValue: 320, variance: 80, threshold: 400, status: 'Normal' },
                    
                    { id: 'TXF-005-TEMP', assetId: 'TXF-005', type: 'Temperature', unit: '°C', baseValue: 82, variance: 18, threshold: 95, status: 'Normal' },
                    { id: 'TXF-005-VIBR', assetId: 'TXF-005', type: 'Vibration', unit: 'mm/s', baseValue: 3.2, variance: 2.0, threshold: 5.5, status: 'Normal' },
                    { id: 'TXF-005-LOAD', assetId: 'TXF-005', type: 'Load', unit: 'MVA', baseValue: 60, variance: 15, threshold: 75, status: 'Normal' },

                    // Transmission Line Sensors
                    { id: 'TL-001-CURR', assetId: 'TL-001', type: 'Current', unit: 'A', baseValue: 1200, variance: 300, threshold: 1800, status: 'Normal' },
                    { id: 'TL-001-TEMP', assetId: 'TL-001', type: 'Temperature', unit: '°C', baseValue: 45, variance: 15, threshold: 75, status: 'Normal' },
                    { id: 'TL-001-SAG', assetId: 'TL-001', type: 'Sag', unit: 'm', baseValue: 8.5, variance: 2.0, threshold: 12.0, status: 'Normal' },
                    
                    { id: 'TL-002-CURR', assetId: 'TL-002', type: 'Current', unit: 'A', baseValue: 800, variance: 200, threshold: 1200, status: 'Normal' },
                    { id: 'TL-002-TEMP', assetId: 'TL-002', type: 'Temperature', unit: '°C', baseValue: 38, variance: 12, threshold: 65, status: 'Normal' },
                    
                    { id: 'TL-003-CURR', assetId: 'TL-003', type: 'Current', unit: 'A', baseValue: 600, variance: 150, threshold: 900, status: 'Normal' },
                    { id: 'TL-003-TEMP', assetId: 'TL-003', type: 'Temperature', unit: '°C', baseValue: 35, variance: 10, threshold: 60, status: 'Normal' },
                    
                    { id: 'TL-004-CURR', assetId: 'TL-004', type: 'Current', unit: 'A', baseValue: 1400, variance: 350, threshold: 2000, status: 'Normal' },
                    { id: 'TL-004-TEMP', assetId: 'TL-004', type: 'Temperature', unit: '°C', baseValue: 52, variance: 18, threshold: 85, status: 'Normal' },

                    // Distribution Line Sensors  
                    { id: 'DL-001-CURR', assetId: 'DL-001', type: 'Current', unit: 'A', baseValue: 320, variance: 80, threshold: 480, status: 'Normal' },
                    { id: 'DL-001-VOLT', assetId: 'DL-001', type: 'Voltage', unit: 'kV', baseValue: 34.5, variance: 1.5, threshold: 38, status: 'Normal' },
                    
                    { id: 'DL-002-CURR', assetId: 'DL-002', type: 'Current', unit: 'A', baseValue: 420, variance: 100, threshold: 630, status: 'Normal' },
                    { id: 'DL-002-VOLT', assetId: 'DL-002', type: 'Voltage', unit: 'kV', baseValue: 34.5, variance: 1.5, threshold: 38, status: 'Normal' },
                    
                    { id: 'DL-003-CURR', assetId: 'DL-003', type: 'Current', unit: 'A', baseValue: 180, variance: 45, threshold: 270, status: 'Normal' },
                    { id: 'DL-003-VOLT', assetId: 'DL-003', type: 'Voltage', unit: 'kV', baseValue: 13.8, variance: 0.6, threshold: 15.2, status: 'Normal' },

                    // Circuit Breaker Sensors
                    { id: 'CBR-001-PRESS', assetId: 'CBR-001', type: 'Oil Pressure', unit: 'bar', baseValue: 3.5, variance: 0.8, threshold: 5.0, status: 'Normal' },
                    { id: 'CBR-001-VOLT', assetId: 'CBR-001', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    { id: 'CBR-001-CURR', assetId: 'CBR-001', type: 'Current', unit: 'A', baseValue: 3200, variance: 800, threshold: 4000, status: 'Normal' },
                    
                    { id: 'CBR-002-PRESS', assetId: 'CBR-002', type: 'Oil Pressure', unit: 'bar', baseValue: 3.2, variance: 0.6, threshold: 4.5, status: 'Normal' },
                    { id: 'CBR-002-VOLT', assetId: 'CBR-002', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 3, threshold: 152, status: 'Normal' },
                    { id: 'CBR-002-CURR', assetId: 'CBR-002', type: 'Current', unit: 'A', baseValue: 2400, variance: 600, threshold: 3000, status: 'Normal' },
                    
                    { id: 'CBR-003-PRESS', assetId: 'CBR-003', type: 'Oil Pressure', unit: 'bar', baseValue: 3.8, variance: 0.7, threshold: 5.2, status: 'Normal' },
                    { id: 'CBR-003-VOLT', assetId: 'CBR-003', type: 'Voltage', unit: 'kV', baseValue: 230, variance: 5, threshold: 253, status: 'Normal' },
                    
                    { id: 'CBR-004-PRESS', assetId: 'CBR-004', type: 'Oil Pressure', unit: 'bar', baseValue: 4.1, variance: 0.5, threshold: 5.5, status: 'Normal' },
                    { id: 'CBR-004-VOLT', assetId: 'CBR-004', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    
                    { id: 'CBR-005-PRESS', assetId: 'CBR-005', type: 'Oil Pressure', unit: 'bar', baseValue: 2.8, variance: 1.0, threshold: 4.2, status: 'Normal' },
                    { id: 'CBR-005-VOLT', assetId: 'CBR-005', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 4, threshold: 152, status: 'Normal' },

                    // Switch Sensors
                    { id: 'SW-001-TEMP', assetId: 'SW-001', type: 'Temperature', unit: '°C', baseValue: 42, variance: 8, threshold: 60, status: 'Normal' },
                    { id: 'SW-001-VOLT', assetId: 'SW-001', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    
                    { id: 'SW-002-TEMP', assetId: 'SW-002', type: 'Temperature', unit: '°C', baseValue: 38, variance: 10, threshold: 55, status: 'Normal' },
                    { id: 'SW-002-VOLT', assetId: 'SW-002', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 3, threshold: 152, status: 'Normal' },
                    
                    { id: 'SW-003-TEMP', assetId: 'SW-003', type: 'Temperature', unit: '°C', baseValue: 35, variance: 6, threshold: 50, status: 'Normal' },
                    { id: 'SW-003-VOLT', assetId: 'SW-003', type: 'Voltage', unit: 'kV', baseValue: 230, variance: 5, threshold: 253, status: 'Normal' },

                    // Substation Sensors
                    { id: 'SUB-001-LOAD', assetId: 'SUB-001', type: 'Load', unit: 'MW', baseValue: 480, variance: 120, threshold: 600, status: 'Normal' },
                    { id: 'SUB-001-FREQ', assetId: 'SUB-001', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.2, threshold: 51.0, status: 'Normal' },
                    { id: 'SUB-001-VOLT', assetId: 'SUB-001', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    
                    { id: 'SUB-002-LOAD', assetId: 'SUB-002', type: 'Load', unit: 'MW', baseValue: 320, variance: 80, threshold: 400, status: 'Normal' },
                    { id: 'SUB-002-FREQ', assetId: 'SUB-002', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.15, threshold: 50.8, status: 'Normal' },
                    { id: 'SUB-002-VOLT', assetId: 'SUB-002', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 3, threshold: 152, status: 'Normal' },
                    
                    { id: 'SUB-003-LOAD', assetId: 'SUB-003', type: 'Load', unit: 'MW', baseValue: 280, variance: 70, threshold: 350, status: 'Normal' },
                    { id: 'SUB-003-FREQ', assetId: 'SUB-003', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.12, threshold: 50.6, status: 'Normal' },
                    { id: 'SUB-003-VOLT', assetId: 'SUB-003', type: 'Voltage', unit: 'kV', baseValue: 230, variance: 5, threshold: 253, status: 'Normal' },
                    
                    { id: 'SUB-004-LOAD', assetId: 'SUB-004', type: 'Load', unit: 'MW', baseValue: 400, variance: 100, threshold: 500, status: 'Normal' },
                    { id: 'SUB-004-FREQ', assetId: 'SUB-004', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.18, threshold: 50.9, status: 'Normal' },
                    { id: 'SUB-004-VOLT', assetId: 'SUB-004', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    
                    { id: 'SUB-005-LOAD', assetId: 'SUB-005', type: 'Load', unit: 'MW', baseValue: 160, variance: 40, threshold: 200, status: 'Normal' },
                    { id: 'SUB-005-FREQ', assetId: 'SUB-005', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.25, threshold: 51.2, status: 'Normal' },
                    { id: 'SUB-005-VOLT', assetId: 'SUB-005', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 4, threshold: 152, status: 'Normal' },

                    // Capacitor Bank Sensors
                    { id: 'CAP-001-VOLT', assetId: 'CAP-001', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 3, threshold: 152, status: 'Normal' },
                    { id: 'CAP-001-CURR', assetId: 'CAP-001', type: 'Current', unit: 'A', baseValue: 210, variance: 50, threshold: 300, status: 'Normal' },
                    { id: 'CAP-001-TEMP', assetId: 'CAP-001', type: 'Temperature', unit: '°C', baseValue: 45, variance: 10, threshold: 65, status: 'Normal' },
                    
                    { id: 'CAP-002-VOLT', assetId: 'CAP-002', type: 'Voltage', unit: 'kV', baseValue: 69, variance: 2, threshold: 76, status: 'Normal' },
                    { id: 'CAP-002-CURR', assetId: 'CAP-002', type: 'Current', unit: 'A', baseValue: 105, variance: 25, threshold: 150, status: 'Normal' },
                    
                    { id: 'CAP-003-VOLT', assetId: 'CAP-003', type: 'Voltage', unit: 'kV', baseValue: 138, variance: 3, threshold: 152, status: 'Normal' },
                    { id: 'CAP-003-CURR', assetId: 'CAP-003', type: 'Current', unit: 'A', baseValue: 168, variance: 40, threshold: 240, status: 'Normal' },

                    // Reactor Sensors
                    { id: 'REA-001-VOLT', assetId: 'REA-001', type: 'Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    { id: 'REA-001-CURR', assetId: 'REA-001', type: 'Current', unit: 'A', baseValue: 167, variance: 40, threshold: 240, status: 'Normal' },
                    { id: 'REA-001-TEMP', assetId: 'REA-001', type: 'Temperature', unit: '°C', baseValue: 55, variance: 12, threshold: 75, status: 'Normal' },
                    
                    { id: 'REA-002-VOLT', assetId: 'REA-002', type: 'Voltage', unit: 'kV', baseValue: 230, variance: 5, threshold: 253, status: 'Normal' },
                    { id: 'REA-002-CURR', assetId: 'REA-002', type: 'Current', unit: 'A', baseValue: 188, variance: 45, threshold: 270, status: 'Normal' },

                    // Protection Relay Sensors
                    { id: 'REL-001-TEMP', assetId: 'REL-001', type: 'Temperature', unit: '°C', baseValue: 28, variance: 5, threshold: 40, status: 'Normal' },
                    { id: 'REL-001-VOLT', assetId: 'REL-001', type: 'DC Voltage', unit: 'VDC', baseValue: 125, variance: 3, threshold: 140, status: 'Normal' },
                    
                    { id: 'REL-002-TEMP', assetId: 'REL-002', type: 'Temperature', unit: '°C', baseValue: 32, variance: 6, threshold: 45, status: 'Normal' },
                    { id: 'REL-002-VOLT', assetId: 'REL-002', type: 'DC Voltage', unit: 'VDC', baseValue: 125, variance: 2, threshold: 135, status: 'Normal' },
                    
                    { id: 'REL-003-TEMP', assetId: 'REL-003', type: 'Temperature', unit: '°C', baseValue: 38, variance: 8, threshold: 50, status: 'Normal' },
                    { id: 'REL-003-VOLT', assetId: 'REL-003', type: 'DC Voltage', unit: 'VDC', baseValue: 125, variance: 5, threshold: 145, status: 'Normal' },

                    // Current Transformer Sensors
                    { id: 'CT-001-TEMP', assetId: 'CT-001', type: 'Temperature', unit: '°C', baseValue: 42, variance: 8, threshold: 60, status: 'Normal' },
                    { id: 'CT-001-CURR', assetId: 'CT-001', type: 'Primary Current', unit: 'A', baseValue: 3200, variance: 800, threshold: 4000, status: 'Normal' },
                    
                    { id: 'CT-002-TEMP', assetId: 'CT-002', type: 'Temperature', unit: '°C', baseValue: 38, variance: 7, threshold: 55, status: 'Normal' },
                    { id: 'CT-002-CURR', assetId: 'CT-002', type: 'Primary Current', unit: 'A', baseValue: 2400, variance: 600, threshold: 3000, status: 'Normal' },

                    // Voltage Transformer Sensors
                    { id: 'VT-001-TEMP', assetId: 'VT-001', type: 'Temperature', unit: '°C', baseValue: 35, variance: 6, threshold: 50, status: 'Normal' },
                    { id: 'VT-001-VOLT', assetId: 'VT-001', type: 'Primary Voltage', unit: 'kV', baseValue: 345, variance: 8, threshold: 380, status: 'Normal' },
                    
                    { id: 'VT-002-TEMP', assetId: 'VT-002', type: 'Temperature', unit: '°C', baseValue: 32, variance: 5, threshold: 45, status: 'Normal' },
                    { id: 'VT-002-VOLT', assetId: 'VT-002', type: 'Primary Voltage', unit: 'kV', baseValue: 230, variance: 5, threshold: 253, status: 'Normal' },

                    // RTU Sensors
                    { id: 'RTU-001-TEMP', assetId: 'RTU-001', type: 'Temperature', unit: '°C', baseValue: 25, variance: 3, threshold: 35, status: 'Normal' },
                    { id: 'RTU-001-COMM', assetId: 'RTU-001', type: 'Communication Status', unit: '%', baseValue: 98, variance: 2, threshold: 90, status: 'Normal' },
                    
                    { id: 'RTU-002-TEMP', assetId: 'RTU-002', type: 'Temperature', unit: '°C', baseValue: 28, variance: 4, threshold: 40, status: 'Normal' },
                    { id: 'RTU-002-COMM', assetId: 'RTU-002', type: 'Communication Status', unit: '%', baseValue: 96, variance: 3, threshold: 85, status: 'Normal' },
                    
                    { id: 'RTU-003-TEMP', assetId: 'RTU-003', type: 'Temperature', unit: '°C', baseValue: 32, variance: 5, threshold: 45, status: 'Normal' },
                    { id: 'RTU-003-COMM', assetId: 'RTU-003', type: 'Communication Status', unit: '%', baseValue: 92, variance: 5, threshold: 80, status: 'Normal' },

                    // Power Quality Monitor Sensors
                    { id: 'PQM-001-THD', assetId: 'PQM-001', type: 'THD Voltage', unit: '%', baseValue: 2.1, variance: 0.8, threshold: 5.0, status: 'Normal' },
                    { id: 'PQM-001-FREQ', assetId: 'PQM-001', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.1, threshold: 50.5, status: 'Normal' },
                    
                    { id: 'PQM-002-THD', assetId: 'PQM-002', type: 'THD Voltage', unit: '%', baseValue: 2.8, variance: 1.0, threshold: 5.0, status: 'Normal' },
                    { id: 'PQM-002-FREQ', assetId: 'PQM-002', type: 'Frequency', unit: 'Hz', baseValue: 50.0, variance: 0.15, threshold: 50.6, status: 'Normal' }
                ];
            }

            initializeAssets() {
                return [
                    // Power Transformers
                    { id: 'TXF-001', name: 'Main Power Transformer #1', type: 'Transformer', baseHealth: 75, healthTrend: -0.1, location: 'Central Substation', voltage: '345/138kV', capacity: '300MVA', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'TXF-002', name: 'Distribution Transformer #2', type: 'Transformer', baseHealth: 82, healthTrend: 0.05, location: 'North Substation', voltage: '138/69kV', capacity: '150MVA', manufacturer: 'Siemens', installDate: '2020' },
                    { id: 'TXF-003', name: 'Step-Up Transformer #3', type: 'Transformer', baseHealth: 88, healthTrend: 0.02, location: 'East Substation', voltage: '69/345kV', capacity: '200MVA', manufacturer: 'GE', installDate: '2019' },
                    { id: 'TXF-004', name: 'Auto Transformer #4', type: 'Transformer', baseHealth: 91, healthTrend: 0.03, location: 'West Substation', voltage: '345/230kV', capacity: '400MVA', manufacturer: 'ABB', installDate: '2021' },
                    { id: 'TXF-005', name: 'Distribution Transformer #5', type: 'Transformer', baseHealth: 67, healthTrend: -0.08, location: 'South Substation', voltage: '138/34.5kV', capacity: '75MVA', manufacturer: 'Schneider', installDate: '2016' },
                    { id: 'TXF-006', name: 'Mobile Emergency Transformer', type: 'Transformer', baseHealth: 85, healthTrend: 0.01, location: 'Mobile Unit', voltage: '138/69kV', capacity: '100MVA', manufacturer: 'GE', installDate: '2022' },

                    // Transmission Lines
                    { id: 'TL-001', name: 'Transmission Line Alpha-Beta', type: 'Transmission Line', baseHealth: 68, healthTrend: -0.05, location: 'Northern Corridor', voltage: '345kV', length: '45mi', conductor: 'ACSR', installDate: '2015' },
                    { id: 'TL-002', name: 'Transmission Line Charlie-Delta', type: 'Transmission Line', baseHealth: 85, healthTrend: 0.02, location: 'Eastern Corridor', voltage: '230kV', length: '28mi', conductor: 'ACCC', installDate: '2019' },
                    { id: 'TL-003', name: 'Transmission Line Echo-Foxtrot', type: 'Transmission Line', baseHealth: 92, healthTrend: 0.04, location: 'Western Corridor', voltage: '138kV', length: '22mi', conductor: 'ACSR', installDate: '2020' },
                    { id: 'TL-004', name: 'Transmission Line Golf-Hotel', type: 'Transmission Line', baseHealth: 74, healthTrend: -0.03, location: 'Southern Corridor', voltage: '345kV', length: '67mi', conductor: 'ACSR', installDate: '2014' },

                    // Distribution Lines
                    { id: 'DL-001', name: 'Distribution Feeder #1', type: 'Distribution Line', baseHealth: 81, healthTrend: 0.01, location: 'Downtown District', voltage: '34.5kV', length: '8mi', conductor: 'ACSR', installDate: '2018' },
                    { id: 'DL-002', name: 'Distribution Feeder #2', type: 'Distribution Line', baseHealth: 77, healthTrend: -0.02, location: 'Industrial District', voltage: '34.5kV', length: '12mi', conductor: 'ACSR', installDate: '2017' },
                    { id: 'DL-003', name: 'Distribution Feeder #3', type: 'Distribution Line', baseHealth: 89, healthTrend: 0.03, location: 'Residential District', voltage: '13.8kV', length: '6mi', conductor: 'ACSR', installDate: '2021' },
                    { id: 'DL-004', name: 'Distribution Feeder #4', type: 'Distribution Line', baseHealth: 84, healthTrend: 0.02, location: 'Commercial District', voltage: '34.5kV', length: '10mi', conductor: 'ACCC', installDate: '2020' },

                    // Circuit Breakers
                    { id: 'CBR-001', name: 'Circuit Breaker Bay 1A', type: 'Circuit Breaker', baseHealth: 78, healthTrend: 0.1, location: 'Central Substation', voltage: '345kV', current: '4000A', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'CBR-002', name: 'Circuit Breaker Bay 2A', type: 'Circuit Breaker', baseHealth: 92, healthTrend: -0.02, location: 'North Substation', voltage: '138kV', current: '3000A', manufacturer: 'Siemens', installDate: '2020' },
                    { id: 'CBR-003', name: 'Circuit Breaker Bay 3A', type: 'Circuit Breaker', baseHealth: 86, healthTrend: 0.05, location: 'East Substation', voltage: '230kV', current: '3000A', manufacturer: 'GE', installDate: '2019' },
                    { id: 'CBR-004', name: 'Circuit Breaker Bay 4A', type: 'Circuit Breaker', baseHealth: 94, healthTrend: 0.01, location: 'West Substation', voltage: '345kV', current: '4000A', manufacturer: 'ABB', installDate: '2021' },
                    { id: 'CBR-005', name: 'Circuit Breaker Bay 1B', type: 'Circuit Breaker', baseHealth: 71, healthTrend: -0.06, location: 'Central Substation', voltage: '138kV', current: '2000A', manufacturer: 'Schneider', installDate: '2016' },
                    { id: 'CBR-006', name: 'Circuit Breaker Bay 2B', type: 'Circuit Breaker', baseHealth: 83, healthTrend: 0.03, location: 'South Substation', voltage: '69kV', current: '2000A', manufacturer: 'GE', installDate: '2019' },

                    // Disconnect Switches
                    { id: 'SW-001', name: 'Disconnect Switch DS-1A', type: 'Switch', baseHealth: 87, healthTrend: 0.02, location: 'Central Substation', voltage: '345kV', current: '4000A', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'SW-002', name: 'Disconnect Switch DS-2A', type: 'Switch', baseHealth: 79, healthTrend: -0.01, location: 'North Substation', voltage: '138kV', current: '3000A', manufacturer: 'Siemens', installDate: '2017' },
                    { id: 'SW-003', name: 'Disconnect Switch DS-3A', type: 'Switch', baseHealth: 91, healthTrend: 0.04, location: 'East Substation', voltage: '230kV', current: '3000A', manufacturer: 'GE', installDate: '2020' },
                    { id: 'SW-004', name: 'Load Break Switch LBS-1', type: 'Switch', baseHealth: 73, healthTrend: -0.04, location: 'Distribution Network', voltage: '34.5kV', current: '630A', manufacturer: 'Schneider', installDate: '2015' },
                    { id: 'SW-005', name: 'Motorized Switch MS-1', type: 'Switch', baseHealth: 88, healthTrend: 0.03, location: 'West Substation', voltage: '138kV', current: '2000A', manufacturer: 'ABB', installDate: '2019' },

                    // Substations
                    { id: 'SUB-001', name: 'Central Substation', type: 'Substation', baseHealth: 88, healthTrend: 0.03, location: 'Downtown', voltage: '345/138/69kV', capacity: '600MVA', operator: 'Alpha Team', installDate: '2015' },
                    { id: 'SUB-002', name: 'North Substation', type: 'Substation', baseHealth: 91, healthTrend: 0.01, location: 'Industrial District', voltage: '138/69/34.5kV', capacity: '400MVA', operator: 'Bravo Team', installDate: '2018' },
                    { id: 'SUB-003', name: 'East Substation', type: 'Substation', baseHealth: 93, healthTrend: 0.02, location: 'Commercial District', voltage: '230/69/34.5kV', capacity: '350MVA', operator: 'Charlie Team', installDate: '2019' },
                    { id: 'SUB-004', name: 'West Substation', type: 'Substation', baseHealth: 89, healthTrend: 0.04, location: 'Residential District', voltage: '345/138kV', capacity: '500MVA', operator: 'Alpha Team', installDate: '2020' },
                    { id: 'SUB-005', name: 'South Substation', type: 'Substation', baseHealth: 76, healthTrend: -0.02, location: 'Rural District', voltage: '138/69/34.5kV', capacity: '200MVA', operator: 'Bravo Team', installDate: '2016' },

                    // Capacitor Banks
                    { id: 'CAP-001', name: 'Capacitor Bank #1', type: 'Capacitor Bank', baseHealth: 84, healthTrend: 0.01, location: 'Central Substation', voltage: '138kV', capacity: '50MVAR', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'CAP-002', name: 'Capacitor Bank #2', type: 'Capacitor Bank', baseHealth: 90, healthTrend: 0.02, location: 'North Substation', voltage: '69kV', capacity: '25MVAR', manufacturer: 'Siemens', installDate: '2020' },
                    { id: 'CAP-003', name: 'Capacitor Bank #3', type: 'Capacitor Bank', baseHealth: 87, healthTrend: 0.03, location: 'East Substation', voltage: '138kV', capacity: '40MVAR', manufacturer: 'GE', installDate: '2019' },

                    // Reactors
                    { id: 'REA-001', name: 'Shunt Reactor #1', type: 'Reactor', baseHealth: 92, healthTrend: 0.01, location: 'Central Substation', voltage: '345kV', capacity: '100MVAR', manufacturer: 'ABB', installDate: '2020' },
                    { id: 'REA-002', name: 'Line Reactor #2', type: 'Reactor', baseHealth: 85, healthTrend: -0.01, location: 'West Substation', voltage: '230kV', capacity: '75MVAR', manufacturer: 'Siemens', installDate: '2017' },

                    // Protection & Control Equipment
                    { id: 'REL-001', name: 'Digital Relay Panel #1', type: 'Protection Relay', baseHealth: 95, healthTrend: 0.02, location: 'Central Control Room', voltage: '125VDC', manufacturer: 'SEL', installDate: '2021' },
                    { id: 'REL-002', name: 'Digital Relay Panel #2', type: 'Protection Relay', baseHealth: 93, healthTrend: 0.01, location: 'North Control Room', voltage: '125VDC', manufacturer: 'ABB', installDate: '2020' },
                    { id: 'REL-003', name: 'Legacy Relay Panel #3', type: 'Protection Relay', baseHealth: 72, healthTrend: -0.05, location: 'South Control Room', voltage: '125VDC', manufacturer: 'GE', installDate: '2014' },

                    // Current & Voltage Transformers
                    { id: 'CT-001', name: 'Current Transformer CT-1A', type: 'Current Transformer', baseHealth: 89, healthTrend: 0.01, location: 'Central Substation', voltage: '345kV', ratio: '4000:5A', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'CT-002', name: 'Current Transformer CT-2A', type: 'Current Transformer', baseHealth: 86, healthTrend: -0.01, location: 'North Substation', voltage: '138kV', ratio: '3000:5A', manufacturer: 'Siemens', installDate: '2017' },
                    { id: 'VT-001', name: 'Voltage Transformer VT-1A', type: 'Voltage Transformer', baseHealth: 91, healthTrend: 0.02, location: 'Central Substation', voltage: '345kV', ratio: '345000:115V', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'VT-002', name: 'Voltage Transformer VT-2A', type: 'Voltage Transformer', baseHealth: 88, healthTrend: 0.01, location: 'East Substation', voltage: '230kV', ratio: '230000:115V', manufacturer: 'GE', installDate: '2019' },

                    // SCADA & Communication Equipment
                    { id: 'RTU-001', name: 'Remote Terminal Unit #1', type: 'RTU', baseHealth: 94, healthTrend: 0.03, location: 'Central Control Center', manufacturer: 'Schneider', model: 'ION7650', installDate: '2021' },
                    { id: 'RTU-002', name: 'Remote Terminal Unit #2', type: 'RTU', baseHealth: 91, healthTrend: 0.02, location: 'North Substation', manufacturer: 'ABB', model: 'RTU560', installDate: '2020' },
                    { id: 'RTU-003', name: 'Remote Terminal Unit #3', type: 'RTU', baseHealth: 87, healthTrend: -0.01, location: 'South Substation', manufacturer: 'GE', model: 'D400', installDate: '2018' },

                    // Power Quality Equipment
                    { id: 'PQM-001', name: 'Power Quality Monitor #1', type: 'Power Quality Monitor', baseHealth: 96, healthTrend: 0.01, location: 'Central Substation', manufacturer: 'Fluke', model: '1760TR', installDate: '2022' },
                    { id: 'PQM-002', name: 'Power Quality Monitor #2', type: 'Power Quality Monitor', baseHealth: 89, healthTrend: 0.02, location: 'East Substation', manufacturer: 'Dranetz', model: 'HDPQ Xplorer', installDate: '2020' }
                ];
            }

            initializeTeams() {
                return [
                    { id: 'ALPHA', name: 'Alpha Team', lead: 'John Smith', members: 6, availability: 'Available', utilization: 75, location: 'Central Substation', specialty: 'Transmission Systems', certification: 'Level 3' },
                    { id: 'BRAVO', name: 'Bravo Team', lead: 'Sarah Johnson', members: 5, availability: 'Busy', utilization: 90, location: 'North Substation', specialty: 'Protection & Control', certification: 'Level 2' },
                    { id: 'CHARLIE', name: 'Charlie Team', lead: 'Mike Davis', members: 7, availability: 'Available', utilization: 45, location: 'Mobile Unit', specialty: 'Emergency Response', certification: 'Level 3' },
                    { id: 'DELTA', name: 'Delta Team', lead: 'Lisa Chen', members: 4, availability: 'Available', utilization: 65, location: 'East Substation', specialty: 'Distribution Systems', certification: 'Level 2' },
                    { id: 'ECHO', name: 'Echo Team', lead: 'Robert Brown', members: 5, availability: 'On Call', utilization: 55, location: 'West Substation', specialty: 'Transformer Maintenance', certification: 'Level 3' },
                    { id: 'FOXTROT', name: 'Foxtrot Team', lead: 'Emily Rodriguez', members: 4, availability: 'Available', utilization: 70, location: 'South Substation', specialty: 'Line Maintenance', certification: 'Level 2' },
                    { id: 'GOLF', name: 'Golf Team', lead: 'David Wilson', members: 3, availability: 'Busy', utilization: 85, location: 'Control Center', specialty: 'SCADA & Communications', certification: 'Level 4' },
                    { id: 'HOTEL', name: 'Hotel Team', lead: 'Amanda Taylor', members: 6, availability: 'Available', utilization: 60, location: 'Mobile Unit', specialty: 'Power Quality', certification: 'Level 2' }
                ];
            }

            generateSensorReading(sensor) {
                // Generate realistic sensor data with time-based patterns
                const now = new Date();
                const hour = now.getHours();
                
                // Add daily patterns (higher load during day, temperature variations)
                let timeMultiplier = 1;
                if (sensor.type === 'Temperature') {
                    timeMultiplier = 0.8 + 0.4 * Math.sin((hour - 6) * Math.PI / 12); // Peak at 2 PM
                } else if (sensor.type === 'Load' || sensor.type === 'Current') {
                    timeMultiplier = 0.6 + 0.4 * Math.sin((hour - 8) * Math.PI / 10); // Peak at 6 PM
                }
                
                // Add random variation
                const randomFactor = 0.9 + Math.random() * 0.2; // ±10% random variation
                const trendFactor = 1 + (Math.random() - 0.5) * 0.1; // Long-term trend
                
                const value = sensor.baseValue * timeMultiplier * randomFactor * trendFactor;
                const roundedValue = Math.round(value * 100) / 100;
                
                // Update sensor status based on threshold
                const oldStatus = sensor.status;
                if (roundedValue > sensor.threshold) {
                    sensor.status = 'Critical';
                } else if (roundedValue > sensor.threshold * 0.85) {
                    sensor.status = 'Warning';
                } else {
                    sensor.status = 'Normal';
                }
                
                // Generate alert if status changed to critical or warning
                if (oldStatus !== sensor.status && sensor.status !== 'Normal') {
                    this.generateAlert(sensor, roundedValue);
                }
                
                return {
                    sensorId: sensor.id,
                    assetId: sensor.assetId,
                    type: sensor.type,
                    value: roundedValue,
                    unit: sensor.unit,
                    status: sensor.status,
                    timestamp: now.toISOString(),
                    threshold: sensor.threshold
                };
            }

            updateAssetHealth(asset) {
                // Get related sensor readings
                const relatedSensors = this.sensors.filter(s => s.assetId === asset.id);
                let healthImpact = 0;
                
                relatedSensors.forEach(sensor => {
                    const reading = this.generateSensorReading(sensor);
                    const utilizationRatio = reading.value / sensor.threshold;
                    
                    if (utilizationRatio > 0.85) {
                        healthImpact -= (utilizationRatio - 0.85) * 10; // Decrease health for high utilization
                    } else if (utilizationRatio < 0.5) {
                        healthImpact += 0.5; // Slight increase for low utilization
                    }
                });
                
                // Apply health trend and impact
                asset.currentHealth = Math.max(0, Math.min(100, 
                    asset.baseHealth + asset.healthTrend + healthImpact + (Math.random() - 0.5) * 2
                ));
                
                return asset.currentHealth;
            }

            generateAlert(sensor, value) {
                const alertTypes = {
                    'Critical': ['🚨 CRITICAL', '#dc3545'],
                    'Warning': ['⚠️ WARNING', '#ffc107']
                };
                
                const [badge, color] = alertTypes[sensor.status] || ['ℹ️ INFO', '#17a2b8'];
                
                const alert = {
                    id: `ALERT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                    assetId: sensor.assetId,
                    sensorId: sensor.id,
                    type: sensor.status,
                    badge: badge,
                    color: color,
                    message: `${sensor.type} ${sensor.status.toLowerCase()} detected`,
                    details: `${value} ${sensor.unit} (Threshold: ${sensor.threshold} ${sensor.unit})`,
                    timestamp: new Date(),
                    acknowledged: false
                };
                
                this.alerts.unshift(alert); // Add to beginning
                
                // Limit alerts to last 50
                if (this.alerts.length > 50) {
                    this.alerts = this.alerts.slice(0, 50);
                }
                
                // Auto-generate work order for critical alerts
                if (sensor.status === 'Critical') {
                    this.generateWorkOrder(alert);
                }
                
                return alert;
            }

            generateWorkOrder(alert) {
                const workOrderId = `WO-${new Date().toISOString().slice(0,10).replace(/-/g, '')}-${String(this.workOrders.length + 1).padStart(3, '0')}`;
                
                // Assign team based on availability and location
                const availableTeams = this.teams.filter(team => team.availability === 'Available');
                const assignedTeam = availableTeams.length > 0 ? 
                    availableTeams[Math.floor(Math.random() * availableTeams.length)] : 
                    this.teams[0]; // Fallback to first team
                
                const priorities = ['Emergency', 'Critical', 'High', 'Medium'];
                const priority = alert.type === 'Critical' ? 'Emergency' : 'High';
                
                const workOrder = {
                    id: workOrderId,
                    assetId: alert.assetId,
                    alertId: alert.id,
                    title: `${priority} Maintenance - ${alert.message}`,
                    description: `Address ${alert.details} on asset ${alert.assetId}`,
                    priority: priority,
                    assignedTeam: assignedTeam.name,
                    status: 'Active',
                    estimatedDuration: Math.floor(Math.random() * 4) + 1, // 1-4 hours
                    createdAt: new Date(),
                    scheduledFor: new Date(Date.now() + Math.random() * 24 * 60 * 60 * 1000) // Within 24 hours
                };
                
                this.workOrders.unshift(workOrder);
                
                // Update team availability if emergency
                if (priority === 'Emergency') {
                    assignedTeam.availability = 'Busy';
                    assignedTeam.utilization = Math.min(100, assignedTeam.utilization + 20);
                }
                
                return workOrder;
            }

            updateTeamStatus() {
                this.teams.forEach(team => {
                    // Randomly update team availability and utilization
                    if (Math.random() < 0.1) { // 10% chance of status change
                        if (team.availability === 'Busy' && Math.random() < 0.3) {
                            team.availability = 'Available';
                            team.utilization = Math.max(30, team.utilization - 15);
                        } else if (team.availability === 'Available' && Math.random() < 0.2) {
                            team.availability = 'Busy';
                            team.utilization = Math.min(95, team.utilization + 10);
                        }
                    }
                    
                    // Gradual utilization changes
                    team.utilization += (Math.random() - 0.5) * 5;
                    team.utilization = Math.max(20, Math.min(100, team.utilization));
                });
            }

            start() {
                if (this.isRunning) return;
                
                this.isRunning = true;
                console.log('🚀 Live Data Generation System Started');
                
                // Generate data every 30 seconds (slower for realistic utility pace)
                this.dataGenerationInterval = setInterval(() => {
                    this.generateCycle();
                }, 30000);
                
                // Update dashboard every 15 seconds (slower updates)
                this.dashboardUpdateInterval = setInterval(() => {
                    this.updateDashboard();
                }, 15000);
                
                // Initial generation
                this.generateCycle();
                this.updateDashboard();
            }

            stop() {
                if (!this.isRunning) return;
                
                this.isRunning = false;
                console.log('⏹️ Live Data Generation System Stopped');
                
                if (this.dataGenerationInterval) {
                    clearInterval(this.dataGenerationInterval);
                    this.dataGenerationInterval = null;
                }
                
                if (this.dashboardUpdateInterval) {
                    clearInterval(this.dashboardUpdateInterval);
                    this.dashboardUpdateInterval = null;
                }
            }

            generateCycle() {
                // Generate new sensor readings
                const currentReadings = this.sensors.map(sensor => this.generateSensorReading(sensor));
                
                // Update asset health scores
                this.assets.forEach(asset => this.updateAssetHealth(asset));
                
                // Update team status
                this.updateTeamStatus();
                
                // Log live data generation
                console.log(`📊 Live Data Cycle - ${currentReadings.length} readings, ${this.alerts.length} alerts, ${this.workOrders.length} work orders`);
                
                return {
                    readings: currentReadings,
                    assets: this.assets,
                    alerts: this.alerts.slice(0, 10), // Latest 10 alerts
                    workOrders: this.workOrders.slice(0, 5), // Latest 5 work orders
                    teams: this.teams
                };
            }

            updateDashboard() {
                const liveData = this.generateCycle();
                
                // Update stat cards
                this.updateStatCards(liveData);
                
                // Update asset health displays
                this.updateAssetHealthDisplays(liveData);
                
                // Update alerts section
                this.updateAlertsSection(liveData);
                
                // Update work orders
                this.updateWorkOrdersSection(liveData);
                
                // Update charts and visualizations
                this.updateCharts(liveData);
                
                // Show live indicator
                this.showLiveIndicator();
            }

            updateStatCards(data) {
                // Total Assets
                const totalAssets = data.assets.length;
                const totalCard = document.querySelector('.stat-card.healthy .stat-number');
                if (totalCard) totalCard.textContent = totalAssets;
                
                // Critical Assets
                const criticalAssets = data.assets.filter(asset => asset.currentHealth < 50).length;
                const criticalCard = document.querySelector('.stat-card.warning .stat-number');
                if (criticalCard) criticalCard.textContent = criticalAssets;
                
                // Active Alerts
                const activeAlerts = data.alerts.filter(alert => !alert.acknowledged).length;
                const alertsCard = document.querySelector('.stat-card.critical .stat-number');
                if (alertsCard) alertsCard.textContent = activeAlerts;
                
                // Pending Work Orders
                const pendingWO = data.workOrders.filter(wo => wo.status === 'Active').length;
                const woCard = document.querySelector('.stat-card.info .stat-number');
                if (woCard) woCard.textContent = pendingWO;
            }

            updateAssetHealthDisplays(data) {
                data.assets.slice(0, 3).forEach((asset, index) => {
                    const assetItems = document.querySelectorAll('.asset-item');
                    if (assetItems[index]) {
                        const healthBar = assetItems[index].querySelector('.health-bar');
                        if (healthBar) {
                            const health = Math.round(asset.currentHealth);
                            healthBar.style.width = `${health}%`;
                            
                            // Update health bar color
                            healthBar.className = 'health-bar';
                            if (health >= 80) healthBar.classList.add('excellent');
                            else if (health >= 60) healthBar.classList.add('good');
                            else if (health >= 40) healthBar.classList.add('fair');
                            else healthBar.classList.add('poor');
                        }
                    }
                });
            }

            updateAlertsSection(data) {
                const alertsContainer = document.querySelector('.section-content');
                if (!alertsContainer) return;
                
                const recentAlerts = data.alerts.slice(0, 4);
                const alertItems = alertsContainer.querySelectorAll('.alert-item');
                
                recentAlerts.forEach((alert, index) => {
                    if (alertItems[index]) {
                        const alertText = alertItems[index].querySelector('div');
                        const alertBadge = alertItems[index].querySelector('.alert-badge');
                        
                        if (alertText) {
                            alertText.innerHTML = `
                                <strong>${alert.message}</strong>
                                <br><small>${alert.assetId} - ${alert.details}</small>
                            `;
                        }
                        
                        if (alertBadge) {
                            alertBadge.textContent = alert.type;
                            alertBadge.className = `alert-badge ${alert.type.toLowerCase()}`;
                        }
                    }
                });
            }

            updateWorkOrdersSection(data) {
                const workOrderItems = document.querySelectorAll('.work-order-item');
                const recentWO = data.workOrders.slice(0, 3);
                
                recentWO.forEach((wo, index) => {
                    if (workOrderItems[index]) {
                        const woText = workOrderItems[index].querySelector('div');
                        const woBadge = workOrderItems[index].querySelector('.priority-badge');
                        
                        if (woText) {
                            woText.innerHTML = `
                                <strong>${wo.id}</strong>
                                <br><small>${wo.title}</small>
                                <br><small>Team: ${wo.assignedTeam} | ETA: ${wo.estimatedDuration}h</small>
                            `;
                        }
                        
                        if (woBadge) {
                            woBadge.textContent = wo.priority;
                            woBadge.className = `priority-badge ${wo.priority.toLowerCase()}`;
                        }
                    }
                });
            }

            updateCharts(data) {
                // Update health distribution
                const healthCounts = { excellent: 0, good: 0, poor: 0 };
                data.assets.forEach(asset => {
                    if (asset.currentHealth >= 80) healthCounts.excellent++;
                    else if (asset.currentHealth >= 60) healthCounts.good++;
                    else healthCounts.poor++;
                });
                
                // Update pie chart percentages (simplified)
                const total = data.assets.length;
                console.log(`📊 Health Distribution: Excellent: ${healthCounts.excellent}/${total}, Good: ${healthCounts.good}/${total}, Poor: ${healthCounts.poor}/${total}`);
                
                // Update Chart.js charts with live data
                if (window.ChartRenderer && typeof ChartRenderer.updateChartsWithLiveData === 'function') {
                    ChartRenderer.updateChartsWithLiveData();
                }
            }

            showLiveIndicator() {
                // Create or update live indicator
                let indicator = document.querySelector('.live-indicator');
                if (!indicator) {
                    indicator = document.createElement('div');
                    indicator.className = 'live-indicator';
                    indicator.style.cssText = `
                        position: fixed;
                        top: 10px;
                        left: 50%;
                        transform: translateX(-50%);
                        background: linear-gradient(135deg, #28a745, #20c997);
                        color: white;
                        padding: 8px 16px;
                        border-radius: 20px;
                        font-size: 0.9rem;
                        font-weight: bold;
                        z-index: 1000;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                        animation: pulse 2s infinite;
                    `;
                    document.body.appendChild(indicator);
                }
                
                indicator.innerHTML = `
                    <span class="real-time-indicator"></span>
                    🔄 LIVE DATA - Last Update: ${new Date().toLocaleTimeString()}
                `;
                
                // Flash effect
                indicator.style.transform = 'translateX(-50%) scale(1.05)';
                setTimeout(() => {
                    indicator.style.transform = 'translateX(-50%) scale(1)';
                }, 200);
            }

            getLatestData() {
                return {
                    sensors: this.sensors,
                    assets: this.assets,
                    alerts: this.alerts,
                    workOrders: this.workOrders,
                    teams: this.teams,
                    isLive: this.isRunning
                };
            }
        }

        // Initialize Live Data System
        const liveDataSystem = new LiveDataGenerator();

        // Enhanced export functionality with REAL file downloads
        function exportData(dataType, format) {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.textContent = 'Generating...';
            btn.disabled = true;
            btn.style.background = '#6c757d';
            
            // Generate actual data based on type
            const data = generateExportData(dataType);
            
            // Show progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += 20;
                btn.textContent = `Generating... ${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 200);
            
            setTimeout(() => {
                clearInterval(interval);
                btn.textContent = 'Downloading...';
                
                // Create and download the actual file
                const fileName = `${dataType}_${new Date().toISOString().slice(0,10)}.${format.toLowerCase()}`;
                downloadFile(data, fileName, format);
                
                btn.textContent = '✅ Downloaded';
                btn.style.background = '#28a745';
                
                // Create download notification
                showDownloadNotification(fileName, format);
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                    btn.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
                }, 2000);
            }, 1000);
        }

        // Generate actual export data based on type
        function generateExportData(dataType) {
            const timestamp = new Date().toISOString();
            
            switch(dataType) {
                case 'sensor-data':
                    return {
                        exportDate: timestamp,
                        dataType: 'Sensor Readings',
                        sensors: [
                            { id: 'TXF-001-TEMP', location: 'Main Transformer', type: 'Temperature', value: 78.5, unit: '°C', timestamp: timestamp, status: 'Normal' },
                            { id: 'TXF-001-VIBR', location: 'Main Transformer', type: 'Vibration', value: 2.3, unit: 'mm/s', timestamp: timestamp, status: 'Warning' },
                            { id: 'PWL-001-CURR', location: 'Power Line A-B', type: 'Current', value: 245.7, unit: 'A', timestamp: timestamp, status: 'Normal' },
                            { id: 'CBR-001-VOLT', location: 'Circuit Breaker Bay 1', type: 'Voltage', value: 13.8, unit: 'kV', timestamp: timestamp, status: 'Normal' },
                            { id: 'SUB-001-PRESS', location: 'Central Substation', type: 'Oil Pressure', value: 3.2, unit: 'bar', timestamp: timestamp, status: 'Normal' }
                        ]
                    };
                
                case 'health-scores':
                    return {
                        exportDate: timestamp,
                        dataType: 'Asset Health Scores',
                        assets: [
                            { id: 'TXF-001', name: 'Main Power Transformer #1', type: 'Transformer', health: 35, status: 'Critical', lastMaintenance: '2025-07-15', nextScheduled: '2025-08-07' },
                            { id: 'TXF-002', name: 'Distribution Transformer #2', type: 'Transformer', health: 45, status: 'Warning', lastMaintenance: '2025-07-20', nextScheduled: '2025-08-15' },
                            { id: 'PWL-001', name: 'Power Line A-B', type: 'Power Line', health: 65, status: 'Fair', lastMaintenance: '2025-06-10', nextScheduled: '2025-09-01' },
                            { id: 'CBR-001', name: 'Circuit Breaker Bay 1', type: 'Circuit Breaker', health: 85, status: 'Good', lastMaintenance: '2025-08-05', nextScheduled: '2025-11-01' },
                            { id: 'SUB-001', name: 'Central Substation', type: 'Substation', health: 90, status: 'Excellent', lastMaintenance: '2025-05-15', nextScheduled: '2025-12-01' }
                        ]
                    };
                
                case 'failure-patterns':
                    return {
                        exportDate: timestamp,
                        dataType: 'Failure Pattern Analysis',
                        patterns: [
                            { assetType: 'Transformer', failureMode: 'Overheating', frequency: 'High in Summer', avgAge: '15+ years', preventiveMeasures: 'Enhanced cooling, oil analysis' },
                            { assetType: 'Power Line', failureMode: 'Conductor Aging', frequency: 'Weather-dependent', avgAge: '12+ years', preventiveMeasures: 'Regular inspection, conductor replacement' },
                            { assetType: 'Circuit Breaker', failureMode: 'Contact Wear', frequency: 'Operation-based', avgAge: '8+ years', preventiveMeasures: 'Contact inspection, arc analysis' }
                        ],
                        recommendations: [
                            'Increase transformer monitoring during summer months',
                            'Implement predictive maintenance for power lines',
                            'Schedule breaker maintenance based on operation cycles'
                        ]
                    };
                
                case 'analytics-summary':
                    return {
                        exportDate: timestamp,
                        dataType: 'Analytics Summary Report',
                        summary: {
                            totalAssets: 24,
                            healthyAssets: 15,
                            warningAssets: 6,
                            criticalAssets: 3,
                            systemAvailability: 99.7,
                            mtbf: 2847,
                            mttr: 4.2,
                            preventiveMaintenance: 78,
                            predictiveAccuracy: 87.3
                        },
                        trends: [
                            { metric: 'System Health', trend: 'Improving', change: '+2.3%' },
                            { metric: 'Failure Rate', trend: 'Decreasing', change: '-15%' },
                            { metric: 'Response Time', trend: 'Stable', change: '+0.5%' }
                        ]
                    };
                
                case 'chart-data':
                    return {
                        exportDate: timestamp,
                        dataType: 'Chart Data Export',
                        chartData: {
                            assetDistribution: { transformers: 8, powerLines: 6, circuitBreakers: 5, substations: 3, switches: 2 },
                            healthDistribution: { excellent: 15, good: 6, poor: 3 },
                            performanceMetrics: { availability: 99.7, efficiency: 70, capacity: 75 }
                        }
                    };
                
                default:
                    return {
                        exportDate: timestamp,
                        dataType: 'General Export',
                        message: 'Data export completed successfully',
                        totalRecords: Math.floor(Math.random() * 1000) + 100
                    };
            }
        }

        // Actually download the file
        function downloadFile(data, fileName, format) {
            let content = '';
            let mimeType = '';
            
            switch(format.toLowerCase()) {
                case 'csv':
                    content = convertToCSV(data);
                    mimeType = 'text/csv';
                    break;
                case 'json':
                    content = JSON.stringify(data, null, 2);
                    mimeType = 'application/json';
                    break;
                case 'excel':
                    content = convertToCSV(data); // Simplified - in real app would generate actual Excel
                    mimeType = 'text/csv';
                    fileName = fileName.replace('.excel', '.csv');
                    break;
                case 'pdf':
                    content = convertToPDFText(data); // Simplified - in real app would generate actual PDF
                    mimeType = 'text/plain';
                    fileName = fileName.replace('.pdf', '.txt');
                    break;
                default:
                    content = JSON.stringify(data, null, 2);
                    mimeType = 'application/json';
            }
            
            // Create blob and download
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            console.log(`📁 File downloaded: ${fileName} (${blob.size} bytes)`);
        }

        // Convert data to CSV format
        function convertToCSV(data) {
            if (data.sensors) {
                // Sensor data
                let csv = 'ID,Location,Type,Value,Unit,Timestamp,Status\n';
                data.sensors.forEach(sensor => {
                    csv += `${sensor.id},${sensor.location},${sensor.type},${sensor.value},${sensor.unit},${sensor.timestamp},${sensor.status}\n`;
                });
                return csv;
            } else if (data.assets) {
                // Asset health data
                let csv = 'ID,Name,Type,Health Score,Status,Last Maintenance,Next Scheduled\n';
                data.assets.forEach(asset => {
                    csv += `${asset.id},"${asset.name}",${asset.type},${asset.health},${asset.status},${asset.lastMaintenance},${asset.nextScheduled}\n`;
                });
                return csv;
            } else if (data.patterns) {
                // Failure patterns
                let csv = 'Asset Type,Failure Mode,Frequency,Average Age,Preventive Measures\n';
                data.patterns.forEach(pattern => {
                    csv += `${pattern.assetType},"${pattern.failureMode}",${pattern.frequency},${pattern.avgAge},"${pattern.preventiveMeasures}"\n`;
                });
                return csv;
            } else if (data.summary) {
                // Analytics summary
                let csv = 'Metric,Value\n';
                Object.entries(data.summary).forEach(([key, value]) => {
                    csv += `${key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())},${value}\n`;
                });
                return csv;
            } else if (data.chartData) {
                // Chart data
                let csv = 'Category,Type,Value\n';
                Object.entries(data.chartData).forEach(([category, values]) => {
                    if (typeof values === 'object') {
                        Object.entries(values).forEach(([type, value]) => {
                            csv += `${category},${type},${value}\n`;
                        });
                    } else {
                        csv += `${category},Value,${values}\n`;
                    }
                });
                return csv;
            } else {
                // Generic data
                return `Export Date,${data.exportDate}\nData Type,${data.dataType}\nTotal Records,${data.totalRecords || 'N/A'}\n`;
            }
        }

        // Convert data to PDF-like text format
        function convertToPDFText(data) {
            let text = `TRANSMISSION UTILITY AI AGENT REPORT\n`;
            text += `Generated: ${data.exportDate}\n`;
            text += `Data Type: ${data.dataType}\n`;
            text += `${'='.repeat(50)}\n\n`;
            
            if (data.sensors) {
                text += `SENSOR READINGS REPORT\n\n`;
                data.sensors.forEach(sensor => {
                    text += `Sensor: ${sensor.id}\n`;
                    text += `Location: ${sensor.location}\n`;
                    text += `Type: ${sensor.type}\n`;
                    text += `Current Value: ${sensor.value} ${sensor.unit}\n`;
                    text += `Status: ${sensor.status}\n`;
                    text += `Timestamp: ${sensor.timestamp}\n\n`;
                });
            } else if (data.assets) {
                text += `ASSET HEALTH REPORT\n\n`;
                data.assets.forEach(asset => {
                    text += `Asset: ${asset.name} (${asset.id})\n`;
                    text += `Type: ${asset.type}\n`;
                    text += `Health Score: ${asset.health}%\n`;
                    text += `Status: ${asset.status}\n`;
                    text += `Last Maintenance: ${asset.lastMaintenance}\n`;
                    text += `Next Scheduled: ${asset.nextScheduled}\n\n`;
                });
            } else if (data.summary) {
                text += `ANALYTICS SUMMARY\n\n`;
                Object.entries(data.summary).forEach(([key, value]) => {
                    text += `${key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}: ${value}\n`;
                });
                text += `\nTREND ANALYSIS\n\n`;
                if (data.trends) {
                    data.trends.forEach(trend => {
                        text += `${trend.metric}: ${trend.trend} (${trend.change})\n`;
                    });
                }
            }
            
            text += `\n${'='.repeat(50)}\n`;
            text += `Report generated by Transmission Utility AI Agent\n`;
            text += `For technical support, contact your system administrator\n`;
            
            return text;
        }

        // Enhanced download notification with file details
        function showDownloadNotification(fileName, format, fileSize = null) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #28a745, #20c997);
                color: white;
                padding: 20px;
                border-radius: 12px;
                box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
                z-index: 2000;
                max-width: 350px;
                animation: slideIn 0.3s ease;
                border: 1px solid rgba(255,255,255,0.2);
            `;
            
            const displaySize = fileSize ? `${(fileSize / 1024).toFixed(1)} KB` : 'Generated successfully';
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                    <span style="font-size: 1.5rem; margin-right: 12px;">📥</span>
                    <div>
                        <strong style="font-size: 1.1rem;">Download Complete!</strong>
                        <div style="font-size: 0.8rem; opacity: 0.9; margin-top: 2px;">File saved to Downloads folder</div>
                    </div>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 6px; margin: 8px 0;">
                    <div style="font-size: 0.95rem; font-weight: 500;">${fileName}</div>
                    <div style="font-size: 0.8rem; opacity: 0.8; margin-top: 3px;">
                        Format: ${format.toUpperCase()} | Size: ${displaySize}
                    </div>
                </div>
                <div style="display: flex; gap: 8px; margin-top: 12px;">
                    <button onclick="openDownloadsFolder()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.8rem;">
                        📁 Open Folder
                    </button>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.8rem;">
                        ✕ Close
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove notification after 8 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 8000);
        }

        // Open downloads folder (simulation)
        function openDownloadsFolder() {
            alert('🗂️ Downloads folder would open here.\n\nIn a real application, this would open your system\'s default Downloads directory.');
            console.log('📁 Downloads folder access requested');
        }

        // Add slide animation styles
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            @keyframes popupSlideIn {
                from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
                to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            }
            .chart-placeholder:hover {
                transform: scale(1.02) !important;
                transition: transform 0.2s ease !important;
                cursor: pointer !important;
            }
            .feature-card:hover {
                transform: translateY(-8px) !important;
                box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
            }
        `;
        document.head.appendChild(style);

        // Animate chart elements
        function animateCharts() {
            // Animate bar charts
            document.querySelectorAll('.bar').forEach((bar, index) => {
                const height = bar.style.height;
                bar.style.height = '0%';
                setTimeout(() => {
                    bar.style.transition = 'height 1s ease';
                    bar.style.height = height;
                }, index * 200);
            });

            // Animate gauge charts
            document.querySelectorAll('.gauge-progress').forEach((gauge, index) => {
                const dashArray = gauge.getAttribute('stroke-dasharray');
                const dashOffset = gauge.getAttribute('stroke-dashoffset');
                gauge.setAttribute('stroke-dashoffset', '377');
                setTimeout(() => {
                    gauge.style.transition = 'stroke-dashoffset 1.5s ease';
                    gauge.setAttribute('stroke-dashoffset', dashOffset);
                }, index * 300);
            });

            // Animate pie chart
            document.querySelectorAll('.pie-chart circle[stroke-dasharray]').forEach((slice, index) => {
                const dashArray = slice.getAttribute('stroke-dasharray');
                slice.setAttribute('stroke-dasharray', '0 502');
                setTimeout(() => {
                    slice.style.transition = 'stroke-dasharray 1s ease';
                    slice.setAttribute('stroke-dasharray', dashArray);
                }, index * 400);
            });
        }

        // Enhanced interactive chart features with real functionality
        function addChartInteractivity() {
            // Bar chart interactions with data drill-down
            document.querySelectorAll('.bar').forEach(bar => {
                bar.addEventListener('click', function() {
                    const label = this.querySelector('.bar-label')?.textContent || 'Asset';
                    const value = this.querySelector('.bar-value')?.textContent || 'N/A';
                    showAssetDetails(label, value);
                });
                
                // Add hover effects
                bar.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.1)';
                    this.style.boxShadow = '0 4px 8px rgba(0,123,255,0.3)';
                });
                
                bar.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                    this.style.boxShadow = 'none';
                });
            });

            // Gauge chart interactions with live updates
            document.querySelectorAll('.gauge-chart').forEach(gauge => {
                gauge.addEventListener('click', function() {
                    const metricText = this.querySelector('text:last-child');
                    const valueText = this.querySelector('text:first-child');
                    if (metricText && valueText) {
                        const metric = metricText.textContent;
                        const value = valueText.textContent;
                        showMetricDetails(metric, value);
                    }
                });
                
                // Add hover glow effect
                gauge.addEventListener('mouseenter', function() {
                    this.style.filter = 'drop-shadow(0 0 10px rgba(0,123,255,0.5))';
                    this.style.cursor = 'pointer';
                });
                
                gauge.addEventListener('mouseleave', function() {
                    this.style.filter = 'none';
                });
            });

            // Pie chart slice interactions
            document.querySelectorAll('.pie-chart circle[stroke-dasharray]').forEach(slice => {
                slice.addEventListener('click', function() {
                    const strokeColor = this.getAttribute('stroke');
                    let category = 'Unknown';
                    if (strokeColor === '#28a745') category = 'Excellent Health';
                    else if (strokeColor === '#ffc107') category = 'Good Health';
                    else if (strokeColor === '#dc3545') category = 'Poor Health';
                    
                    showCategoryDetails(category);
                });
                
                slice.addEventListener('mouseenter', function() {
                    this.style.strokeWidth = '25';
                    this.style.cursor = 'pointer';
                });
                
                slice.addEventListener('mouseleave', function() {
                    this.style.strokeWidth = '20';
                });
            });

            // Asset status board interactions
            document.querySelectorAll('[style*="background: #d4edda"], [style*="background: #fff3cd"]').forEach(card => {
                if (card.textContent.includes('TXF-') || card.textContent.includes('PWL-') || 
                    card.textContent.includes('CBR-') || card.textContent.includes('SUB-')) {
                    card.addEventListener('click', function() {
                        const assetId = this.querySelector('div[style*="font-weight: bold"]')?.textContent || 'Unknown';
                        const health = this.querySelector('div[style*="font-size: 1.2rem"]')?.textContent || 'N/A';
                        showAssetDetails(assetId, health);
                    });
                    
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', function() {
                        this.style.transform = 'scale(1.05)';
                        this.style.transition = 'transform 0.2s ease';
                    });
                    
                    card.addEventListener('mouseleave', function() {
                        this.style.transform = 'scale(1)';
                    });
                }
            });
        }

        // Enhanced asset details popup with comprehensive information
        function showAssetDetails(assetId, healthScore) {
            // Remove existing popup if any
            const existingPopup = document.querySelector('.asset-details-popup');
            if (existingPopup) existingPopup.remove();
            
            const popup = document.createElement('div');
            popup.className = 'asset-details-popup';
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 25px;
                border-radius: 15px;
                box-shadow: 0 15px 40px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 500px;
                width: 90%;
                border-left: 4px solid #007bff;
                animation: popupSlideIn 0.3s ease;
            `;
            
            // Generate sample asset data based on assetId
            const assetData = generateAssetData(assetId, healthScore);
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; color: #007bff;">📊 ${assetId} Details</h3>
                    <span onclick="this.parentNode.parentNode.remove()" 
                          style="cursor: pointer; font-size: 1.8rem; color: #666; padding: 5px; hover: #333;">&times;</span>
                </div>
                <div style="margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span><strong>Current Health:</strong></span>
                        <span style="color: ${assetData.healthColor}; font-weight: bold;">${assetData.health}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span><strong>Type:</strong></span>
                        <span>${assetData.type}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span><strong>Location:</strong></span>
                        <span>${assetData.location}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span><strong>Last Maintenance:</strong></span>
                        <span>${assetData.lastMaintenance}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span><strong>Next Scheduled:</strong></span>
                        <span>${assetData.nextMaintenance}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span><strong>Failure Risk:</strong></span>
                        <span style="color: ${assetData.riskColor};">${assetData.failureRisk}</span>
                    </div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="margin: 0 0 10px 0; color: #333;">Recent Alerts</h4>
                    ${assetData.alerts.map(alert => `
                        <div style="margin-bottom: 8px; padding: 5px; background: ${alert.bg}; border-radius: 4px;">
                            <small><strong>${alert.type}:</strong> ${alert.message}</small>
                        </div>
                    `).join('')}
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="scheduleInspection('${assetId}')" 
                            style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                        📅 Schedule Inspection
                    </button>
                    <button onclick="viewFullReport('${assetId}')" 
                            style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                        📋 Full Report
                    </button>
                </div>
            `;
            
            document.body.appendChild(popup);
            
            // Add click outside to close
            setTimeout(() => {
                document.addEventListener('click', function closeOnOutside(e) {
                    if (!popup.contains(e.target)) {
                        popup.remove();
                        document.removeEventListener('click', closeOnOutside);
                    }
                });
            }, 100);
        }

        // Generate realistic asset data
        function generateAssetData(assetId, healthScore) {
            const types = {
                'TXF': 'Power Transformer',
                'PWL': 'Power Line',
                'CBR': 'Circuit Breaker',
                'SUB': 'Substation'
            };
            
            const locations = ['Central Substation', 'North Station', 'South Station', 'East Facility'];
            const assetType = assetId.substring(0, 3);
            const health = healthScore || (Math.random() * 40 + 60).toFixed(1) + '%';
            const healthValue = parseInt(health);
            
            return {
                type: types[assetType] || 'Unknown Asset',
                location: locations[Math.floor(Math.random() * locations.length)],
                health: health,
                healthColor: healthValue >= 80 ? '#28a745' : healthValue >= 60 ? '#ffc107' : '#dc3545',
                lastMaintenance: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString(),
                nextMaintenance: new Date(Date.now() + Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString(),
                failureRisk: healthValue >= 80 ? 'Low (15%)' : healthValue >= 60 ? 'Medium (35%)' : 'High (65%)',
                riskColor: healthValue >= 80 ? '#28a745' : healthValue >= 60 ? '#ffc107' : '#dc3545',
                alerts: [
                    { type: 'Info', message: 'Normal operation', bg: '#d1ecf1' },
                    { type: 'Warning', message: 'Temperature trending up', bg: '#fff3cd' }
                ].slice(0, healthValue < 70 ? 2 : 1)
            };
        }

        // Metric details popup
        function showMetricDetails(metric, value) {
            const existingPopup = document.querySelector('.metric-details-popup');
            if (existingPopup) existingPopup.remove();
            
            const popup = document.createElement('div');
            popup.className = 'metric-details-popup';
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 350px;
                border-left: 4px solid #007bff;
                animation: popupSlideIn 0.3s ease;
            `;
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: #007bff;">📈 ${metric}</h3>
                    <span onclick="this.parentNode.parentNode.remove()" 
                          style="cursor: pointer; font-size: 1.5rem; color: #666;">&times;</span>
                </div>
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 2.5rem; font-weight: bold; color: #007bff;">${value}</div>
                    <div style="color: #666;">Current Value</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0;">Performance Trend</h4>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>Today:</span><span style="color: #28a745;">+2.3%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>This Week:</span><span style="color: #28a745;">+5.7%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Target:</span><span style="color: #007bff;">95%</span>
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
            
            setTimeout(() => {
                document.addEventListener('click', function closeOnOutside(e) {
                    if (!popup.contains(e.target)) {
                        popup.remove();
                        document.removeEventListener('click', closeOnOutside);
                    }
                });
            }, 100);
        }

        // Category details for pie chart
        function showCategoryDetails(category) {
            const existingPopup = document.querySelector('.category-details-popup');
            if (existingPopup) existingPopup.remove();
            
            const popup = document.createElement('div');
            popup.className = 'category-details-popup';
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 400px;
                border-left: 4px solid #007bff;
                animation: popupSlideIn 0.3s ease;
            `;
            
            const categoryData = {
                'Excellent Health': { count: 15, color: '#28a745', assets: ['SUB-001', 'CBR-002', 'TXF-003'] },
                'Good Health': { count: 6, color: '#ffc107', assets: ['PWL-001', 'CBR-001'] },
                'Poor Health': { count: 3, color: '#dc3545', assets: ['TXF-001', 'PWL-002'] }
            };
            
            const data = categoryData[category] || { count: 0, color: '#666', assets: [] };
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: ${data.color};">📊 ${category}</h3>
                    <span onclick="this.parentNode.parentNode.remove()" 
                          style="cursor: pointer; font-size: 1.5rem; color: #666;">&times;</span>
                </div>
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 2.5rem; font-weight: bold; color: ${data.color};">${data.count}</div>
                    <div style="color: #666;">Assets in this category</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0;">Sample Assets:</h4>
                    ${data.assets.map(asset => 
                        `<div style="margin-bottom: 5px; padding: 5px; background: white; border-radius: 4px; cursor: pointer;" 
                              onclick="showAssetDetails('${asset}', '${Math.floor(Math.random() * 30 + 70)}%')">
                            📋 ${asset}
                        </div>`
                    ).join('')}
                </div>
            `;
            
            document.body.appendChild(popup);
            
            setTimeout(() => {
                document.addEventListener('click', function closeOnOutside(e) {
                    if (!popup.contains(e.target)) {
                        popup.remove();
                        document.removeEventListener('click', closeOnOutside);
                    }
                });
            }, 100);
        }

        // Action functions for asset details
        function scheduleInspection(assetId) {
            alert(`📅 Inspection scheduled for ${assetId}. Work order will be created and team assigned.`);
            console.log(`📅 Inspection scheduled for asset: ${assetId}`);
        }

        function viewFullReport(assetId) {
            alert(`📋 Full technical report for ${assetId} will be generated and downloaded.`);
            console.log(`📋 Generating full report for asset: ${assetId}`);
        }

        // Helper functions
        function getAssetStatus(healthScore) {
            if (healthScore >= 80) return '🟢 Excellent';
            if (healthScore >= 60) return '🟡 Good';
            if (healthScore >= 40) return '🟠 Fair';
            return '🔴 Poor';
        }

        function getRandomDate() {
            const dates = ['2 days ago', '1 week ago', '2 weeks ago', '1 month ago'];
            return dates[Math.floor(Math.random() * dates.length)];
        }

        function getNextInspection() {
            const dates = ['Tomorrow', 'Next week', 'In 2 weeks', 'Next month'];
            return dates[Math.floor(Math.random() * dates.length)];
        }

        function showMetricDetails(metric, value) {
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 350px;
                border-left: 4px solid #28a745;
            `;
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: #28a745;">${metric} Details</h3>
                    <span onclick="this.parentNode.parentNode.remove()" style="cursor: pointer; font-size: 1.5rem; color: #666;">&times;</span>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Current Value:</strong> ${value}
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Target:</strong> ${getTargetValue(metric)}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>Trend:</strong> ${getTrend()}
                </div>
                <button onclick="this.parentNode.remove()" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">Close</button>
            `;
            
            document.body.appendChild(popup);
        }

        function getTargetValue(metric) {
            const targets = {
                'Availability': '99.9%',
                'Efficiency': '85%',
                'Capacity': '80%'
            };
            return targets[metric] || '95%';
        }

        function getTrend() {
            const trends = ['📈 Improving', '📊 Stable', '📉 Declining'];
            return trends[Math.floor(Math.random() * trends.length)];
        }

        // Modal functionality
        function openModal(modalType) {
            document.getElementById(modalType + '-modal').style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            
            // Add entrance animation
            const modal = document.getElementById(modalType + '-modal');
            const content = modal.querySelector('.modal-content');
            content.style.transform = 'scale(0.8)';
            content.style.opacity = '0';
            
            setTimeout(() => {
                content.style.transition = 'all 0.3s ease';
                content.style.transform = 'scale(1)';
                content.style.opacity = '1';
                
                // Initialize charts based on modal type
                if (modalType === 'predictive-analytics') {
                    setTimeout(() => {
                        console.log('🧠 Initializing Predictive Analytics Charts...');
                        ChartRenderer.createFailureProbabilityChart();
                        ChartRenderer.createModelAccuracyChart();
                        ChartRenderer.createFeatureImportanceChart();
                        
                        // Generate and display AI insights
                        generatePredictiveInsights();
                        console.log('✅ Predictive Analytics Charts Loaded');
                    }, 100);
                }

                if (modalType === 'team-management') {
                    setTimeout(() => {
                        console.log('👥 Initializing Team Management Charts...');
                        ChartRenderer.createSkillsMatrixChart();
                        ChartRenderer.createTrainingProgressChart();
                        console.log('✅ Team Skills Matrix & Training Charts Loaded');
                    }, 100);
                }

                if (modalType === 'performance-analytics') {
                    setTimeout(() => {
                        console.log('📈 Initializing Performance Analytics Charts...');
                        ChartRenderer.createPerformanceTrendsChart();
                        ChartRenderer.createAssetPerformanceChart();
                        ChartRenderer.createDetailedMetricsChart();
                        console.log('✅ Performance Analytics Charts Loaded');
                    }, 100);
                }
                
                // Animate charts when modal opens
                if (modalType === 'visualization-alerts' || modalType === 'data-monitoring') {
                    setTimeout(animateCharts, 300);
                }
            }, 10);
            
            console.log(`🚀 Opened ${modalType} module`);
        }

        // Generate and display AI-powered predictive insights
        function generatePredictiveInsights() {
            const liveData = window.liveDataSystem ? window.liveDataSystem.getLatestData() : null;
            const assetData = liveData ? liveData.assets : [
                { id: 'T001', name: 'Transformer T-001', currentHealth: 65, age: 12 },
                { id: 'PL045', name: 'Power Line PL-045', currentHealth: 78, age: 8 },
                { id: 'SW023', name: 'Switch SW-023', currentHealth: 45, age: 15 }
            ];

            // Generate ML-based predictions and insights
            const forecasts = PredictiveAnalytics.generateFailureProbabilityForecast(assetData);
            const accuracy = PredictiveAnalytics.generateModelAccuracyTrends();
            const importance = PredictiveAnalytics.calculateFeatureImportance(assetData);
            const insights = PredictiveAnalytics.generatePredictiveInsights(forecasts, accuracy, importance);

            const container = document.getElementById('predictive-insights-container');
            if (!container) return;

            container.innerHTML = insights.map(insight => `
                <div class="insight-card ${insight.type}" style="
                    padding: 20px; 
                    border-radius: 10px; 
                    border-left: 4px solid ${getInsightColor(insight.type)};
                    background: ${getInsightBg(insight.type)};
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                ">
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <span style="font-size: 1.2rem; margin-right: 10px;">${getInsightIcon(insight.type)}</span>
                        <h4 style="margin: 0; color: #333;">${insight.title}</h4>
                    </div>
                    <p style="margin: 10px 0; color: #666; line-height: 1.5;">${insight.message}</p>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.7); border-radius: 5px;">
                        <strong style="color: #333;">Recommended Action:</strong>
                        <br><span style="color: #555;">${insight.action}</span>
                    </div>
                </div>
            `).join('');
        }

        function getInsightColor(type) {
            const colors = {
                'critical': '#dc3545',
                'warning': '#ffc107', 
                'success': '#28a745',
                'info': '#17a2b8'
            };
            return colors[type] || '#6c757d';
        }

        function getInsightBg(type) {
            const backgrounds = {
                'critical': '#fff5f5',
                'warning': '#fffaf0',
                'success': '#f8fff9',
                'info': '#f0f9ff'
            };
            return backgrounds[type] || '#f8f9fa';
        }

        function getInsightIcon(type) {
            const icons = {
                'critical': '🚨',
                'warning': '⚠️',
                'success': '✅',
                'info': 'ℹ️'
            };
            return icons[type] || '📊';
        }

        function closeModal(modalType) {
            const modal = document.getElementById(modalType + '-modal');
            const content = modal.querySelector('.modal-content');
            
            content.style.transition = 'all 0.2s ease';
            content.style.transform = 'scale(0.8)';
            content.style.opacity = '0';
            
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }, 200);
            
            console.log(`❌ Closed ${modalType} module`);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                const modalId = event.target.id;
                const modalType = modalId.replace('-modal', '');
                closeModal(modalType);
            }
        }

        // Execute action functionality
        function executeAction(actionType) {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.textContent = 'Executing...';
            btn.disabled = true;
            btn.style.background = '#6c757d';
            
            // Simulate API call
            setTimeout(() => {
                btn.textContent = '✅ Executed';
                btn.style.background = '#28a745';
                
                // Add to action feed
                addToActionFeed(actionType);
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                    btn.style.background = '#dc3545';
                }, 2000);
            }, 3000);
            
            console.log(`⚡ Executing action: ${actionType}`);
        }

        // Add action to real-time feed
        function addToActionFeed(actionType) {
            const feed = document.querySelector('#decision-support-modal .modal-body div:last-child div:last-child');
            if (feed) {
                const now = new Date();
                const timeString = now.toTimeString().slice(0, 8);
                
                const newAction = document.createElement('div');
                newAction.style.borderBottom = '1px solid #dee2e6';
                newAction.style.padding = '10px 0';
                newAction.innerHTML = `
                    <span style="color: #666; font-size: 0.9rem;">${timeString}</span> - 
                    <span style="color: #28a745; font-weight: bold;">MANUAL</span> - 
                    ${getActionDescription(actionType)}
                `;
                
                feed.insertBefore(newAction, feed.firstChild);
                
                // Remove old entries if more than 5
                if (feed.children.length > 5) {
                    feed.removeChild(feed.lastChild);
                }
            }
        }

        function getActionDescription(actionType) {
            const descriptions = {
                'emergency-inspection': 'Emergency inspection initiated for TXF-001',
                'schedule-inspection': 'Inspection scheduled for PWL-001 within 7 days',
                'assign-team': 'Team automatically assigned based on AI recommendations',
                'generate-workorder': 'Work order automatically generated'
            };
            return descriptions[actionType] || 'Action executed successfully';
        }

        // Simulate real-time updates for modals
        function updateModalData() {
            // Update decision support metrics
            const accuracyElement = document.querySelector('#decision-support-modal .metric-value');
            if (accuracyElement && Math.random() < 0.1) {
                const currentValue = parseFloat(accuracyElement.textContent);
                const newValue = Math.max(90, Math.min(98, currentValue + (Math.random() - 0.5) * 2));
                accuracyElement.textContent = newValue.toFixed(1) + '%';
            }
            
            // Update predictive analytics
            const predictionElements = document.querySelectorAll('#predictive-analytics-modal .progress-fill');
            predictionElements.forEach(element => {
                if (Math.random() < 0.2) {
                    const currentWidth = parseInt(element.style.width);
                    const change = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newWidth = Math.max(5, Math.min(95, currentWidth + change));
                    element.style.width = newWidth + '%';
                    
                    // Update color based on risk level
                    if (newWidth >= 70) {
                        element.style.background = '#dc3545';
                    } else if (newWidth >= 40) {
                        element.style.background = '#ffc107';
                    } else {
                        element.style.background = '#28a745';
                    }
                }
            });
            
            // Update team availability
            const statusElements = document.querySelectorAll('#team-management-modal .team-card span[style*="background"]');
            statusElements.forEach(element => {
                if (Math.random() < 0.05) {
                    const statuses = [
                        { text: '🟢 Available', bg: '#28a745', color: 'white' },
                        { text: '🟡 Busy', bg: '#ffc107', color: '#333' },
                        { text: '🔴 Offline', bg: '#dc3545', color: 'white' }
                    ];
                    const newStatus = statuses[Math.floor(Math.random() * 3)];
                    element.textContent = newStatus.text;
                    element.style.background = newStatus.bg;
                    element.style.color = newStatus.color;
                }
            });

            // Update bar chart values
            document.querySelectorAll('#data-monitoring-modal .bar-value').forEach(element => {
                if (Math.random() < 0.15) {
                    const currentValue = parseInt(element.textContent);
                    const change = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newValue = Math.max(10, Math.min(100, currentValue + change));
                    element.textContent = newValue + '%';
                    
                    // Update bar height
                    const bar = element.parentNode;
                    bar.style.height = newValue + '%';
                    
                    // Update bar color based on health
                    if (newValue >= 80) {
                        bar.style.background = 'linear-gradient(to top, #28a745, #20c997)';
                    } else if (newValue >= 60) {
                        bar.style.background = 'linear-gradient(to top, #ffc107, #ffb300)';
                    } else {
                        bar.style.background = 'linear-gradient(to top, #dc3545, #c82333)';
                    }
                }
            });
        }

        // Backend API integration simulation
        async function fetchRealTimeData() {
            try {
                // Simulate API calls to backend
                const endpoints = [
                    '/api/assets/health',
                    '/api/predictions/current',
                    '/api/teams/status',
                    '/api/performance/kpis',
                    '/api/alerts/active',
                    '/api/monitoring/live'
                ];
                
                console.log('🔄 Fetching real-time data from backend...');
                
                // In a real implementation, these would be actual fetch calls
                // const healthData = await fetch('http://localhost:8000/api/assets/health');
                // const predictionsData = await fetch('http://localhost:8000/api/predictions/current');
                // const teamsData = await fetch('http://localhost:8000/api/teams/status');
                // const performanceData = await fetch('http://localhost:8000/api/performance/kpis');
                // const alertsData = await fetch('http://localhost:8000/api/alerts/active');
                // const monitoringData = await fetch('http://localhost:8000/api/monitoring/live');
                
                // Simulate successful data fetch
                setTimeout(() => {
                    console.log('✅ Real-time data updated successfully');
                    updateModalData();
                }, 1000);
                
            } catch (error) {
                console.error('❌ Error fetching real-time data:', error);
                console.log('📱 Using simulated data instead');
                updateModalData();
            }
        }

        // Real Chart Generation Functions
        // Advanced Performance Analytics Engine
        class PerformanceAnalytics {
            static generateSystemPerformanceTrends() {
                const months = ['Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'];
                const performanceMetrics = {
                    availability: { baseline: 99.5, trend: 0.05, variance: 0.3 },
                    mtbf: { baseline: 2700, trend: 25, variance: 100 }, // Mean Time Between Failures (hours)
                    mttr: { baseline: 5.5, trend: -0.3, variance: 0.8 }, // Mean Time To Repair (hours)
                    efficiency: { baseline: 85, trend: 1.2, variance: 3 },
                    loadFactor: { baseline: 0.72, trend: 0.02, variance: 0.05 },
                    powerQuality: { baseline: 98.5, trend: 0.08, variance: 0.5 }
                };

                const trends = {};
                Object.keys(performanceMetrics).forEach(metric => {
                    const config = performanceMetrics[metric];
                    trends[metric] = months.map((month, index) => {
                        const trendEffect = config.trend * index;
                        const seasonalEffect = this.getSeasonalEffect(metric, index);
                        const randomVariance = (Math.random() - 0.5) * 2 * config.variance;
                        
                        const value = config.baseline + trendEffect + seasonalEffect + randomVariance;
                        
                        // Apply realistic constraints
                        if (metric === 'availability' || metric === 'powerQuality') {
                            return Math.min(100, Math.max(95, value));
                        } else if (metric === 'mtbf') {
                            return Math.max(2000, value);
                        } else if (metric === 'mttr') {
                            return Math.max(2, value);
                        } else if (metric === 'efficiency') {
                            return Math.min(100, Math.max(75, value));
                        } else if (metric === 'loadFactor') {
                            return Math.min(1, Math.max(0.5, value));
                        }
                        
                        return value;
                    });
                });

                return { months, trends };
            }

            static getSeasonalEffect(metric, monthIndex) {
                const seasonalFactors = {
                    availability: [0, -0.1, -0.2, -0.3, -0.4, -0.2], // Summer dip
                    mtbf: [50, 0, -50, -100, -80, -30], // Lower in summer
                    mttr: [0, 0.2, 0.4, 0.6, 0.5, 0.3], // Higher in summer
                    efficiency: [2, 1, -1, -3, -2, 0], // Lower in summer
                    loadFactor: [0.02, 0.04, 0.06, 0.08, 0.05, 0.02], // Higher in summer
                    powerQuality: [0.2, 0, -0.3, -0.5, -0.4, -0.1] // Lower in summer
                };
                
                return seasonalFactors[metric]?.[monthIndex] || 0;
            }

            static generateAssetPerformanceBreakdown() {
                const assetTypes = {
                    'Transformers': { count: 8, reliability: 0.94, efficiency: 0.89, health: 82 },
                    'Power Lines': { count: 12, reliability: 0.97, efficiency: 0.95, health: 78 },
                    'Circuit Breakers': { count: 24, reliability: 0.99, efficiency: 0.92, health: 85 },
                    'Substations': { count: 4, reliability: 0.96, efficiency: 0.88, health: 80 },
                    'Protection Systems': { count: 16, reliability: 0.98, efficiency: 0.94, health: 88 },
                    'SCADA Systems': { count: 6, reliability: 0.99, efficiency: 0.96, health: 92 }
                };

                const breakdown = {};
                Object.keys(assetTypes).forEach(assetType => {
                    const asset = assetTypes[assetType];
                    
                    // Calculate performance score (weighted average)
                    const performanceScore = (
                        asset.reliability * 0.4 + 
                        asset.efficiency * 0.3 + 
                        (asset.health / 100) * 0.3
                    ) * 100;

                    // Calculate operational metrics
                    const avgUptime = asset.reliability * 8760; // Hours per year
                    const avgDowntime = 8760 - avgUptime;
                    const maintenanceCost = asset.count * (100 - asset.health) * 50; // Cost factor
                    
                    breakdown[assetType] = {
                        ...asset,
                        performanceScore: Math.round(performanceScore),
                        avgUptime: Math.round(avgUptime),
                        avgDowntime: Math.round(avgDowntime),
                        maintenanceCost: Math.round(maintenanceCost),
                        criticalityLevel: this.getCriticalityLevel(performanceScore),
                        recommendations: this.getAssetRecommendations(assetType, asset)
                    };
                });

                return breakdown;
            }

            static getCriticalityLevel(score) {
                if (score >= 90) return 'Low';
                if (score >= 80) return 'Medium';
                if (score >= 70) return 'High';
                return 'Critical';
            }

            static getAssetRecommendations(assetType, asset) {
                const recommendations = [];
                
                if (asset.reliability < 0.95) {
                    recommendations.push(`Increase preventive maintenance frequency for ${assetType}`);
                }
                
                if (asset.efficiency < 0.90) {
                    recommendations.push(`Optimize operational parameters for ${assetType}`);
                }
                
                if (asset.health < 80) {
                    recommendations.push(`Schedule condition assessment for aging ${assetType}`);
                }

                if (recommendations.length === 0) {
                    recommendations.push(`${assetType} performing well - maintain current strategy`);
                }

                return recommendations;
            }

            static generateDetailedMetrics() {
                const categories = [
                    'Asset Utilization',
                    'Maintenance Efficiency', 
                    'Energy Losses',
                    'Response Time',
                    'Safety Index',
                    'Cost Effectiveness',
                    'Environmental Impact',
                    'Regulatory Compliance'
                ];

                const currentPerformance = categories.map(() => 70 + Math.random() * 25); // 70-95%
                const targetPerformance = categories.map(() => 85 + Math.random() * 10); // 85-95%
                const industryBenchmark = categories.map(() => 75 + Math.random() * 15); // 75-90%

                return {
                    categories,
                    current: currentPerformance,
                    target: targetPerformance,
                    benchmark: industryBenchmark,
                    gaps: currentPerformance.map((current, i) => targetPerformance[i] - current),
                    improvements: this.generateImprovementPlan(categories, currentPerformance, targetPerformance)
                };
            }

            static generateImprovementPlan(categories, current, target) {
                return categories.map((category, index) => {
                    const gap = target[index] - current[index];
                    const priority = gap > 10 ? 'High' : gap > 5 ? 'Medium' : 'Low';
                    
                    const actionPlans = {
                        'Asset Utilization': 'Implement load balancing algorithms and smart grid technologies',
                        'Maintenance Efficiency': 'Deploy predictive maintenance and IoT sensors',
                        'Energy Losses': 'Upgrade transmission lines and install smart transformers',
                        'Response Time': 'Enhance emergency response protocols and team training',
                        'Safety Index': 'Implement comprehensive safety training and equipment upgrades',
                        'Cost Effectiveness': 'Optimize resource allocation and vendor contracts',
                        'Environmental Impact': 'Implement green technologies and carbon reduction strategies',
                        'Regulatory Compliance': 'Regular audits and compliance management system'
                    };

                    return {
                        category,
                        currentScore: Math.round(current[index]),
                        targetScore: Math.round(target[index]),
                        gap: Math.round(gap),
                        priority,
                        actionPlan: actionPlans[category],
                        estimatedTimeframe: gap > 10 ? '6-12 months' : gap > 5 ? '3-6 months' : '1-3 months'
                    };
                });
            }

            static generateKPISummary(performanceTrends, assetBreakdown, detailedMetrics) {
                const summary = {
                    overallScore: 0,
                    topPerformers: [],
                    criticalAreas: [],
                    financialImpact: {
                        costSavings: 0,
                        roi: 0,
                        maintenanceCosts: 0
                    },
                    recommendations: []
                };

                // Calculate overall performance score
                const latestAvailability = performanceTrends.trends.availability.slice(-1)[0];
                const avgAssetScore = Object.values(assetBreakdown)
                    .reduce((sum, asset) => sum + asset.performanceScore, 0) / Object.keys(assetBreakdown).length;
                const avgDetailedScore = detailedMetrics.current
                    .reduce((sum, score) => sum + score, 0) / detailedMetrics.current.length;
                
                summary.overallScore = Math.round((latestAvailability + avgAssetScore + avgDetailedScore) / 3);

                // Identify top performers and critical areas
                Object.keys(assetBreakdown).forEach(assetType => {
                    const asset = assetBreakdown[assetType];
                    if (asset.performanceScore >= 90) {
                        summary.topPerformers.push(assetType);
                    } else if (asset.performanceScore < 80) {
                        summary.criticalAreas.push(assetType);
                    }
                });

                // Calculate financial impact
                summary.financialImpact.maintenanceCosts = Object.values(assetBreakdown)
                    .reduce((sum, asset) => sum + asset.maintenanceCost, 0);
                summary.financialImpact.costSavings = Math.round(summary.financialImpact.maintenanceCosts * 0.25);
                summary.financialImpact.roi = Math.round(300 + (summary.overallScore - 80) * 10);

                return summary;
            }
        }

        // Advanced Team Management & Skills Analytics Engine
        class TeamManagement {
            static generateTeamSkillsMatrix() {
                const teams = {
                    'Alpha Team': [
                        { name: 'John Smith', role: 'Senior Technician', experience: 12 },
                        { name: 'Sarah Johnson', role: 'Electrical Engineer', experience: 8 },
                        { name: 'Mike Davis', role: 'Field Supervisor', experience: 15 },
                        { name: 'Lisa Chen', role: 'Safety Coordinator', experience: 6 }
                    ],
                    'Beta Team': [
                        { name: 'Robert Brown', role: 'Lead Technician', experience: 10 },
                        { name: 'Emily Wilson', role: 'System Analyst', experience: 7 },
                        { name: 'David Lee', role: 'Maintenance Specialist', experience: 9 },
                        { name: 'Anna Garcia', role: 'Quality Inspector', experience: 5 }
                    ],
                    'Gamma Team': [
                        { name: 'Tom Anderson', role: 'Senior Engineer', experience: 14 },
                        { name: 'Jessica Taylor', role: 'Diagnostic Specialist', experience: 8 },
                        { name: 'Kevin Martinez', role: 'Emergency Response', experience: 11 },
                        { name: 'Rachel White', role: 'Training Coordinator', experience: 7 }
                    ]
                };

                const skillCategories = {
                    'Transformers': { weight: 0.25, criticality: 'High' },
                    'Power Lines': { weight: 0.20, criticality: 'High' },
                    'Switches & Breakers': { weight: 0.18, criticality: 'Medium' },
                    'Substations': { weight: 0.15, criticality: 'High' },
                    'Protection Systems': { weight: 0.12, criticality: 'Medium' },
                    'SCADA Operations': { weight: 0.10, criticality: 'Low' }
                };

                const teamSkills = {};
                
                Object.keys(teams).forEach(teamName => {
                    const teamMembers = teams[teamName];
                    teamSkills[teamName] = {
                        members: teamMembers,
                        skillLevels: {},
                        avgExperience: teamMembers.reduce((sum, m) => sum + m.experience, 0) / teamMembers.length,
                        teamStrength: 0,
                        recommendations: []
                    };

                    // Calculate skill levels for each category
                    Object.keys(skillCategories).forEach(skill => {
                        let teamSkillLevel = 0;
                        
                        teamMembers.forEach(member => {
                            // Base skill calculation
                            let baseSkill = 50 + (member.experience * 3); // Experience factor
                            
                            // Role-specific bonuses
                            const roleBonus = this.getRoleBonus(member.role, skill);
                            const experienceBonus = Math.min(member.experience * 1.5, 20); // Cap at 20
                            
                            // Skill variation based on specialization
                            const specialization = this.getSpecializationFactor(member.role, skill);
                            
                            const memberSkill = Math.min(100, baseSkill + roleBonus + experienceBonus + specialization);
                            teamSkillLevel += memberSkill;
                        });
                        
                        teamSkills[teamName].skillLevels[skill] = Math.round(teamSkillLevel / teamMembers.length);
                    });

                    // Calculate overall team strength
                    teamSkills[teamName].teamStrength = Object.keys(skillCategories).reduce((total, skill) => {
                        return total + (teamSkills[teamName].skillLevels[skill] * skillCategories[skill].weight);
                    }, 0);

                    // Generate recommendations
                    teamSkills[teamName].recommendations = this.generateTeamRecommendations(
                        teamSkills[teamName].skillLevels, 
                        teamSkills[teamName].members
                    );
                });

                return { teams: teamSkills, skillCategories };
            }

            static getRoleBonus(role, skill) {
                const roleBonuses = {
                    'Senior Technician': { 'Transformers': 15, 'Power Lines': 10, 'Switches & Breakers': 12 },
                    'Electrical Engineer': { 'Protection Systems': 20, 'SCADA Operations': 15, 'Substations': 18 },
                    'Field Supervisor': { 'Power Lines': 15, 'Substations': 12, 'Switches & Breakers': 10 },
                    'Safety Coordinator': { 'Protection Systems': 10, 'Substations': 8, 'SCADA Operations': 5 },
                    'Lead Technician': { 'Transformers': 12, 'Switches & Breakers': 15, 'Power Lines': 8 },
                    'System Analyst': { 'SCADA Operations': 20, 'Protection Systems': 15, 'Substations': 10 },
                    'Maintenance Specialist': { 'Transformers': 18, 'Power Lines': 12, 'Switches & Breakers': 15 },
                    'Quality Inspector': { 'Protection Systems': 12, 'Transformers': 8, 'SCADA Operations': 10 },
                    'Senior Engineer': { 'Substations': 20, 'Protection Systems': 18, 'SCADA Operations': 15 },
                    'Diagnostic Specialist': { 'Protection Systems': 25, 'SCADA Operations': 20, 'Transformers': 12 },
                    'Emergency Response': { 'Power Lines': 20, 'Switches & Breakers': 18, 'Substations': 15 },
                    'Training Coordinator': { 'SCADA Operations': 12, 'Protection Systems': 10, 'Substations': 8 }
                };
                
                return roleBonuses[role]?.[skill] || 0;
            }

            static getSpecializationFactor(role, skill) {
                // Add random variation for realism (-5 to +10)
                return Math.round((Math.random() * 15) - 5);
            }

            static generateTeamRecommendations(skillLevels, members) {
                const recommendations = [];
                const weakSkills = Object.keys(skillLevels).filter(skill => skillLevels[skill] < 70);
                const strongSkills = Object.keys(skillLevels).filter(skill => skillLevels[skill] > 85);

                if (weakSkills.length > 0) {
                    recommendations.push({
                        type: 'training',
                        priority: 'high',
                        message: `Focus training on: ${weakSkills.join(', ')}`,
                        action: `Schedule ${weakSkills.length * 2} training hours this month`
                    });
                }

                if (members.some(m => m.experience > 12)) {
                    recommendations.push({
                        type: 'mentorship',
                        priority: 'medium',
                        message: 'Senior members can mentor junior staff',
                        action: 'Establish mentorship pairs for knowledge transfer'
                    });
                }

                if (strongSkills.length > 3) {
                    recommendations.push({
                        type: 'specialization',
                        priority: 'low',
                        message: `Team excels in: ${strongSkills.join(', ')}`,
                        action: 'Consider this team for complex projects in these areas'
                    });
                }

                return recommendations;
            }

            static generateTrainingPlan(teamSkills) {
                const trainingPlan = {};
                
                Object.keys(teamSkills.teams).forEach(teamName => {
                    const team = teamSkills.teams[teamName];
                    const needsImprovement = Object.keys(team.skillLevels)
                        .filter(skill => team.skillLevels[skill] < 75)
                        .map(skill => ({
                            skill,
                            currentLevel: team.skillLevels[skill],
                            targetLevel: Math.min(90, team.skillLevels[skill] + 20),
                            estimatedHours: Math.round((90 - team.skillLevels[skill]) / 5) * team.members.length
                        }));

                    trainingPlan[teamName] = {
                        totalHours: needsImprovement.reduce((sum, item) => sum + item.estimatedHours, 0),
                        skillsToImprove: needsImprovement,
                        priority: needsImprovement.length > 2 ? 'High' : needsImprovement.length > 0 ? 'Medium' : 'Low'
                    };
                });

                return trainingPlan;
            }
        }

        // Advanced Predictive Analytics Engine with ML Algorithms
        class PredictiveAnalytics {
            static generateFailureProbabilityForecast(assetData) {
                // Exponential degradation model with multiple factors
                const forecasts = {};
                
                assetData.forEach(asset => {
                    const currentHealth = asset.currentHealth;
                    const age = asset.age || 10; // years
                    const loadFactor = asset.loadFactor || 0.7;
                    const temperature = asset.temperature || 45; // Celsius
                    const vibration = asset.vibration || 0.3; // mm/s
                    
                    // Weibull distribution parameters for failure prediction
                    const beta = 2.5; // Shape parameter
                    const eta = 20; // Scale parameter (years)
                    const environmentalFactor = (temperature - 25) / 100 + vibration / 10;
                    const loadStressFactor = Math.pow(loadFactor, 1.5);
                    
                    const forecast = [];
                    for (let day = 1; day <= 30; day++) {
                        // Advanced failure probability calculation
                        const timeInYears = (age + day / 365);
                        const baseFailureRate = Math.pow(timeInYears / eta, beta);
                        const healthDegradation = (100 - currentHealth) / 100;
                        const environmentalStress = environmentalFactor * (day / 30);
                        const loadStress = loadStressFactor * 0.1;
                        
                        // Combined failure probability (0-100%)
                        const failureProb = Math.min(95, 
                            baseFailureRate * 100 + 
                            healthDegradation * 30 + 
                            environmentalStress * 20 + 
                            loadStress * 15 +
                            Math.random() * 5 // Stochastic component
                        );
                        
                        forecast.push(Math.max(1, failureProb));
                    }
                    
                    forecasts[asset.id] = {
                        name: asset.name,
                        forecast: forecast,
                        riskLevel: forecast[29] > 50 ? 'High' : forecast[29] > 25 ? 'Medium' : 'Low'
                    };
                });
                
                return forecasts;
            }
            
            static generateModelAccuracyTrends() {
                // Simulate ML model performance with realistic patterns
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'];
                const models = {
                    randomForest: { base: 89, trend: 0.3, variance: 2 },
                    neuralNetwork: { base: 91, trend: 0.5, variance: 3 },
                    svm: { base: 86, trend: 0.2, variance: 1.5 },
                    ensemble: { base: 93, trend: 0.4, variance: 1 }
                };
                
                const results = {};
                Object.keys(models).forEach(modelName => {
                    const model = models[modelName];
                    results[modelName] = months.map((month, i) => {
                        const trendEffect = model.trend * i;
                        const randomVariance = (Math.random() - 0.5) * 2 * model.variance;
                        const seasonalEffect = Math.sin(i * Math.PI / 6) * 2; // Seasonal pattern
                        
                        return Math.min(98, Math.max(80, 
                            model.base + trendEffect + randomVariance + seasonalEffect
                        ));
                    });
                });
                
                return { months, models: results };
            }
            
            static calculateFeatureImportance(assetData) {
                // SHAP-like feature importance calculation
                const features = {
                    temperature: { values: [], importance: 0 },
                    vibration: { values: [], importance: 0 },
                    oilQuality: { values: [], importance: 0 },
                    loadFactor: { values: [], importance: 0 },
                    age: { values: [], importance: 0 },
                    weather: { values: [], importance: 0 },
                    maintenanceHistory: { values: [], importance: 0 },
                    voltageStability: { values: [], importance: 0 }
                };
                
                // Collect feature values from assets
                assetData.forEach(asset => {
                    features.temperature.values.push(asset.temperature || 45 + Math.random() * 30);
                    features.vibration.values.push(asset.vibration || Math.random() * 0.8);
                    features.oilQuality.values.push(asset.oilQuality || 70 + Math.random() * 30);
                    features.loadFactor.values.push(asset.loadFactor || 0.5 + Math.random() * 0.4);
                    features.age.values.push(asset.age || 5 + Math.random() * 15);
                    features.weather.values.push(Math.random() * 100); // Weather impact score
                    features.maintenanceHistory.values.push(asset.maintenanceScore || 60 + Math.random() * 40);
                    features.voltageStability.values.push(95 + Math.random() * 10);
                });
                
                // Calculate mutual information-based importance
                Object.keys(features).forEach(featureName => {
                    const values = features[featureName].values;
                    const mean = values.reduce((a, b) => a + b, 0) / values.length;
                    const variance = values.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / values.length;
                    
                    // Feature importance based on correlation with failure probability
                    let correlation = 0;
                    assetData.forEach((asset, i) => {
                        const featureValue = values[i];
                        const failureRisk = (100 - asset.currentHealth) / 100;
                        correlation += Math.abs(featureValue - mean) * failureRisk;
                    });
                    
                    features[featureName].importance = (correlation / assetData.length) * (variance / 1000);
                });
                
                // Normalize importance scores to percentage
                const maxImportance = Math.max(...Object.values(features).map(f => f.importance));
                Object.keys(features).forEach(featureName => {
                    features[featureName].importance = (features[featureName].importance / maxImportance) * 100;
                });
                
                return features;
            }
            
            static generatePredictiveInsights(forecasts, accuracy, importance) {
                const insights = [];
                
                // High-risk asset insights
                const highRiskAssets = Object.values(forecasts).filter(f => f.riskLevel === 'High');
                if (highRiskAssets.length > 0) {
                    insights.push({
                        type: 'critical',
                        title: 'High Failure Risk Detected',
                        message: `${highRiskAssets.length} asset(s) predicted to have >50% failure probability within 30 days`,
                        action: 'Schedule immediate inspection and preventive maintenance'
                    });
                }
                
                // Model performance insights
                const avgAccuracy = Object.values(accuracy.models).flat().reduce((a, b) => a + b, 0) / 
                                   (Object.keys(accuracy.models).length * accuracy.months.length);
                
                if (avgAccuracy > 90) {
                    insights.push({
                        type: 'success',
                        title: 'High Model Confidence',
                        message: `Average model accuracy: ${avgAccuracy.toFixed(1)}% - Predictions are highly reliable`,
                        action: 'Continue current monitoring strategy'
                    });
                } else if (avgAccuracy < 85) {
                    insights.push({
                        type: 'warning',
                        title: 'Model Recalibration Needed',
                        message: `Model accuracy dropped to ${avgAccuracy.toFixed(1)}% - Consider retraining`,
                        action: 'Update training data and retrain models'
                    });
                }
                
                // Feature importance insights
                const topFeature = Object.keys(importance).reduce((a, b) => 
                    importance[a].importance > importance[b].importance ? a : b
                );
                
                insights.push({
                    type: 'info',
                    title: 'Key Predictive Factor',
                    message: `${topFeature} is the most influential factor (${importance[topFeature].importance.toFixed(1)}% importance)`,
                    action: `Focus monitoring efforts on ${topFeature} measurements`
                });
                
                return insights;
            }
        }

        // Chart.js Based Chart Renderer
        class ChartRenderer {
            static charts = new Map(); // Store chart instances

            static initializeAllCharts() {
                // Create all charts
                this.createFailureProbabilityChart();
                this.createModelAccuracyChart();
                this.createFeatureImportanceChart();
                this.createSkillsMatrixChart();
                this.createPerformanceTrendsChart();
                this.createAssetPerformanceChart();
                this.createDetailedMetricsChart();
            }

            static createFailureProbabilityChart() {
                const ctx = document.getElementById('failure-probability-chart');
                if (!ctx) return;

                // Get live asset data for ML predictions
                const liveData = window.liveDataSystem ? window.liveDataSystem.getLatestData() : null;
                const assetData = liveData ? liveData.assets.slice(0, 3) : [
                    { id: 'T001', name: 'Transformer T-001', currentHealth: 65, age: 12, temperature: 55, vibration: 0.4, loadFactor: 0.8 },
                    { id: 'PL045', name: 'Power Line PL-045', currentHealth: 78, age: 8, temperature: 35, vibration: 0.2, loadFactor: 0.6 },
                    { id: 'SW023', name: 'Switch SW-023', currentHealth: 45, age: 15, temperature: 48, vibration: 0.6, loadFactor: 0.9 }
                ];

                // Generate ML-based failure probability forecasts
                const forecasts = PredictiveAnalytics.generateFailureProbabilityForecast(assetData);
                const forecastKeys = Object.keys(forecasts).slice(0, 3); // Top 3 high-risk assets

                const labels = Array.from({length: 30}, (_, i) => `Day ${i + 1}`);
                const datasets = forecastKeys.map((assetId, index) => {
                    const colors = ['#dc3545', '#ffc107', '#fd7e14'];
                    const forecast = forecasts[assetId];
                    
                    return {
                        label: `${forecast.name} (${forecast.riskLevel} Risk)`,
                        data: forecast.forecast,
                        borderColor: colors[index],
                        backgroundColor: colors[index] + '20',
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: colors[index],
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 3
                    };
                });

                const chart = new Chart(ctx, {
                    type: 'line',
                    data: { labels, datasets },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'AI-Powered Failure Probability Forecast (Weibull Distribution Model)',
                                font: { size: 14, weight: 'bold' }
                            },
                            legend: {
                                display: true,
                                position: 'top',
                                labels: { usePointStyle: true }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    label: function(context) {
                                        const value = context.parsed.y.toFixed(1);
                                        const riskLevel = value > 50 ? 'CRITICAL' : value > 25 ? 'HIGH' : 'MEDIUM';
                                        return `${context.dataset.label}: ${value}% (${riskLevel})`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Failure Probability (%)',
                                    font: { weight: 'bold' }
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Forecast Horizon (30-Day Period)',
                                    font: { weight: 'bold' }
                                },
                                grid: { color: 'rgba(0,0,0,0.05)' }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });

                this.charts.set('failure-probability-chart', chart);
            }

            static createModelAccuracyChart() {
                const ctx = document.getElementById('model-accuracy-chart');
                if (!ctx) return;

                // Generate ML model performance trends
                const accuracyData = PredictiveAnalytics.generateModelAccuracyTrends();
                
                const datasets = [
                    {
                        label: 'Random Forest (Ensemble)',
                        data: accuracyData.models.randomForest,
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4,
                        pointStyle: 'circle',
                        pointRadius: 4
                    },
                    {
                        label: 'Neural Network (Deep Learning)',
                        data: accuracyData.models.neuralNetwork,
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        tension: 0.4,
                        pointStyle: 'rect',
                        pointRadius: 4
                    },
                    {
                        label: 'Support Vector Machine',
                        data: accuracyData.models.svm,
                        borderColor: '#6f42c1',
                        backgroundColor: 'rgba(111, 66, 193, 0.1)',
                        tension: 0.4,
                        pointStyle: 'triangle',
                        pointRadius: 4
                    },
                    {
                        label: 'Ensemble Model (Best)',
                        data: accuracyData.models.ensemble,
                        borderColor: '#fd7e14',
                        backgroundColor: 'rgba(253, 126, 20, 0.1)',
                        tension: 0.4,
                        pointStyle: 'star',
                        pointRadius: 5,
                        borderWidth: 3
                    }
                ];

                const chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: accuracyData.months,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'ML Model Performance Comparison & Trends',
                                font: { size: 14, weight: 'bold' }
                            },
                            legend: {
                                display: true,
                                position: 'top',
                                labels: { usePointStyle: true }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    label: function(context) {
                                        const accuracy = context.parsed.y.toFixed(1);
                                        const performance = accuracy > 92 ? 'Excellent' : accuracy > 88 ? 'Good' : 'Needs Improvement';
                                        return `${context.dataset.label}: ${accuracy}% (${performance})`;
                                    },
                                    footer: function(tooltipItems) {
                                        const avgAccuracy = tooltipItems.reduce((sum, item) => sum + item.parsed.y, 0) / tooltipItems.length;
                                        return `Average: ${avgAccuracy.toFixed(1)}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                min: 80,
                                max: 98,
                                title: {
                                    display: true,
                                    text: 'Model Accuracy (%)',
                                    font: { weight: 'bold' }
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Training Period (Monthly Evaluation)',
                                    font: { weight: 'bold' }
                                },
                                grid: { color: 'rgba(0,0,0,0.05)' }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });

                this.charts.set('model-accuracy-chart', chart);
            }

            static createFeatureImportanceChart() {
                const ctx = document.getElementById('feature-importance-chart');
                if (!ctx) return;

                // Get live asset data for feature importance calculation
                const liveData = window.liveDataSystem ? window.liveDataSystem.getLatestData() : null;
                const assetData = liveData ? liveData.assets : [
                    { currentHealth: 65, age: 12, temperature: 55, vibration: 0.4, loadFactor: 0.8, oilQuality: 75, maintenanceScore: 80 },
                    { currentHealth: 78, age: 8, temperature: 35, vibration: 0.2, loadFactor: 0.6, oilQuality: 85, maintenanceScore: 90 },
                    { currentHealth: 45, age: 15, temperature: 48, vibration: 0.6, loadFactor: 0.9, oilQuality: 60, maintenanceScore: 65 }
                ];

                // Calculate SHAP-like feature importance
                const featureImportance = PredictiveAnalytics.calculateFeatureImportance(assetData);
                
                const labels = Object.keys(featureImportance).map(key => 
                    key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())
                );
                const importanceValues = Object.values(featureImportance).map(f => f.importance);
                
                // Color gradient based on importance
                const colors = importanceValues.map(value => {
                    const intensity = value / 100;
                    if (intensity > 0.7) return '#dc3545'; // High importance - red
                    if (intensity > 0.4) return '#ffc107'; // Medium importance - yellow
                    return '#28a745'; // Low importance - green
                });

                const chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Feature Importance (SHAP Values)',
                            data: importanceValues,
                            backgroundColor: colors,
                            borderColor: colors.map(color => color + 'CC'),
                            borderWidth: 2,
                            borderRadius: 6,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        plugins: {
                            title: {
                                display: true,
                                text: 'Feature Importance Analysis (SHAP-based ML Interpretability)',
                                font: { size: 14, weight: 'bold' }
                            },
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const importance = context.parsed.x.toFixed(1);
                                        const impact = importance > 70 ? 'Critical' : importance > 40 ? 'Significant' : 'Moderate';
                                        return `Importance: ${importance}% (${impact} Impact)`;
                                    },
                                    afterLabel: function(context) {
                                        const feature = context.label.toLowerCase();
                                        const insights = {
                                            'temperature': 'Higher temperatures accelerate component degradation',
                                            'vibration': 'Excessive vibration indicates mechanical stress',
                                            'oil quality': 'Oil condition affects insulation and cooling',
                                            'load factor': 'Overloading reduces equipment lifespan',
                                            'age': 'Older equipment has higher failure probability',
                                            'weather': 'Environmental conditions affect performance',
                                            'maintenance history': 'Regular maintenance extends asset life',
                                            'voltage stability': 'Voltage fluctuations stress components'
                                        };
                                        return insights[feature] || 'Key factor in failure prediction';
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Importance Score (%)',
                                    font: { weight: 'bold' }
                                },
                                grid: { color: 'rgba(0,0,0,0.1)' },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Predictive Features',
                                    font: { weight: 'bold' }
                                },
                                grid: { display: false }
                            }
                        }
                    }
                });

                this.charts.set('feature-importance-chart', chart);
            }

            static createSkillsMatrixChart() {
                const ctx = document.getElementById('skills-matrix-chart');
                if (!ctx) return;

                // Generate comprehensive team skills data
                const teamData = TeamManagement.generateTeamSkillsMatrix();
                const skillCategories = Object.keys(teamData.skillCategories);
                
                // Create datasets for each team
                const datasets = Object.keys(teamData.teams).map((teamName, index) => {
                    const team = teamData.teams[teamName];
                    const skillValues = skillCategories.map(skill => team.skillLevels[skill]);
                    
                    const colors = [
                        { bg: 'rgba(255, 99, 132, 0.3)', border: 'rgba(255, 99, 132, 1)' },  // Red for Alpha
                        { bg: 'rgba(54, 162, 235, 0.3)', border: 'rgba(54, 162, 235, 1)' },  // Blue for Beta
                        { bg: 'rgba(255, 206, 86, 0.3)', border: 'rgba(255, 206, 86, 1)' }   // Yellow for Gamma
                    ];
                    
                    return {
                        label: `${teamName} (Strength: ${Math.round(team.teamStrength)})`,
                        data: skillValues,
                        backgroundColor: colors[index].bg,
                        borderColor: colors[index].border,
                        borderWidth: 2,
                        pointBackgroundColor: colors[index].border,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    };
                });

                const chart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: skillCategories,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Team Skills Matrix & Capability Assessment',
                                font: { size: 14, weight: 'bold' }
                            },
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const skillLevel = context.parsed.r;
                                        const proficiency = skillLevel >= 85 ? 'Expert' : 
                                                          skillLevel >= 70 ? 'Proficient' : 
                                                          skillLevel >= 50 ? 'Competent' : 'Developing';
                                        return `${context.dataset.label}: ${skillLevel}% (${proficiency})`;
                                    },
                                    afterLabel: function(context) {
                                        const skill = context.label;
                                        const criticality = teamData.skillCategories[skill].criticality;
                                        return `Criticality: ${criticality} | Weight: ${Math.round(teamData.skillCategories[skill].weight * 100)}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                min: 0,
                                max: 100,
                                ticks: {
                                    stepSize: 20,
                                    callback: function(value) {
                                        return value + '%';
                                    },
                                    backdropColor: 'rgba(255, 255, 255, 0.8)'
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                angleLines: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                pointLabels: {
                                    font: {
                                        size: 11,
                                        weight: 'bold'
                                    },
                                    color: '#333'
                                }
                            }
                        },
                        interaction: {
                            intersect: false
                        }
                    }
                });

                this.charts.set('skills-matrix-chart', chart);
                
                // Also generate and display team insights
                this.displayTeamInsights(teamData);
            }

            static displayTeamInsights(teamData) {
                // Create insights display area if it doesn't exist
                let insightsContainer = document.getElementById('team-insights-container');
                if (!insightsContainer) {
                    insightsContainer = document.createElement('div');
                    insightsContainer.id = 'team-insights-container';
                    insightsContainer.style.cssText = 'margin-top: 20px; display: grid; gap: 15px;';
                    
                    const chartContainer = document.getElementById('skills-matrix-chart').parentElement;
                    chartContainer.parentElement.appendChild(insightsContainer);
                }

                const trainingPlan = TeamManagement.generateTrainingPlan(teamData);
                
                insightsContainer.innerHTML = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #007bff;">
                        <h4 style="margin: 0 0 15px 0; color: #333;">📊 Team Analytics Summary</h4>
                        ${Object.keys(teamData.teams).map(teamName => {
                            const team = teamData.teams[teamName];
                            const training = trainingPlan[teamName];
                            return `
                                <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <strong style="color: #333;">${teamName}</strong>
                                        <span style="background: ${team.teamStrength > 80 ? '#28a745' : team.teamStrength > 70 ? '#ffc107' : '#dc3545'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">
                                            ${Math.round(team.teamStrength)}% Overall
                                        </span>
                                    </div>
                                    <div style="font-size: 0.9rem; color: #666; margin-bottom: 8px;">
                                        Members: ${team.members.length} | Avg Experience: ${team.avgExperience.toFixed(1)} years
                                    </div>
                                    <div style="font-size: 0.9rem; color: #666;">
                                        Training Priority: <strong style="color: ${training.priority === 'High' ? '#dc3545' : training.priority === 'Medium' ? '#ffc107' : '#28a745'}">${training.priority}</strong>
                                        ${training.totalHours > 0 ? ` | Estimated Training: ${training.totalHours} hours` : ''}
                                    </div>
                                    ${team.recommendations.length > 0 ? `
                                        <div style="margin-top: 10px; font-size: 0.85rem;">
                                            <strong>Recommendations:</strong>
                                            <ul style="margin: 5px 0 0 15px; padding: 0;">
                                                ${team.recommendations.map(rec => `<li style="margin-bottom: 5px;">${rec.message}</li>`).join('')}
                                            </ul>
                                        </div>
                                    ` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }

            static createTrainingProgressChart() {
                const ctx = document.getElementById('training-progress-chart');
                if (!ctx) return;

                // Generate training progress data
                const teamData = TeamManagement.generateTeamSkillsMatrix();
                const trainingPlan = TeamManagement.generateTrainingPlan(teamData);
                
                const teamNames = Object.keys(trainingPlan);
                const trainingHours = teamNames.map(team => trainingPlan[team].totalHours);
                const completionRates = teamNames.map(() => 65 + Math.random() * 30); // Simulated completion rates
                
                // Color coding based on training priority
                const colors = teamNames.map(team => {
                    const priority = trainingPlan[team].priority;
                    return priority === 'High' ? '#dc3545' : 
                           priority === 'Medium' ? '#ffc107' : '#28a745';
                });

                const chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: teamNames.map((team, i) => `${team}\n${trainingHours[i]}h needed`),
                        datasets: [{
                            label: 'Training Completion',
                            data: completionRates,
                            backgroundColor: colors.map(color => color + '80'),
                            borderColor: colors,
                            borderWidth: 3,
                            hoverBorderWidth: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Training Progress & Requirements',
                                font: { size: 12, weight: 'bold' }
                            },
                            legend: {
                                display: true,
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 15,
                                    font: { size: 10 }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const teamName = teamNames[context.dataIndex];
                                        const completion = context.parsed.toFixed(1);
                                        const priority = trainingPlan[teamName].priority;
                                        const hours = trainingHours[context.dataIndex];
                                        return [
                                            `${teamName}: ${completion}% Complete`,
                                            `Priority: ${priority}`,
                                            `Remaining: ${hours} training hours`
                                        ];
                                    }
                                }
                            }
                        }
                    }
                });

                this.charts.set('training-progress-chart', chart);
            }

            static createPerformanceTrendsChart() {
                const ctx = document.getElementById('performance-trends-chart');
                if (!ctx) return;

                // Generate 6 months of historical performance data
                const months = ['Aug 2024', 'Sep 2024', 'Oct 2024', 'Nov 2024', 'Dec 2024', 'Jan 2025'];
                
                // Get live data to influence current trends
                const liveData = window.liveDataSystem ? window.liveDataSystem.getLatestData() : null;
                const currentHealth = liveData ? liveData.assets.reduce((sum, a) => sum + a.currentHealth, 0) / liveData.assets.length : 75;
                const alertCount = liveData ? liveData.alerts.filter(a => !a.acknowledged).length : 3;

                // Generate realistic trends with seasonal and operational patterns
                const generateTrend = (baseValue, volatility, trend = 0) => {
                    return months.map((_, i) => {
                        const seasonalEffect = Math.sin((i + 8) * Math.PI / 6) * volatility * 0.3; // Summer/winter effects
                        const trendEffect = trend * i;
                        const randomVariation = (Math.random() - 0.5) * volatility;
                        const currentHealthEffect = i === 5 ? (currentHealth - 75) / 25 * volatility * 0.5 : 0;
                        const alertEffect = i === 5 ? -alertCount * volatility * 0.1 : 0;
                        
                        return Math.round((baseValue + seasonalEffect + trendEffect + randomVariation + currentHealthEffect + alertEffect) * 100) / 100;
                    });
                };

                const data = {
                    labels: months,
                    datasets: [{
                        label: 'System Availability (%)',
                        data: generateTrend(99.2, 0.8, 0.05),
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4,
                        fill: false,
                        yAxisID: 'y',
                        pointBackgroundColor: '#28a745',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }, {
                        label: 'MTBF (thousands of hours)',
                        data: generateTrend(2.85, 0.3, 0.02),
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        tension: 0.4,
                        fill: false,
                        yAxisID: 'y1',
                        pointBackgroundColor: '#007bff',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }, {
                        label: 'MTTR (hours)',
                        data: generateTrend(4.5, 1.2, -0.08),
                        borderColor: '#ffc107',
                        backgroundColor: 'rgba(255, 193, 7, 0.1)',
                        tension: 0.4,
                        fill: false,
                        yAxisID: 'y2',
                        pointBackgroundColor: '#ffc107',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }, {
                        label: 'Energy Efficiency (%)',
                        data: generateTrend(92.5, 1.5, 0.03),
                        borderColor: '#17a2b8',
                        backgroundColor: 'rgba(23, 162, 184, 0.1)',
                        tension: 0.4,
                        fill: false,
                        yAxisID: 'y',
                        pointBackgroundColor: '#17a2b8',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }, {
                        label: 'Maintenance Cost Index',
                        data: generateTrend(100, 8, -1.2),
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        tension: 0.4,
                        fill: false,
                        yAxisID: 'y2',
                        pointBackgroundColor: '#dc3545',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                };

                const chart = new Chart(ctx, {
                    type: 'line',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'System Performance Trends (6 Months)',
                                font: { size: 16, weight: 'bold' }
                            },
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    font: { size: 11 }
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    afterLabel: function(context) {
                                        const improvements = {
                                            'System Availability (%)': 'Target: 99.5%',
                                            'MTBF (thousands of hours)': 'Industry avg: 2.4k hrs',
                                            'MTTR (hours)': 'Target: < 4 hrs',
                                            'Energy Efficiency (%)': 'Target: 95%',
                                            'Maintenance Cost Index': 'Baseline: 100'
                                        };
                                        return improvements[context.dataset.label] || '';
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Month',
                                    font: { size: 12, weight: 'bold' }
                                }
                            },
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Availability (%) / Efficiency (%)',
                                    font: { size: 12 }
                                },
                                min: 85,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'MTBF (k hours)',
                                    font: { size: 12 }
                                },
                                min: 2.0,
                                max: 3.5,
                                grid: {
                                    drawOnChartArea: false,
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value.toFixed(1) + 'k';
                                    }
                                }
                            },
                            y2: {
                                type: 'linear',
                                display: false,
                                position: 'right',
                                min: 0,
                                max: 120
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        },
                        animation: {
                            duration: 2000,
                            easing: 'easeInOutQuart'
                        }
                    }
                });

                this.charts.set('performance-trends-chart', chart);
            }

            static createAssetPerformanceChart() {
                const ctx = document.getElementById('asset-performance-chart');
                if (!ctx) return;

                // Get live data for dynamic asset performance
                const liveData = window.liveDataSystem ? window.liveDataSystem.getLatestData() : null;
                const assets = liveData ? liveData.assets.slice(0, 8) : [
                    { id: 'T-001', type: 'Transformer', currentHealth: 85, reliability: 92, efficiency: 88, costIndex: 105 },
                    { id: 'T-002', type: 'Transformer', currentHealth: 92, reliability: 95, efficiency: 94, costIndex: 85 },
                    { id: 'PL-045', type: 'Power Line', currentHealth: 78, reliability: 82, efficiency: 90, costIndex: 115 },
                    { id: 'S-012', type: 'Substation', currentHealth: 95, reliability: 97, efficiency: 96, costIndex: 75 },
                    { id: 'B-007', type: 'Breaker', currentHealth: 88, reliability: 90, efficiency: 87, costIndex: 95 },
                    { id: 'SS-003', type: 'Switch', currentHealth: 91, reliability: 89, efficiency: 85, costIndex: 88 }
                ];

                // Create multi-metric datasets
                const labels = assets.map(a => a.id || `${a.type.substring(0,1)}-${Math.floor(Math.random() * 100)}`);
                const healthData = assets.map(a => a.currentHealth || Math.round(70 + Math.random() * 25));
                const reliabilityData = assets.map((a, i) => (a.reliability || healthData[i] + Math.round((Math.random() - 0.5) * 10)));
                const efficiencyData = assets.map((a, i) => (a.efficiency || healthData[i] + Math.round((Math.random() - 0.5) * 8)));
                const costData = assets.map(a => a.costIndex || Math.round(80 + Math.random() * 40));

                const data = {
                    labels: labels,
                    datasets: [{
                        label: 'Health Score',
                        data: healthData,
                        backgroundColor: healthData.map(score => {
                            if (score >= 90) return 'rgba(40, 167, 69, 0.8)';
                            if (score >= 75) return 'rgba(255, 193, 7, 0.8)';
                            return 'rgba(220, 53, 69, 0.8)';
                        }),
                        borderColor: '#fff',
                        borderWidth: 2,
                        borderRadius: 4,
                        yAxisID: 'y'
                    }, {
                        label: 'Reliability Index',
                        data: reliabilityData,
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                        yAxisID: 'y'
                    }, {
                        label: 'Efficiency Rating',
                        data: efficiencyData,
                        backgroundColor: 'rgba(23, 162, 184, 0.7)',
                        borderColor: 'rgba(23, 162, 184, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                        yAxisID: 'y'
                    }, {
                        label: 'Cost Index',
                        data: costData,
                        backgroundColor: 'rgba(156, 39, 176, 0.6)',
                        borderColor: 'rgba(156, 39, 176, 1)',
                        borderWidth: 2,
                        borderRadius: 4,
                        yAxisID: 'y1',
                        type: 'line',
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(156, 39, 176, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                };

                const chart = new Chart(ctx, {
                    type: 'bar',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Asset Performance Breakdown by Category',
                                font: { size: 16, weight: 'bold' }
                            },
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    font: { size: 11 }
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    afterLabel: function(context) {
                                        const assetIndex = context.dataIndex;
                                        const asset = assets[assetIndex];
                                        if (context.dataset.label === 'Health Score') {
                                            return [
                                                `Type: ${asset?.type || 'N/A'}`,
                                                `Status: ${context.parsed.y >= 90 ? 'Excellent' : context.parsed.y >= 75 ? 'Good' : 'Needs Attention'}`,
                                                `Last Maintenance: ${Math.floor(Math.random() * 30) + 1} days ago`
                                            ];
                                        } else if (context.dataset.label === 'Cost Index') {
                                            return [
                                                `Baseline: 100`,
                                                `Trend: ${context.parsed.y > 100 ? 'Above average' : 'Cost efficient'}`,
                                                `Annual Cost: $${Math.round(context.parsed.y * 12 * 0.8)}K`
                                            ];
                                        }
                                        return null;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Asset Identifier',
                                    font: { size: 12, weight: 'bold' }
                                },
                                ticks: {
                                    maxRotation: 45,
                                    font: { size: 10 }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Performance Score (0-100)',
                                    font: { size: 12, weight: 'bold' }
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Cost Index (100=baseline)',
                                    font: { size: 11 }
                                },
                                min: 50,
                                max: 150,
                                grid: {
                                    drawOnChartArea: false,
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value + '';
                                    }
                                }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        },
                        animation: {
                            duration: 1800,
                            easing: 'easeInOutQuart'
                        }
                    }
                });

                this.charts.set('asset-performance-chart', chart);
            }

            static createDetailedMetricsChart() {
                const ctx = document.getElementById('detailed-metrics-chart');
                if (!ctx) return;

                // Get live data for dynamic metrics
                const liveData = window.liveDataSystem ? window.liveDataSystem.getLatestData() : null;
                const avgHealth = liveData ? liveData.assets.reduce((sum, a) => sum + a.currentHealth, 0) / liveData.assets.length : 75;
                const activeAlerts = liveData ? liveData.alerts.filter(a => !a.acknowledged).length : 3;

                // Calculate dynamic performance metrics based on system state
                const performanceMetrics = {
                    'System Availability': {
                        current: Math.round(Math.min(99.8, 97 + avgHealth/25 - activeAlerts * 0.5)),
                        target: 99.5,
                        benchmark: 99.2,
                        unit: '%'
                    },
                    'Asset Reliability': {
                        current: Math.round(avgHealth + Math.random() * 5 - 2),
                        target: 90,
                        benchmark: 85,
                        unit: '%'
                    },
                    'Energy Efficiency': {
                        current: Math.round(92 + (avgHealth - 70) / 10 + Math.random() * 3),
                        target: 95,
                        benchmark: 88,
                        unit: '%'
                    },
                    'Response Time': {
                        current: Math.round(Math.max(2, 8 - avgHealth/15 + activeAlerts * 0.3)),
                        target: 4,
                        benchmark: 6,
                        unit: 'min'
                    },
                    'Maintenance Cost': {
                        current: Math.round(120 - avgHealth/2 + activeAlerts * 5),
                        target: 100,
                        benchmark: 140,
                        unit: '$K/month'
                    },
                    'Safety Index': {
                        current: Math.round(Math.min(100, 95 + avgHealth/20 - activeAlerts)),
                        target: 98,
                        benchmark: 92,
                        unit: 'score'
                    }
                };

                const labels = Object.keys(performanceMetrics);
                const currentValues = labels.map(label => performanceMetrics[label].current);
                const targetValues = labels.map(label => performanceMetrics[label].target);
                const benchmarkValues = labels.map(label => performanceMetrics[label].benchmark);

                const data = {
                    labels: labels,
                    datasets: [{
                        label: 'Current Performance',
                        data: currentValues,
                        backgroundColor: currentValues.map((val, idx) => {
                            const target = targetValues[idx];
                            return val >= target ? 'rgba(40, 167, 69, 0.8)' : 
                                   val >= target * 0.9 ? 'rgba(255, 193, 7, 0.8)' : 
                                   'rgba(220, 53, 69, 0.8)';
                        }),
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2,
                        borderRadius: 4
                    }, {
                        label: 'Target Values',
                        data: targetValues,
                        backgroundColor: 'rgba(255, 206, 86, 0.6)',
                        borderColor: 'rgba(255, 206, 86, 1)',
                        borderWidth: 2,
                        borderRadius: 4
                    }, {
                        label: 'Industry Benchmark',
                        data: benchmarkValues,
                        backgroundColor: 'rgba(156, 39, 176, 0.6)',
                        borderColor: 'rgba(156, 39, 176, 1)',
                        borderWidth: 2,
                        borderRadius: 4
                    }]
                };

                const chart = new Chart(ctx, {
                    type: 'bar',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Performance Metrics: Current vs Target vs Benchmark',
                                font: { size: 16, weight: 'bold' }
                            },
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    afterLabel: function(context) {
                                        const metric = performanceMetrics[context.label];
                                        const performance = ((context.parsed.y / metric.target) * 100).toFixed(1);
                                        return [
                                            `Unit: ${metric.unit}`,
                                            `Performance: ${performance}% of target`,
                                            context.dataset.label === 'Current Performance' ? 
                                                `Gap to target: ${(metric.target - metric.current).toFixed(1)} ${metric.unit}` : ''
                                        ].filter(Boolean);
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Performance Categories',
                                    font: { size: 14, weight: 'bold' }
                                },
                                ticks: {
                                    maxRotation: 45,
                                    font: { size: 11 }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Performance Score / Value',
                                    font: { size: 14, weight: 'bold' }
                                },
                                ticks: {
                                    font: { size: 11 }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        animation: {
                            duration: 1500,
                            easing: 'easeInOutQuart'
                        }
                    }
                });

                this.charts.set('detailed-metrics-chart', chart);
                
                // Store performance metrics for live updates
                this.performanceMetrics = performanceMetrics;
            }

            static updateChartsWithLiveData() {
                if (!window.liveDataSystem) return;
                
                const liveData = window.liveDataSystem.getLatestData();
                
                // Update failure probability chart with live risk data
                const failureChart = this.charts.get('failure-probability-chart');
                if (failureChart && liveData.assets.length > 0) {
                    const highRiskAssets = liveData.assets.filter(a => a.currentHealth < 50);
                    const riskData = highRiskAssets.slice(0, 2).map(asset => 
                        Array.from({length: 7}, (_, i) => Math.max(5, (100 - asset.currentHealth) + i * 3))
                    );
                    
                    if (riskData.length > 0) {
                        failureChart.data.datasets[0].data = riskData[0] || [5, 8, 12, 18, 25, 35, 42];
                        if (riskData.length > 1) {
                            failureChart.data.datasets[1].data = riskData[1];
                        }
                        failureChart.update('none');
                    }
                }
                
                // Update model accuracy chart with dynamic performance metrics
                const accuracyChart = this.charts.get('model-accuracy-chart');
                if (accuracyChart) {
                    const baseAccuracy = 85 + Math.random() * 8; // 85-93%
                    const basePrecision = 87 + Math.random() * 8; // 87-95%  
                    const baseRecall = 83 + Math.random() * 8; // 83-91%
                    
                    // Shift data and add new point
                    accuracyChart.data.datasets[0].data.shift();
                    accuracyChart.data.datasets[0].data.push(Math.round(baseAccuracy));
                    accuracyChart.data.datasets[1].data.shift();
                    accuracyChart.data.datasets[1].data.push(Math.round(basePrecision));
                    accuracyChart.data.datasets[2].data.shift();
                    accuracyChart.data.datasets[2].data.push(Math.round(baseRecall));
                    
                    accuracyChart.update('none');
                }
                
                // Update feature importance chart with current asset conditions
                const featureChart = this.charts.get('feature-importance-chart');
                if (featureChart && liveData.assets.length > 0) {
                    const avgHealth = liveData.assets.reduce((sum, a) => sum + a.currentHealth, 0) / liveData.assets.length;
                    const tempFactor = 100 - avgHealth > 60 ? 0.9 : 0.7; // Temperature more important when health is low
                    
                    featureChart.data.datasets[0].data = [
                        Math.round(25 * tempFactor + Math.random() * 5), // Temperature
                        Math.round(20 + Math.random() * 5), // Vibration
                        Math.round(15 + Math.random() * 5), // Oil Quality
                        Math.round(12 + Math.random() * 3), // Load Factor
                        Math.round(18 + Math.random() * 4), // Age
                        Math.round(10 + Math.random() * 3)  // Weather
                    ];
                    featureChart.update('none');
                }
                
                // Update performance trends chart
                const performanceChart = this.charts.get('performance-trends-chart');
                if (performanceChart && liveData.assets.length > 0) {
                    const alertCount = liveData.alerts.filter(a => !a.acknowledged).length;
                    const avgHealth = liveData.assets.reduce((sum, a) => sum + a.currentHealth, 0) / liveData.assets.length;
                    
                    // Shift data and add new points for each dataset
                    performanceChart.data.datasets.forEach(dataset => {
                        if (dataset.data.length > 0) {
                            dataset.data.shift();
                            
                            if (dataset.label.includes('Availability')) {
                                const newValue = Math.min(99.8, 97 + avgHealth/25 - alertCount * 0.5 + Math.random() * 1);
                                dataset.data.push(Math.round(newValue * 100) / 100);
                            } else if (dataset.label.includes('MTBF')) {
                                const newValue = 2.5 + avgHealth/50 - alertCount * 0.1 + Math.random() * 0.3;
                                dataset.data.push(Math.round(newValue * 100) / 100);
                            } else if (dataset.label.includes('MTTR')) {
                                const newValue = Math.max(2, 8 - avgHealth/15 + alertCount * 0.3 + Math.random() * 1);
                                dataset.data.push(Math.round(newValue * 10) / 10);
                            } else if (dataset.label.includes('Efficiency')) {
                                const newValue = 92 + (avgHealth - 70) / 10 + Math.random() * 2;
                                dataset.data.push(Math.round(newValue * 10) / 10);
                            } else if (dataset.label.includes('Cost')) {
                                const newValue = 120 - avgHealth/2 + alertCount * 5 + Math.random() * 10;
                                dataset.data.push(Math.round(newValue));
                            }
                        }
                    });
                    performanceChart.update('none');
                }
                
                // Update asset performance chart
                const assetChart = this.charts.get('asset-performance-chart');
                if (assetChart && liveData.assets.length > 0) {
                    const topAssets = liveData.assets.slice(0, assetChart.data.labels.length);
                    
                    assetChart.data.datasets.forEach(dataset => {
                        if (dataset.label === 'Health Score') {
                            dataset.data = topAssets.map(a => a.currentHealth);
                            // Update colors based on health scores
                            dataset.backgroundColor = topAssets.map(a => {
                                if (a.currentHealth >= 90) return 'rgba(40, 167, 69, 0.8)';
                                if (a.currentHealth >= 75) return 'rgba(255, 193, 7, 0.8)';
                                return 'rgba(220, 53, 69, 0.8)';
                            });
                        } else if (dataset.label === 'Reliability Index') {
                            dataset.data = topAssets.map(a => Math.min(100, a.currentHealth + Math.round((Math.random() - 0.5) * 10)));
                        } else if (dataset.label === 'Efficiency Rating') {
                            dataset.data = topAssets.map(a => Math.min(100, a.currentHealth + Math.round((Math.random() - 0.5) * 8)));
                        } else if (dataset.label === 'Cost Index') {
                            dataset.data = topAssets.map(a => Math.round(150 - a.currentHealth + Math.random() * 20));
                        }
                    });
                    assetChart.update('none');
                }
                
                // Update detailed metrics chart
                const detailedChart = this.charts.get('detailed-metrics-chart');
                if (detailedChart && liveData.assets.length > 0) {
                    const avgHealth = liveData.assets.reduce((sum, a) => sum + a.currentHealth, 0) / liveData.assets.length;
                    const activeAlerts = liveData.alerts.filter(a => !a.acknowledged).length;
                    
                    // Recalculate current performance values
                    const newCurrentValues = [
                        Math.round(Math.min(99.8, 97 + avgHealth/25 - activeAlerts * 0.5)), // Availability
                        Math.round(avgHealth + Math.random() * 5 - 2), // Reliability
                        Math.round(92 + (avgHealth - 70) / 10 + Math.random() * 3), // Efficiency
                        Math.round(Math.max(2, 8 - avgHealth/15 + activeAlerts * 0.3)), // Response Time
                        Math.round(120 - avgHealth/2 + activeAlerts * 5), // Maintenance Cost
                        Math.round(Math.min(100, 95 + avgHealth/20 - activeAlerts)) // Safety Index
                    ];
                    
                    // Update current performance dataset
                    if (detailedChart.data.datasets[0]) {
                        detailedChart.data.datasets[0].data = newCurrentValues;
                        // Update colors based on performance vs targets
                        const targets = detailedChart.data.datasets[1].data;
                        detailedChart.data.datasets[0].backgroundColor = newCurrentValues.map((val, idx) => {
                            const target = targets[idx];
                            return val >= target ? 'rgba(40, 167, 69, 0.8)' : 
                                   val >= target * 0.9 ? 'rgba(255, 193, 7, 0.8)' : 
                                   'rgba(220, 53, 69, 0.8)';
                        });
                    }
                    detailedChart.update('none');
                }
            }

            static updateChartWithLiveData(chartId, newData) {
                const chart = this.charts.get(chartId);
                if (chart && newData) {
                    // Update chart data based on live data
                    if (chart.data.datasets) {
                        chart.data.datasets.forEach((dataset, index) => {
                            if (newData.datasets && newData.datasets[index]) {
                                dataset.data = newData.datasets[index].data;
                            }
                        });
                        chart.update('none'); // Animate update
                    }
                }
            }
        }

        // Initialize Real Charts
        function initializeRealCharts() {
            // Replace all chart placeholders with real charts
            replaceChartPlaceholders();
            
            // Set up live chart updates
            if (window.liveDataSystem && window.liveDataSystem.isRunning) {
                updateChartsWithLiveData();
            }
        }

        function replaceChartPlaceholders() {
            const placeholders = document.querySelectorAll('.chart-placeholder');
            
            placeholders.forEach((placeholder, index) => {
                const parent = placeholder.parentElement;
                const title = parent.querySelector('h4')?.textContent || '';
                
                // Determine chart type based on title or context
                if (title.includes('Failure Probability') || title.includes('Forecast')) {
                    // Line chart for trends
                    const data = generateTimeSeriesData();
                    ChartRenderer.createLineChart(placeholder, data, {
                        color: '#dc3545',
                        onClick: (item) => showAssetDetails(item.label, `${item.value}%`)
                    });
                } else if (title.includes('Distribution') || title.includes('Health')) {
                    // Doughnut chart for distributions
                    const data = generateHealthDistributionData();
                    ChartRenderer.createDoughnutChart(placeholder, data, {
                        centerText: 'Assets',
                        onClick: (item) => showCategoryDetails(item.label)
                    });
                } else if (title.includes('Performance') || title.includes('Accuracy')) {
                    // Bar chart for performance metrics
                    const data = generatePerformanceData();
                    ChartRenderer.createBarChart(placeholder, data, {
                        onClick: (item) => showMetricDetails(item.label, item.value)
                    });
                } else if (title.includes('Gauge') || title.includes('System Performance')) {
                    // Multiple gauges
                    createSystemGauges(placeholder);
                } else {
                    // Default to bar chart
                    const data = generateDefaultChartData(title);
                    ChartRenderer.createBarChart(placeholder, data, {
                        onClick: (item) => showChartDetails(item.label)
                    });
                }
            });
        }

        function generateTimeSeriesData() {
            const data = [];
            const now = new Date();
            
            for (let i = 0; i < 24; i++) {
                const date = new Date(now.getTime() - (23 - i) * 60 * 60 * 1000);
                const baseValue = 15 + Math.sin(i * Math.PI / 12) * 10;
                const randomVariation = (Math.random() - 0.5) * 5;
                const value = Math.max(0, Math.min(100, baseValue + randomVariation));
                
                data.push({
                    label: date.getHours() + ':00',
                    value: Math.round(value * 10) / 10,
                    timestamp: date
                });
            }
            
            return data;
        }

        function generateHealthDistributionData() {
            return [
                { label: 'Excellent', value: 15, color: '#28a745' },
                { label: 'Good', value: 6, color: '#ffc107' },
                { label: 'Fair', value: 2, color: '#fd7e14' },
                { label: 'Poor', value: 1, color: '#dc3545' }
            ];
        }

        function generatePerformanceData() {
            return [
                { label: 'Accuracy', value: 87.3, color: '#28a745' },
                { label: 'Precision', value: 91.2, color: '#007bff' },
                { label: 'Recall', value: 84.7, color: '#17a2b8' },
                { label: 'F1-Score', value: 87.9, color: '#6f42c1' }
            ];
        }

        function generateDefaultChartData(title) {
            const categories = ['TXF', 'PWL', 'CBR', 'SUB', 'SWC'];
            return categories.map((cat, index) => ({
                label: cat,
                value: Math.floor(Math.random() * 50) + 30,
                color: `hsl(${index * 72}, 70%, 50%)`
            }));
        }

        function createSystemGauges(container) {
            container.innerHTML = '';
            container.style.display = 'flex';
            container.style.justifyContent = 'space-around';
            container.style.alignItems = 'center';
            container.style.flexWrap = 'wrap';
            container.style.background = 'white';
            container.style.padding = '20px';
            container.style.borderRadius = '8px';
            
            const gauges = [
                { value: 99.7, label: 'Availability', color: '#28a745' },
                { value: 70, label: 'Efficiency', color: '#007bff' },
                { value: 75, label: 'Capacity', color: '#ffc107' }
            ];
            
            gauges.forEach(gauge => {
                const gaugeContainer = document.createElement('div');
                ChartRenderer.createGaugeChart(gaugeContainer, gauge.value, {
                    label: gauge.label,
                    color: gauge.color,
                    max: 100
                });
                container.appendChild(gaugeContainer);
            });
        }

        function updateChartsWithLiveData() {
            // Update Chart.js charts
            ChartRenderer.updateChartsWithLiveData();
            
            // Keep existing logic for SVG charts if any
            if (!window.liveDataSystem) return;
            
            const liveData = window.liveDataSystem.getLatestData();
            
            // Update health distribution
            const healthData = [
                { label: 'Excellent', value: liveData.assets.filter(a => a.currentHealth >= 80).length, color: '#28a745' },
                { label: 'Good', value: liveData.assets.filter(a => a.currentHealth >= 60 && a.currentHealth < 80).length, color: '#ffc107' },
                { label: 'Fair', value: liveData.assets.filter(a => a.currentHealth >= 40 && a.currentHealth < 60).length, color: '#fd7e14' },
                { label: 'Poor', value: liveData.assets.filter(a => a.currentHealth < 40).length, color: '#dc3545' }
            ];
            
            // Find and update doughnut charts
            document.querySelectorAll('.doughnut-chart-container').forEach(container => {
                ChartRenderer.createDoughnutChart(container, healthData, {
                    centerText: 'Assets',
                    onClick: (item) => showCategoryDetails(item.label)
                });
            });
            
            // Update gauge charts with live system metrics
            const systemMetrics = [
                { value: 99.7 - (liveData.alerts.filter(a => !a.acknowledged).length * 0.5), label: 'Availability', color: '#28a745' },
                { value: 85 - (liveData.assets.filter(a => a.currentHealth < 50).length * 5), label: 'Efficiency', color: '#007bff' },
                { value: Math.round(liveData.assets.reduce((sum, a) => sum + a.currentHealth, 0) / liveData.assets.length), label: 'Overall Health', color: '#ffc107' }
            ];
            
            document.querySelectorAll('.gauge-chart-container').forEach((container, index) => {
                if (systemMetrics[index]) {
                    ChartRenderer.createGaugeChart(container, systemMetrics[index].value, systemMetrics[index]);
                }
            });
        }

        // Enhanced initialization with Live Data System
        function initializeInteractiveFeatures() {
            initializeChartPlaceholders();
            addChartInteractivity();
            makeChartsInteractive();
            
            // Add hover effects to action cards
            document.querySelectorAll('.action-card').forEach(card => {
                card.addEventListener('click', function() {
                    // Remove active class from all cards
                    document.querySelectorAll('.action-card').forEach(c => c.classList.remove('active'));
                    // Add active class to clicked card
                    this.classList.add('active');
                });
            });
            
            // Enhanced progress bar animations
            document.querySelectorAll('.progress-fill').forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.transition = 'width 1.5s ease';
                    bar.style.width = width;
                }, 500);
            });

            // Make all chart containers clickable
            document.querySelectorAll('.chart-container').forEach(container => {
                container.style.cursor = 'pointer';
                container.addEventListener('click', function() {
                    const title = this.querySelector('h4')?.textContent || 'Chart Data';
                    showChartDetails(title);
                });
            });

            // Add interactive effects to stat cards
            document.querySelectorAll('.stat-card').forEach(card => {
                card.addEventListener('click', function() {
                    const number = this.querySelector('.stat-number').textContent;
                    const label = this.querySelector('.stat-label').textContent;
                    showStatDetails(label, number);
                });
            });

            // Initialize Live Data System Controls
            initializeLiveDataControls();
        }

        // Live Data System Controls
        function initializeLiveDataControls() {
            // Add live data controls to header
            const statusBar = document.querySelector('.status-bar');
            if (statusBar) {
                const controlsDiv = document.createElement('div');
                controlsDiv.style.cssText = 'display: flex; gap: 10px; align-items: center;';
                controlsDiv.innerHTML = `
                    <button id="start-live-btn" onclick="startLiveData()" 
                            style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-size: 0.9rem;">
                        🚀 Start Live Data
                    </button>
                    <button id="stop-live-btn" onclick="stopLiveData()" 
                            style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-size: 0.9rem; display: none;">
                        ⏹️ Stop Live Data
                    </button>
                    <div id="data-rate-display" style="color: white; font-size: 0.9rem; display: none;">
                        📊 Updates: <span id="update-counter">0</span>
                    </div>
                `;
                
                const refreshBtn = statusBar.querySelector('.refresh-btn');
                if (refreshBtn) {
                    statusBar.insertBefore(controlsDiv, refreshBtn);
                }
            }
        }

        // Live Data Control Functions
        function startLiveData() {
            liveDataSystem.start();
            
            document.getElementById('start-live-btn').style.display = 'none';
            document.getElementById('stop-live-btn').style.display = 'inline-block';
            document.getElementById('data-rate-display').style.display = 'block';
            
            // Update counter
            let updateCount = 0;
            window.liveUpdateCounter = setInterval(() => {
                updateCount++;
                const counterElement = document.getElementById('update-counter');
                if (counterElement) {
                    counterElement.textContent = updateCount;
                }
            }, 3000);
            
            // Show notification
            showLiveDataNotification('🚀 Live Data System Started', 'Real-time data generation and dashboard updates are now active!', '#28a745');
        }

        function stopLiveData() {
            liveDataSystem.stop();
            
            document.getElementById('start-live-btn').style.display = 'inline-block';
            document.getElementById('stop-live-btn').style.display = 'none';
            document.getElementById('data-rate-display').style.display = 'none';
            
            if (window.liveUpdateCounter) {
                clearInterval(window.liveUpdateCounter);
                window.liveUpdateCounter = null;
            }
            
            // Remove live indicator
            const indicator = document.querySelector('.live-indicator');
            if (indicator) {
                indicator.remove();
            }
            
            // Show notification
            showLiveDataNotification('⏹️ Live Data System Stopped', 'Dashboard is now using static data simulation.', '#dc3545');
        }

        // Live Data Notification
        function showLiveDataNotification(title, message, color) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: ${color};
                color: white;
                padding: 20px;
                border-radius: 12px;
                box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 350px;
                animation: slideIn 0.3s ease;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                    <div>
                        <strong style="font-size: 1.1rem;">${title}</strong>
                        <div style="font-size: 0.9rem; opacity: 0.9; margin-top: 3px;">${message}</div>
                    </div>
                    <span onclick="this.parentElement.parentElement.remove()" 
                          style="cursor: pointer; font-size: 1.5rem; margin-left: 15px; opacity: 0.8;">✕</span>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 8px; border-radius: 4px; font-size: 0.8rem;">
                    System Status: ${liveDataSystem.isRunning ? 'ACTIVE' : 'STOPPED'} | 
                    Data Points: ${liveDataSystem.sensors?.length || 0} sensors | 
                    Assets: ${liveDataSystem.assets?.length || 0}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 5000);
        }

        // Enhanced refresh function for live data
        function refreshData() {
            if (liveDataSystem.isRunning) {
                console.log('🔄 Manual refresh requested - Live data system is active');
                liveDataSystem.updateDashboard();
                showLiveDataNotification('🔄 Data Refreshed', 'Dashboard updated with latest live data.', '#007bff');
            } else {
                console.log('🔄 Manual refresh - Using static simulation');
                simulateRealTimeUpdates();
                updateTime();
            }
        }

        // Show chart details
        function showChartDetails(title) {
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 25px;
                border-radius: 15px;
                box-shadow: 0 15px 40px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 450px;
                width: 90%;
                border-left: 4px solid #007bff;
                animation: popupSlideIn 0.3s ease;
            `;
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; color: #007bff;">📊 ${title}</h3>
                    <span onclick="this.parentNode.parentNode.remove()" 
                          style="cursor: pointer; font-size: 1.8rem; color: #666;">&times;</span>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="margin: 0 0 10px 0;">Chart Interaction Features:</h4>
                    <ul style="margin-left: 20px; margin: 10px 0;">
                        <li>Click on data points for detailed information</li>
                        <li>Hover for real-time tooltips</li>
                        <li>Export data in multiple formats</li>
                        <li>Real-time updates every 30 seconds</li>
                    </ul>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="exportData('chart-data', 'CSV')" 
                            style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                        📊 Export Data
                    </button>
                    <button onclick="this.parentNode.parentNode.remove()" 
                            style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                        Close
                    </button>
                </div>
            `;
            
            document.body.appendChild(popup);
        }

        // Show stat details
        function showStatDetails(label, number) {
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 25px;
                border-radius: 15px;
                box-shadow: 0 15px 40px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 400px;
                width: 90%;
                border-left: 4px solid #007bff;
                animation: popupSlideIn 0.3s ease;
            `;
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; color: #007bff;">📈 ${label}</h3>
                    <span onclick="this.parentNode.parentNode.remove()" 
                          style="cursor: pointer; font-size: 1.8rem; color: #666;">&times;</span>
                </div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 3rem; font-weight: bold; color: #007bff;">${number}</div>
                    <div style="color: #666; margin-top: 5px;">Current Count</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0;">Trend Analysis:</h4>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>Last Hour:</span><span style="color: #28a745;">+2</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>Today:</span><span style="color: #28a745;">+${Math.floor(parseInt(number) * 0.15)}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>This Week:</span><span style="color: #ffc107;">-${Math.floor(parseInt(number) * 0.08)}</span>
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
        }

        // Enhanced chart interactivity - removed redundant tab functionality
        function makeChartsInteractive() {
            // Add click handlers to all chart elements
            document.querySelectorAll('.chart-placeholder').forEach(chart => {
                chart.addEventListener('click', function() {
                    this.style.cursor = 'pointer';
                    this.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                });
            });
        }

        // Enhanced export functionality for reports with REAL file downloads
        function exportReport(format, reportType) {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.textContent = 'Generating...';
            btn.disabled = true;
            btn.style.background = '#6c757d';
            
            // Show realistic progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += 25;
                btn.textContent = `Generating... ${progress}%`;
                if (progress >= 100) {
                    clearInterval(progressInterval);
                }
            }, 300);
            
            setTimeout(() => {
                clearInterval(progressInterval);
                btn.textContent = 'Downloading...';
                
                // Generate report data
                const reportData = generateReportData(reportType);
                const fileName = `${reportType.toLowerCase().replace(/ /g, '_')}_${new Date().toISOString().slice(0,10)}.${format.toLowerCase()}`;
                
                // Download the actual file
                downloadFile(reportData, fileName, format);
                
                btn.textContent = '✅ Complete';
                btn.style.background = '#28a745';
                console.log(`📊 ${reportType} exported as ${format}`);
                showDownloadNotification(fileName, format);
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                    btn.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
                }, 2000);
            }, 1200);
        }

        // Generate report data based on report type
        function generateReportData(reportType) {
            const timestamp = new Date().toISOString();
            
            return {
                exportDate: timestamp,
                reportType: reportType,
                generatedBy: 'Transmission Utility AI Agent',
                summary: {
                    totalAssets: 24,
                    criticalAssets: 3,
                    activeAlerts: 7,
                    pendingWorkOrders: 12,
                    systemAvailability: 99.7,
                    overallHealthScore: 73.2
                },
                detailedData: [
                    { category: 'Asset Performance', metrics: ['Health Score: 73.2%', 'Availability: 99.7%', 'Efficiency: 87.3%'] },
                    { category: 'Maintenance Status', metrics: ['Preventive: 78%', 'Reactive: 22%', 'Overdue: 2%'] },
                    { category: 'Risk Assessment', metrics: ['High Risk: 3 assets', 'Medium Risk: 6 assets', 'Low Risk: 15 assets'] },
                    { category: 'Team Performance', metrics: ['Alpha Team: 95% completion', 'Bravo Team: 88% completion', 'Charlie Team: 92% completion'] }
                ],
                recommendations: [
                    'Immediate attention required for TXF-001 due to high temperature readings',
                    'Schedule preventive maintenance for PWL-001 within 2 weeks',
                    'Consider load balancing for CBR-001 to reduce wear',
                    'Review transformer cooling systems before summer peak season'
                ],
                nextActions: [
                    'Emergency inspection scheduled for TXF-001',
                    'Maintenance window planned for next weekend',
                    'Team training scheduled for new equipment',
                    'Quarterly review meeting with management'
                ]
            };
        }

        // Enhanced system initialization with Live Data Integration
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all interactive features
            initializeInteractiveFeatures();
            
            // Add enhanced click effects to cards
            document.querySelectorAll('.stat-card, .feature-card, .asset-item, .alert-item, .work-order-item').forEach(card => {
                card.style.cursor = 'pointer';
                card.addEventListener('click', function() {
                    this.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                });
            });
            
            // Add click handlers to export buttons with enhanced feedback
            document.querySelectorAll('button').forEach(button => {
                if (button.textContent.includes('PDF') || button.textContent.includes('Excel') || 
                    button.textContent.includes('CSV') || button.textContent.includes('JSON')) {
                    button.addEventListener('click', function() {
                        if (this.classList.contains('export-button')) {
                            // This is handled by the exportData function
                            return;
                        }
                        exportReport(this.textContent.split(' ')[0], 'Report');
                    });
                }
            });

            // Make alert badges clickable
            document.querySelectorAll('.alert-badge, .priority-badge').forEach(badge => {
                badge.style.cursor = 'pointer';
                badge.addEventListener('click', function() {
                    const badgeType = this.textContent;
                    showBadgeDetails(badgeType);
                });
            });

            // Animate elements on page load
            setTimeout(() => {
                animateCharts();
                
                // Animate stat cards
                document.querySelectorAll('.stat-card').forEach((card, index) => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        card.style.transition = 'all 0.5s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, index * 100);
                });
            }, 500);
            
            // Initialize time updates immediately and every second
            console.log('🕐 Initializing clock system...');
            updateTime(); // Update immediately
            const timeInterval = setInterval(updateTime, 1000); // Update every second
            console.log('✅ Clock system running - updates every second');
            
            // Initialize all charts
            setTimeout(() => {
                console.log('📊 Initializing all charts...');
                ChartRenderer.initializeAllCharts();
            }, 1000);
            
            // Auto-start live data system after 2 seconds
            setTimeout(() => {
                console.log('🚀 Auto-starting Live Data System...');
                startLiveData();
            }, 2000);
            
            console.log('🚀 Dashboard System Fully Initialized with Live Data Capabilities!');
        });

        // Show badge details
        function showBadgeDetails(badgeType) {
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 2000;
                max-width: 350px;
                border-left: 4px solid #007bff;
                animation: popupSlideIn 0.3s ease;
            `;
            
            const badgeInfo = {
                'Critical': { count: 3, description: 'Immediate attention required', color: '#dc3545' },
                'Warning': { count: 7, description: 'Monitor closely', color: '#ffc107' },
                'Info': { count: 12, description: 'General information', color: '#17a2b8' },
                'Emergency': { count: 1, description: 'Emergency response needed', color: '#dc3545' },
                'High': { count: 2, description: 'High priority tasks', color: '#ffc107' },
                'Medium': { count: 8, description: 'Standard priority', color: '#6c757d' }
            };
            
            const info = badgeInfo[badgeType] || { count: 0, description: 'Unknown', color: '#666' };
            
            popup.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: ${info.color};">🏷️ ${badgeType} Items</h3>
                    <span onclick="this.parentNode.parentNode.remove()" 
                          style="cursor: pointer; font-size: 1.5rem; color: #666;">&times;</span>
                </div>
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 2.5rem; font-weight: bold; color: ${info.color};">${info.count}</div>
                    <div style="color: #666;">Total ${badgeType} Items</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <p style="margin: 0; color: #333;">${info.description}</p>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Click on individual items to view detailed information and take action.
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
        }

        console.log('🚀 Transmission Utility AI Agent Dashboard Fully Loaded & Interactive!');
        console.log('');
        console.log('🎯 Enhanced Interactive Features:');
        console.log('  • 🤖 Decision Support & Automation - Smart recommendations with auto-actions');
        console.log('  • 🔮 Predictive Analytics - ML models with 87.3% accuracy');
        console.log('  • 👥 Team Management - Intelligent assignment and performance tracking');
        console.log('  • 📈 Performance Analytics - Comprehensive KPIs and trend analysis');
        console.log('  • 🔍 Data Analysis & Monitoring - Real-time health scoring and pattern detection');
        console.log('  • 📊 Visualization & Alerts - Interactive charts with drill-down capabilities');
        console.log('');
        console.log('�️ Interactive Elements:');
        console.log('  • All charts are clickable with detailed popups');
        console.log('  • Asset cards show comprehensive health information');
        console.log('  • Export buttons with progress indicators and notifications');
        console.log('  • Real-time data simulation with 30-second updates');
        console.log('  • Alert badges provide filtered item counts');
        console.log('');
        console.log('💾 Export Features:');
        console.log('  • PDF, Excel, CSV, and JSON formats supported');
        console.log('  • Progress tracking with visual feedback');
        console.log('  • Automatic download notifications');
        console.log('');
        console.log('🔄 Real-Time Features:');
        console.log('  • Live health score updates');
        console.log('  • Dynamic alert generation');
        console.log('  • Automatic data refresh every 30 seconds');
        console.log('');
        console.log('🔗 Integration Ready:');
        console.log('  • Backend API: http://localhost:8000/docs');
        console.log('  • Start server: python backend/main.py');
        console.log('  • All features work with simulated data for demonstration');
        console.log('');
        console.log('✨ No Redundancy - All features are unique and functional!');
        
        // Additional Live System Status
        console.log('');
        console.log('🔴🟡🟢 LIVE DATA SYSTEM STATUS 🟢🟡🔴');
        console.log('⚡ System will auto-start in 2 seconds');
        console.log('🎛️ Manual controls available in header');
        console.log('📡 Live indicator shows real-time status');
        console.log('🔄 Data generation: 5-second cycles');
        console.log('📊 Dashboard updates: 3-second cycles');
        console.log('🚨 Alert thresholds: Monitored continuously');
        console.log('💾 Export data: Includes live readings');

        // Excel Database Integration System
        class ExcelDatabaseManager {
            constructor() {
                this.databases = {
                    assets: null,
                    workforce: null,
                    maintenance: null,
                    sensors: null,
                    performance: null,
                    financial: null,
                    compliance: null
                };
                this.lastSync = null;
                this.syncInterval = 30000; // 30 seconds
                this.isConnected = false;
                this.initializeDatabases();
            }

            async initializeDatabases() {
                console.log('🔄 Initializing Excel Database Integration...');
                
                // Simulate loading from Excel files
                this.databases.assets = await this.loadAssetDatabase();
                this.databases.workforce = await this.loadWorkforceDatabase();
                this.databases.maintenance = await this.loadMaintenanceDatabase();
                this.databases.sensors = await this.loadSensorDatabase();
                this.databases.performance = await this.loadPerformanceDatabase();
                this.databases.financial = await this.loadFinancialDatabase();
                this.databases.compliance = await this.loadComplianceDatabase();
                
                this.isConnected = true;
                this.lastSync = new Date();
                
                console.log('✅ All Excel databases loaded successfully');
                console.log(`📊 Total Records: ${this.getTotalRecords()}`);
                
                // Start real-time sync
                this.startRealTimeSync();
            }

            async loadAssetDatabase() {
                // Simulate Excel file: "Assets_Master_Database.xlsx"
                console.log('📂 Loading Assets_Master_Database.xlsx...');
                return {
                    fileName: 'Assets_Master_Database.xlsx',
                    lastModified: new Date('2025-08-07T10:30:00'),
                    sheets: {
                        'Asset_Master': await this.createAssetMasterData(),
                        'Technical_Specs': await this.createTechnicalSpecsData(),
                        'Location_Details': await this.createLocationData(),
                        'Manufacturer_Info': await this.createManufacturerData()
                    },
                    totalRecords: 47,
                    lastSync: new Date()
                };
            }

            async loadWorkforceDatabase() {
                // Simulate Excel file: "Workforce_Management.xlsx"
                console.log('📂 Loading Workforce_Management.xlsx...');
                return {
                    fileName: 'Workforce_Management.xlsx',
                    lastModified: new Date('2025-08-07T09:45:00'),
                    sheets: {
                        'Employee_Master': await this.createEmployeeMasterData(),
                        'Team_Assignments': await this.createTeamAssignmentData(),
                        'Skills_Matrix': await this.createSkillsMatrixData(),
                        'Training_Records': await this.createTrainingRecordsData(),
                        'Shift_Schedules': await this.createShiftScheduleData(),
                        'Performance_Metrics': await this.createWorkforcePerformanceData()
                    },
                    totalRecords: 156,
                    lastSync: new Date()
                };
            }

            async loadMaintenanceDatabase() {
                // Simulate Excel file: "Maintenance_Operations.xlsx"
                console.log('📂 Loading Maintenance_Operations.xlsx...');
                return {
                    fileName: 'Maintenance_Operations.xlsx',
                    lastModified: new Date('2025-08-07T08:20:00'),
                    sheets: {
                        'Work_Orders': await this.createWorkOrdersData(),
                        'Maintenance_Schedule': await this.createMaintenanceScheduleData(),
                        'Spare_Parts_Inventory': await this.createSparePartsData(),
                        'Service_History': await this.createServiceHistoryData(),
                        'Vendor_Contracts': await this.createVendorContractsData()
                    },
                    totalRecords: 342,
                    lastSync: new Date()
                };
            }

            async loadSensorDatabase() {
                // Simulate Excel file: "Sensor_Telemetry.xlsx"
                console.log('📂 Loading Sensor_Telemetry.xlsx...');
                return {
                    fileName: 'Sensor_Telemetry.xlsx',
                    lastModified: new Date('2025-08-07T11:15:00'),
                    sheets: {
                        'Sensor_Master': await this.createSensorMasterData(),
                        'Real_Time_Readings': await this.createRealTimeReadingsData(),
                        'Threshold_Configurations': await this.createThresholdConfigData(),
                        'Alert_History': await this.createAlertHistoryData(),
                        'Calibration_Records': await this.createCalibrationRecordsData()
                    },
                    totalRecords: 1247,
                    lastSync: new Date()
                };
            }

            async loadPerformanceDatabase() {
                // Simulate Excel file: "Performance_Analytics.xlsx"
                console.log('📂 Loading Performance_Analytics.xlsx...');
                return {
                    fileName: 'Performance_Analytics.xlsx',
                    lastModified: new Date('2025-08-07T10:45:00'),
                    sheets: {
                        'KPI_Metrics': await this.createKPIMetricsData(),
                        'Reliability_Index': await this.createReliabilityIndexData(),
                        'Efficiency_Metrics': await this.createEfficiencyMetricsData(),
                        'Downtime_Analysis': await this.createDowntimeAnalysisData(),
                        'Cost_Performance': await this.createCostPerformanceData()
                    },
                    totalRecords: 2156,
                    lastSync: new Date()
                };
            }

            async loadFinancialDatabase() {
                // Simulate Excel file: "Financial_Management.xlsx"
                console.log('📂 Loading Financial_Management.xlsx...');
                return {
                    fileName: 'Financial_Management.xlsx',
                    lastModified: new Date('2025-08-07T09:30:00'),
                    sheets: {
                        'Budget_Allocation': await this.createBudgetAllocationData(),
                        'Cost_Centers': await this.createCostCentersData(),
                        'Procurement_Records': await this.createProcurementRecordsData(),
                        'ROI_Analysis': await this.createROIAnalysisData(),
                        'Financial_KPIs': await this.createFinancialKPIsData()
                    },
                    totalRecords: 892,
                    lastSync: new Date()
                };
            }

            async loadComplianceDatabase() {
                // Simulate Excel file: "Compliance_Regulatory.xlsx"
                console.log('📂 Loading Compliance_Regulatory.xlsx...');
                return {
                    fileName: 'Compliance_Regulatory.xlsx',
                    lastModified: new Date('2025-08-07T08:00:00'),
                    sheets: {
                        'Regulatory_Requirements': await this.createRegulatoryRequirementsData(),
                        'Audit_Records': await this.createAuditRecordsData(),
                        'Safety_Incidents': await this.createSafetyIncidentsData(),
                        'Environmental_Metrics': await this.createEnvironmentalMetricsData(),
                        'Certification_Status': await this.createCertificationStatusData()
                    },
                    totalRecords: 578,
                    lastSync: new Date()
                };
            }

            startRealTimeSync() {
                console.log('🔄 Starting real-time database synchronization...');
                setInterval(async () => {
                    await this.syncAllDatabases();
                }, this.syncInterval);
            }

            async syncAllDatabases() {
                if (!this.isConnected) return;
                
                console.log('🔄 Syncing all databases...');
                
                // Simulate real-time data updates
                await this.updateRealTimeReadings();
                await this.updateWorkforceStatus();
                await this.updateMaintenanceProgress();
                await this.updatePerformanceMetrics();
                
                this.lastSync = new Date();
                console.log(`✅ Database sync completed at ${this.lastSync.toISOString()}`);
            }

            getTotalRecords() {
                return Object.values(this.databases)
                    .filter(db => db)
                    .reduce((total, db) => total + db.totalRecords, 0);
            }

            // Create detailed asset master data simulating Excel
            async createAssetMasterData() {
                const assetTypes = ['Transformer', 'Transmission Line', 'Distribution Line', 'Circuit Breaker', 'Switch', 'Substation', 'Capacitor Bank', 'Reactor', 'Protection Relay', 'Current Transformer', 'Voltage Transformer', 'RTU', 'Power Quality Monitor'];
                const manufacturers = ['ABB', 'Siemens', 'GE', 'Schneider', 'SEL', 'Fluke', 'Dranetz'];
                const locations = ['Central Substation', 'North Substation', 'East Substation', 'West Substation', 'South Substation', 'Commercial District', 'Industrial District', 'Downtown District', 'Residential District', 'Rural District'];
                
                const data = [];
                for (let i = 1; i <= 47; i++) {
                    const assetType = assetTypes[Math.floor(Math.random() * assetTypes.length)];
                    const manufacturer = manufacturers[Math.floor(Math.random() * manufacturers.length)];
                    const location = locations[Math.floor(Math.random() * locations.length)];
                    const installYear = 2014 + Math.floor(Math.random() * 11); // 2014-2024
                    const health = 60 + Math.random() * 40; // 60-100
                    
                    data.push({
                        Asset_ID: `AST-${String(i).padStart(3, '0')}`,
                        Asset_Name: `${assetType} Unit ${i}`,
                        Asset_Type: assetType,
                        Manufacturer: manufacturer,
                        Model_Number: `${manufacturer}-${Math.floor(Math.random() * 9999)}`,
                        Serial_Number: `SN${Math.floor(Math.random() * 1000000)}`,
                        Installation_Date: `${installYear}-${String(Math.floor(Math.random() * 12) + 1).padStart(2, '0')}-${String(Math.floor(Math.random() * 28) + 1).padStart(2, '0')}`,
                        Location: location,
                        Status: health > 80 ? 'Active' : health > 60 ? 'Monitoring' : 'Maintenance Required',
                        Health_Score: Math.round(health),
                        Criticality: health < 70 ? 'High' : health < 85 ? 'Medium' : 'Low',
                        Warranty_Expiry: `${installYear + 5}-${String(Math.floor(Math.random() * 12) + 1).padStart(2, '0')}-${String(Math.floor(Math.random() * 28) + 1).padStart(2, '0')}`,
                        Last_Maintenance: `2025-${String(Math.floor(Math.random() * 8) + 1).padStart(2, '0')}-${String(Math.floor(Math.random() * 28) + 1).padStart(2, '0')}`,
                        Next_Maintenance: `2025-${String(Math.floor(Math.random() * 4) + 9).padStart(2, '0')}-${String(Math.floor(Math.random() * 28) + 1).padStart(2, '0')}`,
                        Cost_Center: `CC-${Math.floor(Math.random() * 20) + 1001}`,
                        Responsible_Team: ['Alpha Team', 'Bravo Team', 'Charlie Team', 'Delta Team', 'Echo Team'][Math.floor(Math.random() * 5)],
                        Created_Date: new Date().toISOString(),
                        Last_Updated: new Date().toISOString()
                    });
                }
                return data;
            }

            async createEmployeeMasterData() {
                const roles = ['Senior Technician', 'Electrical Engineer', 'Maintenance Supervisor', 'Field Operator', 'Protection Engineer', 'SCADA Specialist', 'Safety Officer', 'Team Lead'];
                const teams = ['Alpha Team', 'Bravo Team', 'Charlie Team', 'Delta Team', 'Echo Team', 'Foxtrot Team', 'Golf Team', 'Hotel Team'];
                const shifts = ['Day Shift (6AM-2PM)', 'Evening Shift (2PM-10PM)', 'Night Shift (10PM-6AM)', 'Rotating Shift'];
                const certifications = ['IEEE Certified', 'NETA Certified', 'Arc Flash Trained', 'Confined Space', 'First Aid/CPR', 'Crane Operations'];
                
                const data = [];
                for (let i = 1; i <= 156; i++) {
                    const role = roles[Math.floor(Math.random() * roles.length)];
                    const team = teams[Math.floor(Math.random() * teams.length)];
                    const shift = shifts[Math.floor(Math.random() * shifts.length)];
                    const experience = Math.floor(Math.random() * 25) + 1; // 1-25 years
                    const performance = 65 + Math.random() * 35; // 65-100
                    
                    data.push({
                        Employee_ID: `EMP-${String(i).padStart(4, '0')}`,
                        Full_Name: `Employee ${i}`,
                        Role: role,
                        Team: team,
                        Shift: shift,
                        Experience_Years: experience,
                        Skill_Level: experience < 5 ? 'Junior' : experience < 15 ? 'Senior' : 'Expert',
                        Performance_Rating: Math.round(performance),
                        Certifications: certifications.slice(0, Math.floor(Math.random() * 4) + 1).join(', '),
                        Hourly_Rate: `$${(25 + Math.random() * 35).toFixed(2)}`,
                        Status: Math.random() > 0.1 ? 'Active' : 'On Leave',
                        Hire_Date: `${2020 + Math.floor(Math.random() * 5)}-${String(Math.floor(Math.random() * 12) + 1).padStart(2, '0')}-${String(Math.floor(Math.random() * 28) + 1).padStart(2, '0')}`,
                        Location_Assigned: ['Central Substation', 'North Substation', 'East Substation', 'West Substation', 'South Substation', 'Mobile Unit'][Math.floor(Math.random() * 6)],
                        Emergency_Contact: `+91-${Math.floor(Math.random() * 9000000000) + 1000000000}`,
                        Training_Hours_YTD: Math.floor(Math.random() * 80) + 20,
                        Safety_Record: Math.random() > 0.2 ? 'Clean' : 'Minor Incidents',
                        Last_Updated: new Date().toISOString()
                    });
                }
                return data;
            }

            async updateRealTimeReadings() {
                // Simulate real-time sensor data updates
                const sensors = this.databases.sensors?.sheets?.Real_Time_Readings;
                if (sensors) {
                    sensors.forEach(sensor => {
                        const variation = (Math.random() - 0.5) * 0.1; // ±5% variation
                        sensor.Current_Value = sensor.Current_Value * (1 + variation);
                        sensor.Last_Reading = new Date().toISOString();
                        sensor.Status = sensor.Current_Value > sensor.Threshold ? 'Alert' : 'Normal';
                    });
                }
            }

            async updateWorkforceStatus() {
                // Simulate workforce real-time updates
                const employees = this.databases.workforce?.sheets?.Employee_Master;
                if (employees) {
                    employees.forEach(emp => {
                        // Randomly update status
                        if (Math.random() < 0.05) { // 5% chance of status change
                            emp.Status = emp.Status === 'Active' ? 'Busy' : 'Active';
                        }
                        emp.Last_Updated = new Date().toISOString();
                    });
                }
            }

            async updateMaintenanceProgress() {
                // Simulate maintenance progress updates
                const workOrders = this.databases.maintenance?.sheets?.Work_Orders;
                if (workOrders) {
                    workOrders.forEach(wo => {
                        if (wo.Status === 'In Progress' && Math.random() < 0.1) {
                            wo.Progress_Percentage = Math.min(100, wo.Progress_Percentage + Math.floor(Math.random() * 15));
                            if (wo.Progress_Percentage >= 100) {
                                wo.Status = 'Completed';
                                wo.Completion_Date = new Date().toISOString();
                            }
                        }
                    });
                }
            }

            async updatePerformanceMetrics() {
                // Simulate performance metrics updates
                const kpis = this.databases.performance?.sheets?.KPI_Metrics;
                if (kpis) {
                    kpis.forEach(kpi => {
                        const variation = (Math.random() - 0.5) * 0.02; // ±1% variation
                        kpi.Current_Value = Math.max(0, kpi.Current_Value * (1 + variation));
                        kpi.Last_Updated = new Date().toISOString();
                        kpi.Trend = variation > 0 ? 'Improving' : 'Declining';
                    });
                }
            }

            // Method to get live data for dashboard
            getLiveAssetData() {
                return this.databases.assets?.sheets?.Asset_Master || [];
            }

            getLiveWorkforceData() {
                return this.databases.workforce?.sheets?.Employee_Master || [];
            }

            getLiveSensorData() {
                return this.databases.sensors?.sheets?.Real_Time_Readings || [];
            }

            getConnectionStatus() {
                return {
                    isConnected: this.isConnected,
                    lastSync: this.lastSync,
                    totalRecords: this.getTotalRecords(),
                    databases: Object.keys(this.databases).map(key => ({
                        name: key,
                        fileName: this.databases[key]?.fileName,
                        records: this.databases[key]?.totalRecords,
                        lastModified: this.databases[key]?.lastModified
                    }))
                };
            }
        }

        // Asset Database Management
        class AssetDatabase {
            constructor() {
                this.puneLocations = {
                    'Central Substation': { lat: 18.5204, lng: 73.8567, address: 'Shivajinagar, Pune' },
                    'North Substation': { lat: 18.6298, lng: 73.7997, address: 'Pimpri-Chinchwad, Pune' },
                    'East Substation': { lat: 18.5314, lng: 73.9356, address: 'Hadapsar, Pune' },
                    'West Substation': { lat: 18.4649, lng: 73.8003, address: 'Warje, Pune' },
                    'South Substation': { lat: 18.4386, lng: 73.8370, address: 'Bibwewadi, Pune' },
                    'Northern Corridor': { lat: 18.6000, lng: 73.8200, address: 'Akurdi-Bhosari Corridor' },
                    'Eastern Corridor': { lat: 18.5500, lng: 73.9200, address: 'Mundhwa-Kharadi Corridor' },
                    'Western Corridor': { lat: 18.4800, lng: 73.7800, address: 'Baner-Bavdhan Corridor' },
                    'Southern Corridor': { lat: 18.4200, lng: 73.8500, address: 'Katraj-Kondhwa Corridor' },
                    'Downtown District': { lat: 18.5196, lng: 73.8553, address: 'Camp Area, Pune' },
                    'Industrial District': { lat: 18.6161, lng: 73.7286, address: 'Chakan Industrial Area' },
                    'Commercial District': { lat: 18.5579, lng: 73.7904, address: 'Hinjewadi IT Park' },
                    'Residential District': { lat: 18.5434, lng: 73.7972, address: 'Aundh-Baner, Pune' },
                    'Rural District': { lat: 18.4088, lng: 73.9474, address: 'Saswad Rural Area' },
                    'Distribution Network': { lat: 18.5074, lng: 73.8077, address: 'Deccan Gymkhana' },
                    'Mobile Unit': { lat: 18.5285, lng: 73.8611, address: 'Yerwada Depot' },
                    'Central Control Center': { lat: 18.5158, lng: 73.8567, address: 'Control Room, Shivajinagar' },
                    'Control Center': { lat: 18.5158, lng: 73.8567, address: 'Main Control Center' }
                };
                this.allAssets = [];
                this.filteredAssets = [];
                this.initializeAssetDatabase();
            }

            initializeAssetDatabase() {
                if (window.liveDataSystem && window.liveDataSystem.assets && window.liveDataSystem.assets.length > 0) {
                    this.allAssets = window.liveDataSystem.assets.map(asset => this.enhanceAssetData(asset));
                } else {
                    // Create realistic asset data if live system not available
                    this.allAssets = this.createRealisticAssetData();
                }
                this.filteredAssets = [...this.allAssets];
                console.log(`Asset Database initialized with ${this.allAssets.length} assets`);
            }

            createRealisticAssetData() {
                return [
                    // Power Transformers
                    { id: 'TXF-001', name: 'Main Power Transformer #1', type: 'Transformer', baseHealth: 75, healthTrend: -0.1, location: 'Central Substation', voltage: '345/138kV', capacity: '300MVA', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'TXF-002', name: 'Distribution Transformer #2', type: 'Transformer', baseHealth: 82, healthTrend: 0.05, location: 'North Substation', voltage: '138/69kV', capacity: '150MVA', manufacturer: 'Siemens', installDate: '2020' },
                    { id: 'TXF-003', name: 'Step-Up Transformer #3', type: 'Transformer', baseHealth: 88, healthTrend: 0.02, location: 'East Substation', voltage: '69/345kV', capacity: '200MVA', manufacturer: 'GE', installDate: '2019' },
                    { id: 'TXF-004', name: 'Auto Transformer #4', type: 'Transformer', baseHealth: 91, healthTrend: 0.03, location: 'West Substation', voltage: '345/230kV', capacity: '400MVA', manufacturer: 'ABB', installDate: '2021' },
                    { id: 'TXF-005', name: 'Distribution Transformer #5', type: 'Transformer', baseHealth: 67, healthTrend: -0.08, location: 'South Substation', voltage: '138/34.5kV', capacity: '75MVA', manufacturer: 'Schneider', installDate: '2016' },
                    { id: 'TXF-006', name: 'Mobile Emergency Transformer', type: 'Transformer', baseHealth: 85, healthTrend: 0.01, location: 'Mobile Unit', voltage: '138/69kV', capacity: '100MVA', manufacturer: 'GE', installDate: '2022' },

                    // Transmission Lines
                    { id: 'TL-001', name: 'Transmission Line Alpha-Beta', type: 'Transmission Line', baseHealth: 68, healthTrend: -0.05, location: 'Northern Corridor', voltage: '345kV', length: '45mi', conductor: 'ACSR', installDate: '2015' },
                    { id: 'TL-002', name: 'Transmission Line Charlie-Delta', type: 'Transmission Line', baseHealth: 85, healthTrend: 0.02, location: 'Eastern Corridor', voltage: '230kV', length: '28mi', conductor: 'ACCC', installDate: '2019' },
                    { id: 'TL-003', name: 'Transmission Line Echo-Foxtrot', type: 'Transmission Line', baseHealth: 92, healthTrend: 0.04, location: 'Western Corridor', voltage: '138kV', length: '22mi', conductor: 'ACSR', installDate: '2020' },
                    { id: 'TL-004', name: 'Transmission Line Golf-Hotel', type: 'Transmission Line', baseHealth: 74, healthTrend: -0.03, location: 'Southern Corridor', voltage: '345kV', length: '67mi', conductor: 'ACSR', installDate: '2014' },

                    // Distribution Lines
                    { id: 'DL-001', name: 'Distribution Feeder #1', type: 'Distribution Line', baseHealth: 81, healthTrend: 0.01, location: 'Downtown District', voltage: '34.5kV', length: '8mi', conductor: 'ACSR', installDate: '2018' },
                    { id: 'DL-002', name: 'Distribution Feeder #2', type: 'Distribution Line', baseHealth: 77, healthTrend: -0.02, location: 'Industrial District', voltage: '34.5kV', length: '12mi', conductor: 'ACSR', installDate: '2017' },
                    { id: 'DL-003', name: 'Distribution Feeder #3', type: 'Distribution Line', baseHealth: 89, healthTrend: 0.03, location: 'Residential District', voltage: '13.8kV', length: '6mi', conductor: 'ACSR', installDate: '2021' },
                    { id: 'DL-004', name: 'Distribution Feeder #4', type: 'Distribution Line', baseHealth: 84, healthTrend: 0.02, location: 'Commercial District', voltage: '34.5kV', length: '10mi', conductor: 'ACCC', installDate: '2020' },

                    // Circuit Breakers
                    { id: 'CBR-001', name: 'Circuit Breaker Bay 1A', type: 'Circuit Breaker', baseHealth: 78, healthTrend: 0.1, location: 'Central Substation', voltage: '345kV', current: '4000A', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'CBR-002', name: 'Circuit Breaker Bay 2A', type: 'Circuit Breaker', baseHealth: 92, healthTrend: -0.02, location: 'North Substation', voltage: '138kV', current: '3000A', manufacturer: 'Siemens', installDate: '2020' },
                    { id: 'CBR-003', name: 'Circuit Breaker Bay 3A', type: 'Circuit Breaker', baseHealth: 86, healthTrend: 0.05, location: 'East Substation', voltage: '230kV', current: '3000A', manufacturer: 'GE', installDate: '2019' },
                    { id: 'CBR-004', name: 'Circuit Breaker Bay 4A', type: 'Circuit Breaker', baseHealth: 94, healthTrend: 0.01, location: 'West Substation', voltage: '345kV', current: '4000A', manufacturer: 'ABB', installDate: '2021' },
                    { id: 'CBR-005', name: 'Circuit Breaker Bay 1B', type: 'Circuit Breaker', baseHealth: 71, healthTrend: -0.06, location: 'Central Substation', voltage: '138kV', current: '2000A', manufacturer: 'Schneider', installDate: '2016' },
                    { id: 'CBR-006', name: 'Circuit Breaker Bay 2B', type: 'Circuit Breaker', baseHealth: 83, healthTrend: 0.03, location: 'South Substation', voltage: '69kV', current: '2000A', manufacturer: 'GE', installDate: '2019' },

                    // Disconnect Switches
                    { id: 'SW-001', name: 'Disconnect Switch DS-1A', type: 'Switch', baseHealth: 87, healthTrend: 0.02, location: 'Central Substation', voltage: '345kV', current: '4000A', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'SW-002', name: 'Disconnect Switch DS-2A', type: 'Switch', baseHealth: 79, healthTrend: -0.01, location: 'North Substation', voltage: '138kV', current: '3000A', manufacturer: 'Siemens', installDate: '2017' },
                    { id: 'SW-003', name: 'Disconnect Switch DS-3A', type: 'Switch', baseHealth: 91, healthTrend: 0.04, location: 'East Substation', voltage: '230kV', current: '3000A', manufacturer: 'GE', installDate: '2020' },
                    { id: 'SW-004', name: 'Load Break Switch LBS-1', type: 'Switch', baseHealth: 73, healthTrend: -0.04, location: 'Distribution Network', voltage: '34.5kV', current: '630A', manufacturer: 'Schneider', installDate: '2015' },
                    { id: 'SW-005', name: 'Motorized Switch MS-1', type: 'Switch', baseHealth: 88, healthTrend: 0.03, location: 'West Substation', voltage: '138kV', current: '2000A', manufacturer: 'ABB', installDate: '2019' },

                    // Substations
                    { id: 'SUB-001', name: 'Central Substation', type: 'Substation', baseHealth: 88, healthTrend: 0.03, location: 'Central Substation', voltage: '345/138/69kV', capacity: '600MVA', operator: 'Alpha Team', installDate: '2015' },
                    { id: 'SUB-002', name: 'North Substation', type: 'Substation', baseHealth: 91, healthTrend: 0.01, location: 'North Substation', voltage: '138/69/34.5kV', capacity: '400MVA', operator: 'Bravo Team', installDate: '2018' },
                    { id: 'SUB-003', name: 'East Substation', type: 'Substation', baseHealth: 93, healthTrend: 0.02, location: 'East Substation', voltage: '230/69/34.5kV', capacity: '350MVA', operator: 'Charlie Team', installDate: '2019' },
                    { id: 'SUB-004', name: 'West Substation', type: 'Substation', baseHealth: 89, healthTrend: 0.04, location: 'West Substation', voltage: '345/138kV', capacity: '500MVA', operator: 'Alpha Team', installDate: '2020' },
                    { id: 'SUB-005', name: 'South Substation', type: 'Substation', baseHealth: 76, healthTrend: -0.02, location: 'South Substation', voltage: '138/69/34.5kV', capacity: '200MVA', operator: 'Bravo Team', installDate: '2016' },

                    // Capacitor Banks
                    { id: 'CAP-001', name: 'Capacitor Bank #1', type: 'Capacitor Bank', baseHealth: 84, healthTrend: 0.01, location: 'Central Substation', voltage: '138kV', capacity: '50MVAR', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'CAP-002', name: 'Capacitor Bank #2', type: 'Capacitor Bank', baseHealth: 90, healthTrend: 0.02, location: 'North Substation', voltage: '69kV', capacity: '25MVAR', manufacturer: 'Siemens', installDate: '2020' },
                    { id: 'CAP-003', name: 'Capacitor Bank #3', type: 'Capacitor Bank', baseHealth: 87, healthTrend: 0.03, location: 'East Substation', voltage: '138kV', capacity: '40MVAR', manufacturer: 'GE', installDate: '2019' },

                    // Reactors
                    { id: 'REA-001', name: 'Shunt Reactor #1', type: 'Reactor', baseHealth: 92, healthTrend: 0.01, location: 'Central Substation', voltage: '345kV', capacity: '100MVAR', manufacturer: 'ABB', installDate: '2020' },
                    { id: 'REA-002', name: 'Line Reactor #2', type: 'Reactor', baseHealth: 85, healthTrend: -0.01, location: 'West Substation', voltage: '230kV', capacity: '75MVAR', manufacturer: 'Siemens', installDate: '2017' },

                    // Protection & Control Equipment
                    { id: 'REL-001', name: 'Digital Relay Panel #1', type: 'Protection Relay', baseHealth: 95, healthTrend: 0.02, location: 'Central Control Center', voltage: '125VDC', manufacturer: 'SEL', installDate: '2021' },
                    { id: 'REL-002', name: 'Digital Relay Panel #2', type: 'Protection Relay', baseHealth: 93, healthTrend: 0.01, location: 'North Substation', voltage: '125VDC', manufacturer: 'ABB', installDate: '2020' },
                    { id: 'REL-003', name: 'Legacy Relay Panel #3', type: 'Protection Relay', baseHealth: 72, healthTrend: -0.05, location: 'South Substation', voltage: '125VDC', manufacturer: 'GE', installDate: '2014' },

                    // Current & Voltage Transformers
                    { id: 'CT-001', name: 'Current Transformer CT-1A', type: 'Current Transformer', baseHealth: 89, healthTrend: 0.01, location: 'Central Substation', voltage: '345kV', ratio: '4000:5A', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'CT-002', name: 'Current Transformer CT-2A', type: 'Current Transformer', baseHealth: 86, healthTrend: -0.01, location: 'North Substation', voltage: '138kV', ratio: '3000:5A', manufacturer: 'Siemens', installDate: '2017' },
                    { id: 'VT-001', name: 'Voltage Transformer VT-1A', type: 'Voltage Transformer', baseHealth: 91, healthTrend: 0.02, location: 'Central Substation', voltage: '345kV', ratio: '345000:115V', manufacturer: 'ABB', installDate: '2018' },
                    { id: 'VT-002', name: 'Voltage Transformer VT-2A', type: 'Voltage Transformer', baseHealth: 88, healthTrend: 0.01, location: 'East Substation', voltage: '230kV', ratio: '230000:115V', manufacturer: 'GE', installDate: '2019' },

                    // SCADA & Communication Equipment
                    { id: 'RTU-001', name: 'Remote Terminal Unit #1', type: 'RTU', baseHealth: 94, healthTrend: 0.03, location: 'Central Control Center', manufacturer: 'Schneider', model: 'ION7650', installDate: '2021' },
                    { id: 'RTU-002', name: 'Remote Terminal Unit #2', type: 'RTU', baseHealth: 91, healthTrend: 0.02, location: 'North Substation', manufacturer: 'ABB', model: 'RTU560', installDate: '2020' },
                    { id: 'RTU-003', name: 'Remote Terminal Unit #3', type: 'RTU', baseHealth: 87, healthTrend: -0.01, location: 'South Substation', manufacturer: 'GE', model: 'D400', installDate: '2018' },

                    // Power Quality Equipment
                    { id: 'PQM-001', name: 'Power Quality Monitor #1', type: 'Power Quality Monitor', baseHealth: 96, healthTrend: 0.01, location: 'Central Substation', manufacturer: 'Fluke', model: '1760TR', installDate: '2022' },
                    { id: 'PQM-002', name: 'Power Quality Monitor #2', type: 'Power Quality Monitor', baseHealth: 89, healthTrend: 0.02, location: 'East Substation', manufacturer: 'Dranetz', model: 'HDPQ Xplorer', installDate: '2020' },

                    // Additional Assets for Realism
                    { id: 'TXF-007', name: 'Generator Step-Up Transformer', type: 'Transformer', baseHealth: 93, healthTrend: 0.02, location: 'Commercial District', voltage: '22/345kV', capacity: '250MVA', manufacturer: 'Siemens', installDate: '2021' },
                    { id: 'TXF-008', name: 'Auxiliary Transformer', type: 'Transformer', baseHealth: 86, healthTrend: 0.01, location: 'Industrial District', voltage: '138/4.16kV', capacity: '10MVA', manufacturer: 'ABB', installDate: '2019' },
                    
                    { id: 'CBR-007', name: 'Generator Circuit Breaker', type: 'Circuit Breaker', baseHealth: 88, healthTrend: 0.03, location: 'Commercial District', voltage: '22kV', current: '6300A', manufacturer: 'GE', installDate: '2021' },
                    { id: 'CBR-008', name: 'Tie Circuit Breaker', type: 'Circuit Breaker', baseHealth: 95, healthTrend: 0.01, location: 'Industrial District', voltage: '138kV', current: '3150A', manufacturer: 'Siemens', installDate: '2022' },
                    
                    { id: 'SW-006', name: 'Bus Tie Switch', type: 'Switch', baseHealth: 89, healthTrend: 0.02, location: 'Commercial District', voltage: '138kV', current: '3150A', manufacturer: 'ABB', installDate: '2020' },
                    { id: 'SW-007', name: 'Grounding Switch GS-1', type: 'Switch', baseHealth: 91, healthTrend: 0.01, location: 'Industrial District', voltage: '345kV', current: '4000A', manufacturer: 'GE', installDate: '2021' },
                    
                    { id: 'DL-005', name: 'Underground Distribution Cable', type: 'Distribution Line', baseHealth: 82, healthTrend: 0.02, location: 'Downtown District', voltage: '34.5kV', length: '5mi', conductor: 'XLPE', installDate: '2020' },
                    { id: 'DL-006', name: 'Rural Distribution Line', type: 'Distribution Line', baseHealth: 78, healthTrend: -0.01, location: 'Rural District', voltage: '13.8kV', length: '15mi', conductor: 'ACSR', installDate: '2017' }
                ].map(asset => this.enhanceAssetData(asset));
            }

            enhanceAssetData(asset) {
                const location = this.puneLocations[asset.location] || this.puneLocations['Central Substation'];
                const sensorData = this.generateRealTimeSensorData(asset);
                
                return {
                    ...asset,
                    coordinates: location,
                    realTimeData: sensorData,
                    lastUpdated: new Date().toISOString(),
                    operationalData: this.generateOperationalData(asset),
                    maintenanceData: this.generateMaintenanceData(asset),
                    technicalSpecs: this.generateTechnicalSpecs(asset)
                };
            }

            generateRealTimeSensorData(asset) {
                const data = {};
                const now = new Date();
                const hour = now.getHours();
                const minute = now.getMinutes();
                
                // Base values depend on asset type with realistic variations
                switch (asset.type) {
                    case 'Transformer':
                        data.temperature = Math.round((65 + Math.sin(hour * Math.PI / 12) * 20 + Math.random() * 15) * 10) / 10;
                        data.voltage = Math.round((parseFloat(asset.voltage?.split('/')[0]?.replace('kV', '')) || 138) * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.loadFactor = Math.round((0.65 + Math.sin((hour - 6) * Math.PI / 12) * 0.25 + Math.random() * 0.15) * 100);
                        data.vibration = Math.round((1.8 + Math.random() * 2.5) * 100) / 100;
                        data.oilLevel = Math.round((88 + Math.random() * 10));
                        data.tapPosition = Math.floor(Math.random() * 17) - 8; // -8 to +8
                        data.oilTemperature = Math.round((data.temperature + 5 + Math.random() * 8) * 10) / 10;
                        data.gasContent = Math.round((15 + Math.random() * 25) * 10) / 10; // ppm
                        break;
                        
                    case 'Transmission Line':
                    case 'Distribution Line':
                        const baseVoltage = parseFloat(asset.voltage?.replace('kV', '')) || 138;
                        data.current = Math.round((600 + Math.sin((hour - 8) * Math.PI / 10) * 400 + Math.random() * 300));
                        data.voltage = Math.round(baseVoltage * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.temperature = Math.round((38 + Math.sin(hour * Math.PI / 12) * 18 + Math.random() * 12) * 10) / 10;
                        data.sag = Math.round((9 + Math.sin(hour * Math.PI / 12) * 3 + Math.random() * 2) * 10) / 10;
                        data.windSpeed = Math.round((8 + Math.random() * 20) * 10) / 10;
                        data.iceLoading = Math.round(Math.random() * 5 * 10) / 10; // kg/m
                        data.powerFlow = Math.round((baseVoltage * data.current * Math.sqrt(3) / 1000) * (0.8 + Math.random() * 0.3) * 10) / 10; // MW
                        break;
                        
                    case 'Circuit Breaker':
                        data.oilPressure = Math.round((3.5 + Math.random() * 1.8) * 10) / 10;
                        data.voltage = Math.round((parseFloat(asset.voltage?.replace('kV', '')) || 138) * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.current = Math.round((parseFloat(asset.current?.replace('A', '')) || 2000) * (0.6 + Math.random() * 0.4));
                        data.operationCount = Math.floor(Math.random() * 75000) + 5000;
                        data.contactResistance = Math.round((25 + Math.random() * 40) * 100) / 100; // µΩ
                        data.travelTime = Math.round((45 + Math.random() * 15) * 10) / 10; // ms
                        data.sf6Pressure = Math.round((5.8 + Math.random() * 0.4) * 10) / 10; // bar
                        break;
                        
                    case 'Switch':
                        data.temperature = Math.round((40 + Math.sin(hour * Math.PI / 12) * 12 + Math.random() * 10) * 10) / 10;
                        data.voltage = Math.round((parseFloat(asset.voltage?.replace('kV', '')) || 138) * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.current = Math.round((parseFloat(asset.current?.replace('A', '')) || 1000) * (0.5 + Math.random() * 0.4));
                        data.contactResistance = Math.round((15 + Math.random() * 25) * 100) / 100; // µΩ
                        data.operationTime = Math.round((2.5 + Math.random() * 1.5) * 100) / 100; // seconds
                        break;
                        
                    case 'Substation':
                        const capacity = parseFloat(asset.capacity?.replace('MVA', '')) || 400;
                        data.totalLoad = Math.round(capacity * (0.65 + Math.sin((hour - 6) * Math.PI / 12) * 0.25) * 10) / 10;
                        data.frequency = Math.round((50.0 + (Math.random() - 0.5) * 0.6) * 100) / 100;
                        data.voltage = Math.round((parseFloat(asset.voltage?.split('/')[0]?.replace('kV', '')) || 138) * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.powerFactor = Math.round((0.88 + Math.random() * 0.10) * 100) / 100;
                        data.ambientTemp = Math.round((28 + Math.sin(hour * Math.PI / 12) * 12 + Math.random() * 8) * 10) / 10;
                        data.humidity = Math.round((45 + Math.random() * 35));
                        data.activePower = Math.round(data.totalLoad * data.powerFactor * 10) / 10; // MW
                        data.reactivePower = Math.round(data.totalLoad * Math.sin(Math.acos(data.powerFactor)) * 10) / 10; // MVAR
                        break;
                        
                    case 'Capacitor Bank':
                        data.voltage = Math.round((parseFloat(asset.voltage?.replace('kV', '')) || 138) * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.current = Math.round((250 + Math.random() * 150));
                        data.temperature = Math.round((48 + Math.sin(hour * Math.PI / 12) * 15 + Math.random() * 12) * 10) / 10;
                        data.reactivePower = Math.round((parseFloat(asset.capacity?.replace('MVAR', '')) || 50) * (0.95 + Math.random() * 0.08) * 10) / 10;
                        data.switchingOperations = Math.floor(Math.random() * 15000) + 1000;
                        break;
                        
                    case 'Reactor':
                        data.voltage = Math.round((parseFloat(asset.voltage?.replace('kV', '')) || 230) * (0.98 + Math.random() * 0.04) * 10) / 10;
                        data.current = Math.round((180 + Math.random() * 120));
                        data.temperature = Math.round((58 + Math.sin(hour * Math.PI / 12) * 18 + Math.random() * 15) * 10) / 10;
                        data.reactivePower = Math.round((parseFloat(asset.capacity?.replace('MVAR', '')) || 75) * (0.92 + Math.random() * 0.12) * 10) / 10;
                        data.coolingFlow = Math.round((125 + Math.random() * 75)); // l/min
                        break;
                        
                    case 'Protection Relay':
                        data.temperature = Math.round((32 + Math.random() * 12) * 10) / 10;
                        data.dcVoltage = Math.round((125 + Math.random() * 8) * 10) / 10;
                        data.signalQuality = Math.round((95 + Math.random() * 4));
                        data.responseTime = Math.round((12 + Math.random() * 8) * 10) / 10; // ms
                        data.memoryUsage = Math.round((35 + Math.random() * 25));
                        data.cpuLoad = Math.round((15 + Math.random() * 20));
                        break;
                        
                    case 'Current Transformer':
                    case 'Voltage Transformer':
                        data.temperature = Math.round((45 + Math.sin(hour * Math.PI / 12) * 12 + Math.random() * 10) * 10) / 10;
                        data.primaryCurrent = Math.round((parseFloat(asset.ratio?.split(':')[0]) || 3000) * (0.7 + Math.random() * 0.25));
                        data.secondaryCurrent = Math.round((5 * (0.95 + Math.random() * 0.08)) * 100) / 100;
                        data.burden = Math.round((8 + Math.random() * 12) * 10) / 10; // VA
                        data.accuracy = Math.round((0.2 + Math.random() * 0.3) * 100) / 100; // %
                        break;
                        
                    case 'RTU':
                        data.temperature = Math.round((28 + Math.random() * 8) * 10) / 10;
                        data.commStatus = Math.round((96 + Math.random() * 3));
                        data.dataPoints = Math.floor(Math.random() * 500) + 200;
                        data.memoryUsage = Math.round((40 + Math.random() * 30));
                        data.cpuLoad = Math.round((20 + Math.random() * 25));
                        data.latency = Math.round((15 + Math.random() * 35) * 10) / 10; // ms
                        break;
                        
                    case 'Power Quality Monitor':
                        data.thdVoltage = Math.round((2.5 + Math.random() * 2.8) * 100) / 100;
                        data.thdCurrent = Math.round((3.2 + Math.random() * 3.5) * 100) / 100;
                        data.frequency = Math.round((50.0 + (Math.random() - 0.5) * 0.3) * 100) / 100;
                        data.voltageUnbalance = Math.round((1.8 + Math.random() * 2.2) * 100) / 100;
                        data.powerFactor = Math.round((0.87 + Math.random() * 0.11) * 100) / 100;
                        data.flickerSeverity = Math.round((0.8 + Math.random() * 1.5) * 100) / 100;
                        break;
                        
                    default:
                        data.voltage = Math.round((138 * (0.98 + Math.random() * 0.04)) * 10) / 10;
                        data.temperature = Math.round((35 + Math.sin(hour * Math.PI / 12) * 15 + Math.random() * 12) * 10) / 10;
                        data.status = Math.random() > 0.15 ? 'Normal' : 'Warning';
                }
                
                // Common parameters for all assets
                data.stressLevel = this.calculateStressLevel(asset, data);
                data.efficiency = Math.round((88 + Math.random() * 10));
                data.reliability = Math.round((asset.currentHealth || asset.baseHealth || 80) + Math.random() * 8 - 4);
                data.operatingHours = Math.floor(Math.random() * 65000) + 15000;
                data.lastMaintenance = Math.floor(Math.random() * 365) + 30; // days ago
                
                return data;
            }

            calculateStressLevel(asset, sensorData) {
                let stress = 0;
                
                // Temperature stress
                if (sensorData.temperature > 70) stress += 30;
                else if (sensorData.temperature > 60) stress += 15;
                
                // Load stress
                if (sensorData.loadFactor > 85) stress += 25;
                else if (sensorData.loadFactor > 75) stress += 10;
                
                // Age stress
                const installYear = parseInt(asset.installDate) || 2018;
                const age = 2025 - installYear;
                stress += Math.min(age * 3, 30);
                
                // Health stress
                stress += (100 - (asset.currentHealth || 80)) / 2;
                
                return Math.min(Math.round(stress), 100);
            }

            generateOperationalData(asset) {
                return {
                    uptime: Math.round((95 + Math.random() * 4.8) * 100) / 100,
                    lastMaintenance: this.getRandomPastDate(1, 365),
                    nextMaintenance: this.getRandomFutureDate(30, 180),
                    operatingHours: Math.floor(Math.random() * 50000) + 10000,
                    faultHistory: Math.floor(Math.random() * 15),
                    performanceRating: ['Excellent', 'Good', 'Fair', 'Poor'][Math.floor(Math.random() * 4)]
                };
            }

            generateMaintenanceData(asset) {
                return {
                    maintenanceType: ['Preventive', 'Corrective', 'Predictive'][Math.floor(Math.random() * 3)],
                    maintenanceCost: '$' + (Math.floor(Math.random() * 50000) + 5000).toLocaleString(),
                    spareParts: ['Available', 'Limited', 'On Order'][Math.floor(Math.random() * 3)],
                    technician: ['Alpha Team', 'Bravo Team', 'Charlie Team', 'Delta Team'][Math.floor(Math.random() * 4)],
                    priority: ['High', 'Medium', 'Low'][Math.floor(Math.random() * 3)]
                };
            }

            generateTechnicalSpecs(asset) {
                const specs = {
                    serialNumber: 'SN' + Math.floor(Math.random() * 1000000).toString().padStart(6, '0'),
                    model: asset.manufacturer + '-' + Math.floor(Math.random() * 9999),
                    warranty: this.getRandomFutureDate(365, 1825), // 1-5 years
                    certifications: ['IEC', 'IEEE', 'IS'][Math.floor(Math.random() * 3)],
                    installationDate: asset.installDate
                };
                
                // Add specific specs based on asset type
                if (asset.voltage) specs.voltage = asset.voltage;
                if (asset.capacity) specs.capacity = asset.capacity;
                if (asset.current) specs.current = asset.current;
                if (asset.length) specs.length = asset.length;
                if (asset.conductor) specs.conductor = asset.conductor;
                
                return specs;
            }

            getRandomPastDate(minDays, maxDays) {
                const now = new Date();
                const pastDays = Math.floor(Math.random() * (maxDays - minDays)) + minDays;
                const date = new Date(now.getTime() - pastDays * 24 * 60 * 60 * 1000);
                return date.toISOString().split('T')[0];
            }

            getRandomFutureDate(minDays, maxDays) {
                const now = new Date();
                const futureDays = Math.floor(Math.random() * (maxDays - minDays)) + minDays;
                const date = new Date(now.getTime() + futureDays * 24 * 60 * 60 * 1000);
                return date.toISOString().split('T')[0];
            }

            renderAssetDatabase() {
                const grid = document.getElementById('asset-grid');
                if (!grid) return;

                if (this.filteredAssets.length === 0) {
                    grid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #666;">
                            <h3>🔍 No assets found</h3>
                            <p>Try adjusting your search criteria or filters.</p>
                        </div>
                    `;
                } else {
                    grid.innerHTML = this.filteredAssets.map(asset => this.createAssetCard(asset)).join('');
                }
                
                this.updateSummaryStats();
                console.log(`Rendered ${this.filteredAssets.length} asset cards`);
            }

            createAssetCard(asset) {
                const healthColor = this.getHealthColor(asset.currentHealth || 75);
                const stressColor = this.getStressColor(asset.realTimeData.stressLevel);
                const coords = asset.coordinates;
                
                return `
                    <div class="asset-card" style="
                        background: white; 
                        border-radius: 12px; 
                        padding: 20px; 
                        box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
                        border-left: 4px solid ${healthColor};
                        transition: transform 0.3s ease, box-shadow 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 15px rgba(0,0,0,0.15)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)'"
                       onclick="showAssetDetails('${asset.id}')">
                        
                        <!-- Asset Header -->
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                            <div>
                                <h3 style="margin: 0; color: #333; font-size: 1.1rem;">${asset.id}</h3>
                                <div style="color: #666; font-size: 0.9rem; margin-top: 2px;">${asset.name}</div>
                                <div style="color: #007bff; font-size: 0.8rem; font-weight: bold; margin-top: 5px;">
                                    ${asset.type}
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="background: ${healthColor}; color: white; padding: 4px 8px; border-radius: 20px; font-size: 0.8rem; font-weight: bold;">
                                    ${Math.round(asset.currentHealth || 75)}% Health
                                </div>
                                <div style="background: ${stressColor}; color: white; padding: 4px 8px; border-radius: 20px; font-size: 0.8rem; margin-top: 5px;">
                                    ${asset.realTimeData.stressLevel}% Stress
                                </div>
                            </div>
                        </div>

                        <!-- Real-time Parameters -->
                        <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                            <h4 style="margin: 0 0 10px 0; color: #495057; font-size: 0.9rem;">⚡ Real-time Parameters</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.8rem;">
                                ${this.generateParameterRows(asset.realTimeData)}
                            </div>
                        </div>

                        <!-- Location and Status -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div style="font-size: 0.8rem;">
                                <div style="color: #666;">📍 <strong>${asset.location}</strong></div>
                                <div style="color: #888; margin-top: 2px;">${coords.address}</div>
                                <div style="color: #007bff; margin-top: 2px;">
                                    <a href="https://maps.google.com/?q=${coords.lat},${coords.lng}" target="_blank" 
                                       style="text-decoration: none; color: #007bff;">
                                        🗺️ ${coords.lat.toFixed(4)}, ${coords.lng.toFixed(4)}
                                    </a>
                                </div>
                            </div>
                            <div style="text-align: right; font-size: 0.8rem;">
                                <div style="color: #28a745;">🔧 ${asset.operationalData.performanceRating}</div>
                                <div style="color: #666; margin-top: 2px;">Uptime: ${asset.operationalData.uptime}%</div>
                            </div>
                        </div>

                        <!-- Technical Specs -->
                        <div style="border-top: 1px solid #eee; padding-top: 10px; font-size: 0.8rem;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="color: #666;">Manufacturer:</span>
                                <span style="font-weight: bold;">${asset.manufacturer || 'N/A'}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="color: #666;">Install Date:</span>
                                <span>${asset.installDate}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #666;">Next Maintenance:</span>
                                <span style="color: #ffc107;">${asset.operationalData.nextMaintenance}</span>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div style="margin-top: 12px; display: flex; gap: 8px;">
                            <button onclick="event.stopPropagation(); viewAssetHistory('${asset.id}')" 
                                    style="flex: 1; padding: 6px; border: 1px solid #007bff; background: white; color: #007bff; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
                                📊 History
                            </button>
                            <button onclick="event.stopPropagation(); scheduleMaintenanceModal('${asset.id}')" 
                                    style="flex: 1; padding: 6px; border: 1px solid #28a745; background: white; color: #28a745; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
                                🔧 Maintenance
                            </button>
                            <button onclick="event.stopPropagation(); generateReport('${asset.id}')" 
                                    style="flex: 1; padding: 6px; border: 1px solid #6c757d; background: white; color: #6c757d; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
                                📄 Report
                            </button>
                        </div>
                    </div>
                `;
            }

            generateParameterRows(data) {
                const params = [];
                let count = 0;
                
                for (const [key, value] of Object.entries(data)) {
                    if (key === 'stressLevel' || count >= 8) continue; // Already shown in header, limit to 8 params
                    
                    let displayKey = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                    let displayValue = value;
                    let unit = '';
                    let colorClass = '';
                    
                    // Add appropriate units and formatting
                    if (key.includes('temp') || key.includes('Temperature')) {
                        unit = '°C';
                        colorClass = value > 70 ? 'color: #dc3545' : value > 50 ? 'color: #ffc107' : 'color: #28a745';
                    } else if (key.includes('voltage') || key.includes('Voltage')) {
                        unit = 'kV';
                        if (key.includes('dc') || key.includes('DC')) unit = 'VDC';
                    } else if (key.includes('current') || key.includes('Current')) {
                        unit = 'A';
                    } else if (key.includes('pressure') || key.includes('Pressure')) {
                        unit = 'bar';
                    } else if (key.includes('frequency') || key.includes('Frequency')) {
                        unit = 'Hz';
                    } else if (key.includes('load') || key.includes('Load') || key.includes('power') || key.includes('Power')) {
                        unit = key.includes('reactive') || key.includes('Reactive') ? 'MVAR' : 'MW';
                    } else if (key.includes('Factor') || key.includes('factor') || key.includes('efficiency') || key.includes('reliability')) {
                        if (typeof value === 'number' && value <= 1) {
                            displayValue = Math.round(value * 100);
                        }
                        unit = '%';
                    } else if (key.includes('Level') || key.includes('level') || key.includes('Usage') || key.includes('usage')) {
                        unit = '%';
                    } else if (key.includes('Time') || key.includes('time') || key.includes('Latency') || key.includes('latency')) {
                        unit = 'ms';
                    } else if (key.includes('Speed') || key.includes('speed')) {
                        unit = 'm/s';
                    } else if (key.includes('Flow') || key.includes('flow')) {
                        unit = 'l/min';
                    } else if (key.includes('sag') || key.includes('Sag')) {
                        unit = 'm';
                    } else if (key.includes('resistance') || key.includes('Resistance')) {
                        unit = 'µΩ';
                    } else if (key.includes('Count') || key.includes('count') || key.includes('Points') || key.includes('points')) {
                        unit = '';
                        displayValue = value.toLocaleString();
                    } else if (key.includes('thd') || key.includes('THD') || key.includes('unbalance') || key.includes('Unbalance')) {
                        unit = '%';
                    }
                    
                    if (typeof value === 'number' && !key.includes('Count') && !key.includes('count')) {
                        displayValue = value.toFixed(1);
                    }
                    
                    // Add status indicator for certain parameters
                    let statusIcon = '';
                    if (key.includes('Status') || key.includes('status')) {
                        statusIcon = value >= 95 ? '🟢' : value >= 85 ? '🟡' : '🔴';
                    }
                    
                    params.push(`
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: #666; font-size: 0.75rem;">${displayKey}:</span>
                            <span style="font-weight: bold; font-size: 0.8rem; ${colorClass}">
                                ${statusIcon}${displayValue}${unit}
                            </span>
                        </div>
                    `);
                    
                    count++;
                }
                
                return params.join('');
            }

            getHealthColor(health) {
                if (health >= 90) return '#28a745';
                if (health >= 75) return '#28a745';
                if (health >= 60) return '#ffc107';
                return '#dc3545';
            }

            getStressColor(stress) {
                if (stress <= 30) return '#28a745';
                if (stress <= 60) return '#ffc107';
                return '#dc3545';
            }

            updateSummaryStats() {
                const excellent = this.filteredAssets.filter(a => (a.currentHealth || 75) >= 90).length;
                const good = this.filteredAssets.filter(a => (a.currentHealth || 75) >= 75 && (a.currentHealth || 75) < 90).length;
                const fair = this.filteredAssets.filter(a => (a.currentHealth || 75) >= 60 && (a.currentHealth || 75) < 75).length;
                const poor = this.filteredAssets.filter(a => (a.currentHealth || 75) < 60).length;
                
                document.getElementById('filtered-count').textContent = this.filteredAssets.length;
                document.getElementById('excellent-count').textContent = excellent;
                document.getElementById('good-count').textContent = good;
                document.getElementById('fair-count').textContent = fair;
                document.getElementById('poor-count').textContent = poor;
            }

            filterAssets() {
                const searchTerm = document.getElementById('asset-search')?.value.toLowerCase() || '';
                const typeFilter = document.getElementById('asset-type-filter')?.value || '';
                const locationFilter = document.getElementById('asset-location-filter')?.value || '';
                const healthFilter = document.getElementById('asset-health-filter')?.value || '';
                
                console.log('Filtering with:', { searchTerm, typeFilter, locationFilter, healthFilter });
                
                this.filteredAssets = this.allAssets.filter(asset => {
                    // Search filter - check multiple fields
                    const matchesSearch = !searchTerm || 
                        asset.id.toLowerCase().includes(searchTerm) ||
                        asset.name.toLowerCase().includes(searchTerm) ||
                        asset.location.toLowerCase().includes(searchTerm) ||
                        asset.type.toLowerCase().includes(searchTerm) ||
                        (asset.manufacturer && asset.manufacturer.toLowerCase().includes(searchTerm));
                    
                    // Type filter - exact match
                    const matchesType = !typeFilter || asset.type === typeFilter;
                    
                    // Location filter - partial match to handle substation names
                    const matchesLocation = !locationFilter || 
                        asset.location.toLowerCase().includes(locationFilter.toLowerCase()) ||
                        asset.location === locationFilter;
                    
                    // Health filter - range based
                    let matchesHealth = true;
                    if (healthFilter) {
                        const health = asset.currentHealth || asset.baseHealth || 75;
                        switch (healthFilter) {
                            case 'excellent': matchesHealth = health >= 90; break;
                            case 'good': matchesHealth = health >= 75 && health < 90; break;
                            case 'fair': matchesHealth = health >= 60 && health < 75; break;
                            case 'poor': matchesHealth = health < 60; break;
                        }
                    }
                    
                    return matchesSearch && matchesType && matchesLocation && matchesHealth;
                });
                
                console.log(`Filtered ${this.filteredAssets.length} assets from ${this.allAssets.length} total`);
                this.renderAssetDatabase();
            }
        }

        // Global asset database instance
        let assetDatabase;

        // Critical Assets Manager Class
        class CriticalAssetsManager {
            constructor() {
                this.criticalAssets = [];
                this.charts = {};
                this.initializeData();
            }

            initializeData() {
                // Generate critical assets data
                this.criticalAssets = [
                    {
                        id: 'T001',
                        name: 'Main Power Transformer #1',
                        type: 'Transformer',
                        location: 'Central Substation',
                        health: 35,
                        riskLevel: 'Critical',
                        priority: 'Critical',
                        issues: ['Temperature rising', 'Oil pressure low', 'Vibration detected'],
                        lastInspection: '2025-07-25',
                        nextMaintenance: '2025-08-10',
                        estimatedFailureDate: '2025-08-15',
                        cost: 850000,
                        coordinates: [18.5204, 73.8567]
                    },
                    {
                        id: 'PL045',
                        name: 'High Voltage Line PL-045',
                        type: 'Power Line',
                        location: 'Sector 7-12',
                        health: 42,
                        riskLevel: 'High',
                        priority: 'Critical',
                        issues: ['Conductor sag excessive', 'Insulator degradation'],
                        lastInspection: '2025-07-28',
                        nextMaintenance: '2025-08-12',
                        estimatedFailureDate: '2025-08-20',
                        cost: 120000,
                        coordinates: [18.5314, 73.8442]
                    },
                    {
                        id: 'CB089',
                        name: 'Circuit Breaker CB-089',
                        type: 'Breaker',
                        location: 'Distribution Hub A',
                        health: 38,
                        riskLevel: 'Critical',
                        priority: 'High',
                        issues: ['Contact erosion', 'SF6 gas leakage'],
                        lastInspection: '2025-07-20',
                        nextMaintenance: '2025-08-08',
                        estimatedFailureDate: '2025-08-18',
                        cost: 45000,
                        coordinates: [18.5104, 73.8667]
                    }
                ];
            }

            renderCriticalAssets() {
                const container = document.getElementById('critical-assets-list');
                if (!container) return;

                const html = this.criticalAssets.map(asset => `
                    <div style="border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 15px; background: ${asset.riskLevel === 'Critical' ? '#ffeaea' : '#fff8e1'};">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 10px;">
                            <div style="flex: 1;">
                                <h5 style="margin: 0; color: #333;">${asset.name}</h5>
                                <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">${asset.type} • ${asset.location}</p>
                            </div>
                            <div style="text-align: right;">
                                <span style="background: ${asset.riskLevel === 'Critical' ? '#dc3545' : '#fd7e14'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">
                                    ${asset.riskLevel}
                                </span>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 15px;">
                            <div>
                                <strong>Health Score:</strong>
                                <div style="background: #e9ecef; border-radius: 10px; height: 8px; margin-top: 5px;">
                                    <div style="background: ${asset.health < 40 ? '#dc3545' : asset.health < 70 ? '#fd7e14' : '#28a745'}; width: ${asset.health}%; height: 100%; border-radius: 10px;"></div>
                                </div>
                                <span style="font-size: 0.8rem; color: #666;">${asset.health}%</span>
                            </div>
                            <div>
                                <strong>Est. Failure:</strong><br>
                                <span style="color: #dc3545; font-weight: bold;">${asset.estimatedFailureDate}</span>
                            </div>
                            <div>
                                <strong>Repair Cost:</strong><br>
                                <span style="color: #007bff; font-weight: bold;">$${asset.cost.toLocaleString()}</span>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong>Key Issues:</strong>
                            <div style="margin-top: 5px;">
                                ${asset.issues.map(issue => `<span style="background: #fff3cd; color: #856404; padding: 2px 6px; border-radius: 3px; font-size: 0.8rem; margin-right: 5px; display: inline-block; margin-bottom: 3px;">${issue}</span>`).join('')}
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button onclick="this.scheduleMaintenanceFor('${asset.id}')" style="background: #28a745; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                🔧 Schedule Maintenance
                            </button>
                            <button onclick="this.viewDetailsFor('${asset.id}')" style="background: #007bff; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                📊 View Details
                            </button>
                            <button onclick="this.createWorkOrderFor('${asset.id}')" style="background: #fd7e14; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                📋 Create Work Order
                            </button>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = html;
            }

            initializeCharts() {
                // Destroy existing charts to prevent expansion issues
                if (this.charts.riskChart) {
                    this.charts.riskChart.destroy();
                }
                if (this.charts.healthChart) {
                    this.charts.healthChart.destroy();
                }

                // Risk Distribution Chart
                setTimeout(() => {
                    const ctx = document.getElementById('critical-risk-chart');
                    if (ctx && window.Chart) {
                        this.charts.riskChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: ['High Risk', 'Medium-High Risk', 'Medium Risk'],
                                datasets: [{
                                    data: [2, 1, 0],
                                    backgroundColor: ['#dc3545', '#fd7e14', '#ffc107'],
                                    borderWidth: 2,
                                    borderColor: '#fff'
                                }]
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: { 
                                            padding: 10,
                                            font: { size: 11 }
                                        }
                                    }
                                }
                            }
                        });
                    }
                }, 100);

                // Health Trend Chart
                setTimeout(() => {
                    const ctx = document.getElementById('critical-health-trend-chart');
                    if (ctx && window.Chart) {
                        // Generate sample trend data
                        const dates = [];
                        const healthData = [];
                        for (let i = 29; i >= 0; i--) {
                            const date = new Date();
                            date.setDate(date.getDate() - i);
                            dates.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                            healthData.push(Math.max(30, 70 - (29-i) * 1.2 + Math.sin(i * 0.3) * 5));
                        }

                        this.charts.healthChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: dates,
                                datasets: [{
                                    label: 'Average Health Score',
                                    data: healthData,
                                    borderColor: '#dc3545',
                                    backgroundColor: 'rgba(220, 53, 69, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false,
                                scales: { 
                                    y: { 
                                        beginAtZero: false,
                                        min: 30,
                                        max: 100,
                                        title: {
                                            display: true,
                                            text: 'Health Score (%)'
                                        }
                                    },
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'Date'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        display: true,
                                        position: 'top'
                                    }
                                }
                            }
                        });
                    }
                }, 200);
            }

            filterAssets() {
                // Implementation for filtering
                this.renderCriticalAssets();
            }

            exportData() {
                const csvContent = "data:text/csv;charset=utf-8," + 
                    "Asset ID,Name,Type,Location,Health,Risk Level,Issues\n" +
                    this.criticalAssets.map(asset => 
                        `${asset.id},${asset.name},${asset.type},${asset.location},${asset.health},${asset.riskLevel},"${asset.issues.join('; ')}"`
                    ).join("\n");
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "critical_assets_report.csv");
                link.click();
            }

            generateReport() {
                const reportContent = `Critical Assets Report - Generated ${new Date().toLocaleDateString()}\n\n` +
                    this.criticalAssets.map(asset => 
                        `Asset: ${asset.name}\nLocation: ${asset.location}\nHealth: ${asset.health}%\nRisk: ${asset.riskLevel}\nIssues: ${asset.issues.join(', ')}\n\n`
                    ).join('');
                
                const blob = new Blob([reportContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement("a");
                link.href = url;
                link.download = "critical_assets_detailed_report.txt";
                link.click();
            }
        }

        // Active Alerts Manager Class
        class ActiveAlertsManager {
            constructor() {
                this.alerts = [];
                this.charts = {};
                this.initializeData();
            }

            initializeData() {
                // Generate active alerts data
                this.alerts = [
                    {
                        id: 'ALR001',
                        title: 'Transformer Overheating',
                        assetId: 'T001',
                        assetName: 'Main Power Transformer #1',
                        assetType: 'Transformer',
                        severity: 'Critical',
                        status: 'Active',
                        description: 'Temperature has exceeded safe operating limits',
                        timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
                        acknowledgedBy: null,
                        responseTime: null,
                        location: 'Central Substation',
                        parameters: { temperature: 95, threshold: 85 }
                    },
                    {
                        id: 'ALR002',
                        title: 'High Voltage Line Sag',
                        assetId: 'PL045',
                        assetName: 'High Voltage Line PL-045',
                        assetType: 'Power Line',
                        severity: 'High',
                        status: 'Acknowledged',
                        description: 'Conductor sag exceeding safety margins',
                        timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(),
                        acknowledgedBy: 'John Smith',
                        responseTime: 45,
                        location: 'Sector 7-12',
                        parameters: { sag: 12.5, threshold: 8.0 }
                    },
                    {
                        id: 'ALR003',
                        title: 'Circuit Breaker Malfunction',
                        assetId: 'CB089',
                        assetName: 'Circuit Breaker CB-089',
                        assetType: 'Breaker',
                        severity: 'Critical',
                        status: 'In Progress',
                        description: 'Failed to operate during scheduled test',
                        timestamp: new Date(Date.now() - 6 * 60 * 60 * 1000).toISOString(),
                        acknowledgedBy: 'Sarah Johnson',
                        responseTime: 20,
                        location: 'Distribution Hub A',
                        parameters: { operationTime: 'Failed', threshold: '50ms' }
                    },
                    {
                        id: 'ALR004',
                        title: 'Substation Security Breach',
                        assetId: 'SS012',
                        assetName: 'Primary Substation SS-012',
                        assetType: 'Substation',
                        severity: 'High',
                        status: 'Active',
                        description: 'Unauthorized access detected at perimeter',
                        timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000).toISOString(),
                        acknowledgedBy: null,
                        responseTime: null,
                        location: 'Industrial Zone',
                        parameters: { accessPoint: 'Gate 3', detected: 'Motion sensor' }
                    }
                ];
            }

            renderActiveAlerts() {
                const container = document.getElementById('active-alerts-list');
                if (!container) return;

                const html = this.alerts.map(alert => `
                    <div style="border-left: 4px solid ${this.getSeverityColor(alert.severity)}; padding: 15px; margin-bottom: 15px; background: white; border-radius: 0 8px 8px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 10px;">
                            <div style="flex: 1;">
                                <h5 style="margin: 0; color: #333; display: flex; align-items: center; gap: 10px;">
                                    ${alert.title}
                                    <span style="background: ${this.getSeverityColor(alert.severity)}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold;">
                                        ${alert.severity}
                                    </span>
                                    <span style="background: ${this.getStatusColor(alert.status)}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.7rem;">
                                        ${alert.status}
                                    </span>
                                </h5>
                                <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">${alert.assetName} • ${alert.location}</p>
                                <p style="margin: 5px 0; color: #666; font-size: 0.85rem;">${alert.description}</p>
                            </div>
                            <div style="text-align: right; font-size: 0.8rem; color: #666;">
                                ${new Date(alert.timestamp).toLocaleString()}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 15px 0;">
                            <div>
                                <strong>Asset:</strong><br>
                                <span style="color: #007bff;">${alert.assetName}</span>
                            </div>
                            <div>
                                <strong>Response Time:</strong><br>
                                <span style="color: ${alert.responseTime ? '#28a745' : '#dc3545'};">
                                    ${alert.responseTime ? `${alert.responseTime} min` : 'Pending'}
                                </span>
                            </div>
                            <div>
                                <strong>Acknowledged By:</strong><br>
                                <span style="color: ${alert.acknowledgedBy ? '#28a745' : '#dc3545'};">
                                    ${alert.acknowledgedBy || 'Pending'}
                                </span>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 15px;">
                            ${!alert.acknowledgedBy ? `
                                <button onclick="window.activeAlertsManager?.acknowledgeAlert('${alert.id}')" style="background: #17a2b8; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                    ✅ Acknowledge
                                </button>
                            ` : ''}
                            <button onclick="window.activeAlertsManager?.viewAlertDetails('${alert.id}')" style="background: #007bff; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                📊 View Details
                            </button>
                            <button onclick="window.activeAlertsManager?.createWorkOrderFromAlert('${alert.id}')" style="background: #28a745; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                📋 Create Work Order
                            </button>
                            <button onclick="window.activeAlertsManager?.resolveAlert('${alert.id}')" style="background: #6c757d; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                ✅ Resolve
                            </button>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = html;
            }

            getSeverityColor(severity) {
                switch (severity) {
                    case 'Critical': return '#dc3545';
                    case 'High': return '#fd7e14';
                    case 'Medium': return '#ffc107';
                    case 'Low': return '#28a745';
                    default: return '#6c757d';
                }
            }

            getStatusColor(status) {
                switch (status) {
                    case 'Active': return '#dc3545';
                    case 'Acknowledged': return '#fd7e14';
                    case 'In Progress': return '#17a2b8';
                    case 'Resolved': return '#28a745';
                    default: return '#6c757d';
                }
            }

            initializeCharts() {
                // Destroy existing charts to prevent expansion issues
                if (this.charts.distributionChart) {
                    this.charts.distributionChart.destroy();
                }
                if (this.charts.responseChart) {
                    this.charts.responseChart.destroy();
                }

                // Alert Distribution Chart
                setTimeout(() => {
                    const ctx = document.getElementById('alert-distribution-chart');
                    if (ctx && window.Chart) {
                        this.charts.distributionChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Critical', 'High', 'Medium', 'Low'],
                                datasets: [{
                                    data: [2, 2, 1, 2],
                                    backgroundColor: ['#dc3545', '#fd7e14', '#ffc107', '#28a745'],
                                    borderWidth: 2,
                                    borderColor: '#fff'
                                }]
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: { 
                                            padding: 10,
                                            font: { size: 11 }
                                        }
                                    }
                                }
                            }
                        });
                    }
                }, 100);

                // Response Time Chart
                setTimeout(() => {
                    const ctx = document.getElementById('response-time-chart');
                    if (ctx && window.Chart) {
                        this.charts.responseChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                                datasets: [{
                                    label: 'Avg Response Time (min)',
                                    data: [15, 12, 18, 8, 22, 10, 14],
                                    borderColor: '#007bff',
                                    backgroundColor: 'rgba(0, 123, 255, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false,
                                scales: { 
                                    y: { 
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Response Time (minutes)'
                                        }
                                    },
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'Day of Week'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        display: true,
                                        position: 'top'
                                    }
                                }
                            }
                        });
                    }
                }, 200);
            }

            acknowledgeAlert(alertId) {
                const alert = this.alerts.find(a => a.id === alertId);
                if (alert) {
                    alert.acknowledgedBy = 'Current User';
                    alert.status = 'Acknowledged';
                    alert.responseTime = Math.floor(Math.random() * 30) + 5;
                    this.renderActiveAlerts();
                }
            }

            acknowledgeAll() {
                this.alerts.forEach(alert => {
                    if (!alert.acknowledgedBy) {
                        alert.acknowledgedBy = 'Current User';
                        alert.status = 'Acknowledged';
                        alert.responseTime = Math.floor(Math.random() * 30) + 5;
                    }
                });
                this.renderActiveAlerts();
            }

            filterAlerts() {
                // Implementation for filtering
                this.renderActiveAlerts();
            }

            exportData() {
                const csvContent = "data:text/csv;charset=utf-8," + 
                    "Alert ID,Title,Asset,Severity,Status,Timestamp,Response Time\n" +
                    this.alerts.map(alert => 
                        `${alert.id},${alert.title},${alert.assetName},${alert.severity},${alert.status},${alert.timestamp},${alert.responseTime || 'N/A'}`
                    ).join("\n");
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "active_alerts_report.csv");
                link.click();
            }
        }

        // Work Orders Manager Class
        class WorkOrdersManager {
            constructor() {
                this.workOrders = [];
                this.charts = {};
                this.initializeData();
            }

            initializeData() {
                // Generate work orders data
                this.workOrders = [
                    {
                        id: 'WO001',
                        title: 'Emergency Transformer Maintenance',
                        assetId: 'T001',
                        assetName: 'Main Power Transformer #1',
                        type: 'Emergency',
                        priority: 'Urgent',
                        status: 'Pending',
                        assignedTeam: 'Team Alpha',
                        description: 'Critical temperature and oil pressure issues require immediate attention',
                        estimatedHours: 8,
                        scheduledDate: '2025-08-08',
                        dueDate: '2025-08-10',
                        createdDate: '2025-08-07',
                        cost: 15000,
                        materials: ['Transformer oil', 'Temperature sensors', 'Pressure valves']
                    },
                    {
                        id: 'WO002',
                        title: 'Power Line Inspection',
                        assetId: 'PL045',
                        assetName: 'High Voltage Line PL-045',
                        type: 'Inspection',
                        priority: 'High',
                        status: 'Assigned',
                        assignedTeam: 'Team Beta',
                        description: 'Comprehensive inspection for conductor sag and insulator condition',
                        estimatedHours: 6,
                        scheduledDate: '2025-08-09',
                        dueDate: '2025-08-12',
                        createdDate: '2025-08-06',
                        cost: 3500,
                        materials: ['Insulator replacements', 'Measuring equipment']
                    },
                    {
                        id: 'WO003',
                        title: 'Circuit Breaker Replacement',
                        assetId: 'CB089',
                        assetName: 'Circuit Breaker CB-089',
                        type: 'Corrective',
                        priority: 'Urgent',
                        status: 'In Progress',
                        assignedTeam: 'Team Gamma',
                        description: 'Replace malfunctioning circuit breaker with new unit',
                        estimatedHours: 12,
                        scheduledDate: '2025-08-08',
                        dueDate: '2025-08-11',
                        createdDate: '2025-08-05',
                        cost: 25000,
                        materials: ['Circuit breaker unit', 'SF6 gas', 'Control cables']
                    },
                    {
                        id: 'WO004',
                        title: 'Preventive Substation Maintenance',
                        assetId: 'SS012',
                        assetName: 'Primary Substation SS-012',
                        type: 'Preventive',
                        priority: 'Medium',
                        status: 'Scheduled',
                        assignedTeam: 'Team Alpha',
                        description: 'Routine maintenance and security system check',
                        estimatedHours: 4,
                        scheduledDate: '2025-08-15',
                        dueDate: '2025-08-20',
                        createdDate: '2025-08-07',
                        cost: 5000,
                        materials: ['Cleaning supplies', 'Lubricants', 'Testing equipment']
                    }
                ];
            }

            renderWorkOrders() {
                const container = document.getElementById('pending-work-orders-list');
                if (!container) return;

                const html = this.workOrders.map(order => `
                    <div style="border-left: 4px solid ${this.getPriorityColor(order.priority)}; padding: 15px; margin-bottom: 15px; background: white; border-radius: 0 8px 8px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 10px;">
                            <div style="flex: 1;">
                                <h5 style="margin: 0; color: #333; display: flex; align-items: center; gap: 10px;">
                                    ${order.title}
                                    <span style="background: ${this.getPriorityColor(order.priority)}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold;">
                                        ${order.priority}
                                    </span>
                                    <span style="background: ${this.getStatusColor(order.status)}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.7rem;">
                                        ${order.status}
                                    </span>
                                </h5>
                                <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">${order.assetName} • ${order.type}</p>
                                <p style="margin: 5px 0; color: #666; font-size: 0.85rem;">${order.description}</p>
                            </div>
                            <div style="text-align: right; font-size: 0.8rem; color: #666;">
                                Due: ${order.dueDate}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 15px 0;">
                            <div>
                                <strong>Assigned Team:</strong><br>
                                <span style="color: #007bff;">${order.assignedTeam}</span>
                            </div>
                            <div>
                                <strong>Estimated Hours:</strong><br>
                                <span style="color: #28a745;">${order.estimatedHours}h</span>
                            </div>
                            <div>
                                <strong>Estimated Cost:</strong><br>
                                <span style="color: #fd7e14; font-weight: bold;">$${order.cost.toLocaleString()}</span>
                            </div>
                            <div>
                                <strong>Scheduled:</strong><br>
                                <span style="color: #17a2b8;">${order.scheduledDate}</span>
                            </div>
                        </div>
                        
                        <div style="margin: 10px 0;">
                            <strong>Required Materials:</strong>
                            <div style="margin-top: 5px;">
                                ${order.materials.map(material => `<span style="background: #e9ecef; color: #495057; padding: 2px 6px; border-radius: 3px; font-size: 0.8rem; margin-right: 5px; display: inline-block; margin-bottom: 3px;">${material}</span>`).join('')}
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 15px;">
                            <button onclick="window.workOrdersManager?.startWorkOrder('${order.id}')" style="background: #28a745; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                ▶️ Start Work
                            </button>
                            <button onclick="window.workOrdersManager?.assignTeam('${order.id}')" style="background: #007bff; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                👥 Assign Team
                            </button>
                            <button onclick="window.workOrdersManager?.scheduleOrder('${order.id}')" style="background: #17a2b8; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                📅 Reschedule
                            </button>
                            <button onclick="window.workOrdersManager?.viewOrderDetails('${order.id}')" style="background: #6c757d; color: white; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                                📊 Details
                            </button>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = html;
            }

            getPriorityColor(priority) {
                switch (priority) {
                    case 'Urgent': return '#dc3545';
                    case 'High': return '#fd7e14';
                    case 'Medium': return '#ffc107';
                    case 'Low': return '#28a745';
                    default: return '#6c757d';
                }
            }

            getStatusColor(status) {
                switch (status) {
                    case 'Pending': return '#dc3545';
                    case 'Assigned': return '#fd7e14';
                    case 'Scheduled': return '#17a2b8';
                    case 'In Progress': return '#007bff';
                    case 'Completed': return '#28a745';
                    default: return '#6c757d';
                }
            }

            initializeCharts() {
                // Destroy existing charts to prevent expansion issues
                if (this.charts.statusChart) {
                    this.charts.statusChart.destroy();
                }
                if (this.charts.trendsChart) {
                    this.charts.trendsChart.destroy();
                }

                // Work Order Status Chart
                setTimeout(() => {
                    const ctx = document.getElementById('work-order-status-chart');
                    if (ctx && window.Chart) {
                        this.charts.statusChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Pending', 'Assigned', 'In Progress', 'Scheduled'],
                                datasets: [{
                                    data: [1, 1, 1, 1],
                                    backgroundColor: ['#dc3545', '#fd7e14', '#007bff', '#17a2b8'],
                                    borderWidth: 2,
                                    borderColor: '#fff'
                                }]
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: { 
                                            padding: 10,
                                            font: { size: 11 }
                                        }
                                    }
                                }
                            }
                        });
                    }
                }, 100);

                // Completion Trends Chart
                setTimeout(() => {
                    const ctx = document.getElementById('completion-trends-chart');
                    if (ctx && window.Chart) {
                        this.charts.trendsChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                                datasets: [{
                                    label: 'Completed Orders',
                                    data: [8, 12, 6, 15],
                                    borderColor: '#28a745',
                                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.4
                                }, {
                                    label: 'New Orders',
                                    data: [10, 8, 14, 12],
                                    borderColor: '#007bff',
                                    backgroundColor: 'rgba(0, 123, 255, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false,
                                scales: { 
                                    y: { 
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Number of Orders'
                                        }
                                    },
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'Week'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        display: true,
                                        position: 'top'
                                    }
                                }
                            }
                        });
                    }
                }, 200);
            }

            startWorkOrder(orderId) {
                const order = this.workOrders.find(o => o.id === orderId);
                if (order) {
                    order.status = 'In Progress';
                    this.renderWorkOrders();
                    alert(`Work order ${orderId} has been started!`);
                }
            }

            createOrder() {
                alert('Create new work order form would open here.');
            }

            filterOrders() {
                // Implementation for filtering
                this.renderWorkOrders();
            }

            exportData() {
                const csvContent = "data:text/csv;charset=utf-8," + 
                    "Order ID,Title,Asset,Type,Priority,Status,Assigned Team,Due Date,Cost\n" +
                    this.workOrders.map(order => 
                        `${order.id},${order.title},${order.assetName},${order.type},${order.priority},${order.status},${order.assignedTeam},${order.dueDate},${order.cost}`
                    ).join("\n");
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "work_orders_report.csv");
                link.click();
            }
        }

        // Asset Database Functions
        function initializeAssetDatabase() {
            assetDatabase = new AssetDatabase();
        }

        function filterAssets() {
            if (assetDatabase) {
                assetDatabase.filterAssets();
            }
        }

        function showAssetDetails(assetId) {
            const asset = assetDatabase.allAssets.find(a => a.id === assetId);
            if (!asset) return;
            
            alert(`Detailed view for ${asset.name} would open here.\n\nFeatures to implement:\n- Real-time sensor charts\n- Historical data analysis\n- Maintenance scheduling\n- Performance analytics\n- Interactive map view`);
        }

        function viewAssetHistory(assetId) {
            alert(`Historical data for ${assetId} would be displayed here.`);
        }

        function scheduleMaintenanceModal(assetId) {
            alert(`Maintenance scheduling for ${assetId} would open here.`);
        }

        function generateReport(assetId) {
            alert(`Generating comprehensive report for ${assetId}...`);
        }

        // Enhanced openModal function to handle all modals
        const originalOpenModal = window.openModal;
        window.openModal = function(modalType) {
            if (modalType === 'asset-database') {
                document.getElementById(modalType + '-modal').style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Initialize and render asset database
                if (!assetDatabase) {
                    initializeAssetDatabase();
                }
                setTimeout(() => {
                    assetDatabase.renderAssetDatabase();
                }, 100);
                
                console.log('🏭 Opened Asset Database with 45+ assets and Pune geo-locations');
            } else if (modalType === 'critical-assets') {
                document.getElementById(modalType + '-modal').style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Add entrance animation
                const modal = document.getElementById(modalType + '-modal');
                const content = modal.querySelector('.modal-content');
                content.style.transform = 'scale(0.8)';
                content.style.opacity = '0';
                
                setTimeout(() => {
                    content.style.transition = 'all 0.3s ease';
                    content.style.transform = 'scale(1)';
                    content.style.opacity = '1';
                }, 10);
                
                // Initialize and render critical assets
                if (!window.criticalAssetsManager) {
                    window.criticalAssetsManager = new CriticalAssetsManager();
                }
                setTimeout(() => {
                    window.criticalAssetsManager.renderCriticalAssets();
                    window.criticalAssetsManager.initializeCharts();
                }, 100);
                
                console.log('🚨 Opened Critical Assets Management with risk analytics');
            } else if (modalType === 'active-alerts') {
                document.getElementById(modalType + '-modal').style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Add entrance animation
                const modal = document.getElementById(modalType + '-modal');
                const content = modal.querySelector('.modal-content');
                content.style.transform = 'scale(0.8)';
                content.style.opacity = '0';
                
                setTimeout(() => {
                    content.style.transition = 'all 0.3s ease';
                    content.style.transform = 'scale(1)';
                    content.style.opacity = '1';
                }, 10);
                
                // Initialize and render active alerts
                if (!window.activeAlertsManager) {
                    window.activeAlertsManager = new ActiveAlertsManager();
                }
                setTimeout(() => {
                    window.activeAlertsManager.renderActiveAlerts();
                    window.activeAlertsManager.initializeCharts();
                }, 100);
                
                console.log('🔔 Opened Active Alerts Management with real-time monitoring');
            } else if (modalType === 'pending-work-orders') {
                document.getElementById(modalType + '-modal').style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Add entrance animation
                const modal = document.getElementById(modalType + '-modal');
                const content = modal.querySelector('.modal-content');
                content.style.transform = 'scale(0.8)';
                content.style.opacity = '0';
                
                setTimeout(() => {
                    content.style.transition = 'all 0.3s ease';
                    content.style.transform = 'scale(1)';
                    content.style.opacity = '1';
                }, 10);
                
                // Initialize and render work orders
                if (!window.workOrdersManager) {
                    window.workOrdersManager = new WorkOrdersManager();
                }
                setTimeout(() => {
                    window.workOrdersManager.renderWorkOrders();
                    window.workOrdersManager.initializeCharts();
                }, 100);
                
                console.log('🔧 Opened Work Orders Management with team analytics');
            } else {
                originalOpenModal(modalType);
            }
        };

        // Initialize asset database when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeAssetDatabase, 2000);
        });
    </script>
</body>
</html>
